<html><head><meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1"><title>XML Support For Tcl</title><meta name="generator" content="DocBook XSL Stylesheets V1.60.1"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="article" lang="en"><div class="titlepage"><div><div><h1 class="title"><a name="id222773"></a>XML Support For Tcl</h1></div><div><h3 class="subtitle"><i>TclXML</i></h3></div><div><div class="author"><h3 class="author"><span class="firstname">Steve</span> <span class="surname">Ball</span></h3><div class="affiliation"><span class="orgname">Zveno Pty Ltd<br></span><div class="address"><p><br>
	  <span class="otheraddr"><br>
	    <a href="http://www.zveno.com/" target="_top">www.zveno.com</a><br>
	  </span><br>
	</p></div></div></div></div><div><p class="releaseinfo">$Id: README.xml,v 1.1 2003/02/25 04:09:53 balls Exp $</p></div><div><div class="revhistory"><table border="1" width="100%" summary="Revision history"><tr><th align="left" valign="top" colspan="2"><b>Revision History</b></th></tr><tr><td align="left">Revision 2.6</td><td align="left"></td></tr></table></div></div></div><div></div><hr></div><div class="toc"><p><b>Table of Contents</b></p><dl><dt><a href="#installation">Installation</a></dt><dd><dl><dt><a href="#id268962">Dependencies</a></dt><dt><a href="#id269099">Pure-Tcl Installation</a></dt><dt><a href="#id269145">Compiled Installation</a></dt></dl></dd><dt><a href="#id269623">Usage</a></dt><dt><a href="#id269660">XPath</a></dt></dl></div><p>This package provides XML parsers for Tcl scripts.  There is a generic front-end interface with plugin parser implementations.  A number of parser implementations or wrappers are provided:</p><div class="itemizedlist"><ul type="disc"><li><p>James Clark's expat library</p></li><li><p>A generic Tcl implementation, (if you can't be bothered compiling an extension)</p></li></ul></div><p>The packages define commands in the <tt class="tclnamespace">::xml</tt> Tcl namespace:</p><div class="variablelist"><dl><dt><span class="term"><b class="command">xml::parserclass  [info]  [names]</b></span></dt><dd></dd><dt><span class="term"><b class="command">xml::parser</b></span></dt><dd></dd></dl></div><p>Other packages are also provided to provide support for related standards.  In particular, work has commenced on the 'xpath' package for parsing XPath location paths.</p><p>See <a href="http://tclxml.sourceforge.net/" target="_top">the website</a> for more information on XML support for Tcl.</p><p>Contact <a href="mailto:Steve.Ball@zveno.com" target="_top">Steve Ball</a> for information about this release.</p><div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="installation"></a>Installation</h2></div></div><div></div></div><p>TclXML v2.6 features a pure-Tcl installer.</p><p>Future work on the installer will include an 'uninstall' capability, as well as the capability to build the binary libraries in the package from the source.</p><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="id268962"></a>Dependencies</h3></div></div><div></div></div><div class="variablelist"><dl><dt><span class="term">Tcllib</span></dt><dd><p><a href="http://dev.scriptics.com/software/tcllib/" target="_top">http://dev.scriptics.com/software/tcllib/</a></p><p>In order for the Tcl-only parser to resolve external entities, the tcllib package must be installed.</p><p>Be sure to get a version which includes the <tt class="tclpackage">uri</tt> package.  Version 1.2 or better is recommended.</p><div class="itemizedlist"><ul type="disc"><li><p><a href="ftp://prdownloads.sf.net/tcllib/tcllib-1.3.tar.gz" target="_top">GZip'd tarball</a></p></li><li><p><a href="ftp://prdownloads.sf.net/tcllib/tcllib-1.3.zip" target="_top">ZIP file</a></p></li></ul></div><p>The latest CVS snapshot may be found at <a href="http://sourceforge.net/projects/tcllib" target="_top">the SourceForge project page</a>.</p></dd><dt><span class="term">Expat</span></dt><dd><p>Expat is only required for the compiled version of the package.</p><p>TclXML/expat requires expat v0.2, with modifications by Ajuba Solutions.  This is now supplied in the <tt class="filename">expat</tt> subdirectory of this distribution and will maintained until Tclxml has been resynchronised with the Expat SourceForge project (volunteer needed!).</p></dd></dl></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="id269099"></a>Pure-Tcl Installation</h3></div><div><h4 class="title">no compilation required</h4></div></div><div></div></div><p>The <tt class="filename">install.tcl</tt> script will install the pure-Tcl parser.  Run it using <span class="application">wish</span>, eg.</p><pre class="programlisting">wish install.tcl</pre><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3>If Tcl/Tk has been configured correctly on your system, you should be able to simply double-click the script</div><p>If the pure-Tcl parser is good enough for you, then read no further.</p></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="id269145"></a>Compiled Installation</h3></div></div><div></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="id269154"></a>Unix/Linux</h4></div></div><div></div></div><p>You must have Tcl/Tk version 8.2 or better installed on your system.  Tcl/Tk 8.3 or better is recommended.</p><div class="orderedlist"><ol type="1"><li><p>Make sure you have Tcllib 1.2 (or better) installed.  Tcllib is still required, even for the compiled parser.</p></li><li><p>Unpack the TclXML distribution and <b class="command">cd</b> into the <tt class="filename">tclxml-2.6</tt> directory.</p></li><li><p>Run the <tt class="filename">configure</tt> script, with the  [--prefix],  [--exec_prefix] and  [--enable-threads] switches (the latter only if Tcl has been built with threads enabled).  For example, on my system I have Tcl 8.4 installed in <tt class="filename">/usr/local/tcl8.4</tt> so I would use the command:</p><pre class="programlisting">./configure --prefix=/usr/local/tcl8.4 --exec_prefix=/usr/local/tcl8.4 --enable-threads</pre></li><li><pre class="programlisting">make</pre></li><li><pre class="programlisting">make install</pre><p>You may need to do this as root.  This installs the pure-Tcl parser class, as well as support files required for the next step.</p></li><li><pre class="programlisting">cd expat</pre><p>Now TclXML/expat is about to be built.</p></li><li><p>Use exactly the same configure command from step (2) above.</p></li><li><pre class="programlisting">make</pre></li><li><pre class="programlisting">make install</pre><p>You may need to do this as root.  This installs the expat parser class.</p></li></ol></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="id269323"></a>WINDOWS (MS VC++)</h4></div></div><div></div></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3>[Warning: these instructions may not be up-to-date.]</div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3>[Advice:  ActiveTcl includes binaries for TclXML.]</div><p>You must have Tcl/Tk version 8.2 or better installed on your system.  Tcl/Tk 8.3 or better is recommended.</p><div class="orderedlist"><ol type="1"><li><p>Run MS Visual C++ and load the tclxml workspace in the win subdirectory.   There are project files for tclxml, tclexpat &amp; expat. The active project will be the Release version of tclexpat.</p></li><li><p>To build tclxml without tclexpat, select the tclxml project and just build that.</p></li><li><p>Installation</p><p>Since you must have tcl/tk installed already (!) you might like to use the new installer that we have been working on.</p><p>You can install one of multiple builds (Release/Debug etc) by invoking the install.tcl script  and specifying the directory path to the build, or by invoking the installer from the build directory directly:</p><pre class="programlisting">
cd win
wish ../install.tcl -builddir Release
</pre><p>or</p><pre class="programlisting">
cd win/Release
wish ../../install.tcl
</pre><p>Various screens will appear allowing you to select where the package is installed, what optional components can be installed and showing a log of the installation process.</p><p>If that doesn't do the deed you need to do some hard yards:</p><div class="itemizedlist"><ul type="disc"><li><p>Copy the DLL's in the target build subdirectory (win/Release or win/Debug) to a directory which is in your execution PATH (the same directory as your TCL/TK binaries is an obvious one).</p></li><li><p>Copy the top level library subdirectory and its contents into a directory which will be part of the autoexec_path in any TCL/TK apps that will need to load the tclxml modules (the lib subdirectory of your TCL/TK installation is one) . Rename the directory to tclxml2.6</p></li><li><p>Rename the file pkgIndex.tcl.in in this directory to pkgIndex.tcl, and edit the file, replacing any macros (strings with leading and trailing '@''s) with approriate directory/lib/paths.</p><div class="literallayout"><p><br>
   @RELPATH@              = relative path between the library directory <br>
                            &amp; the dll's directory<br>
   @TCLXML_LIB_FILE@      = tclxml.dll<br>
   @expat_TCL_LIB_FILE@   = tclexpat.dll<br>
</p></div></li></ul></div></li></ol></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="id269488"></a>Macintosh OS X</h4></div></div><div></div></div><p>There are two ways to build TclXML under Mac OS X:</p><div class="orderedlist"><ol type="1"><li><p>The usual Unix way, see above.</p></li><li><p>As a Framework using ProjectBuilder.</p></li></ol></div><p>The <tt class="filename">macosx</tt> directory contains the Project Builder files for building under OS X.  TclXML has been tested on OS X 10.2.3 (or is that X.2.3?).</p><p>Start-up the project, select the 'expat' target and build.  This builds everything.  The result is a Mac OS X Framework.  Copy <tt class="filename">tclxml.framework</tt> and <tt class="filename">expat.framework</tt> to any of the usual places for frameworks (<tt class="filename">~/Library/Frameworks</tt>, <tt class="filename">/Library/Frameworks</tt>, etc).</p></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="id269566"></a>Macintosh OS 9 (or earlier)</h4></div></div><div></div></div><p>The installer script doesn't work properly on Macintosh yet, and the binary parsers have not been ported yet (sorry).</p><p>Since the distribution has an all-Tcl parser, you can get a working parser fairly easily.</p><p>Copy the <tt class="filename">library</tt> folder to the Tcl library folder in the Extensions folder of the System folder.</p><p>Rename the <tt class="filename">library</tt> folder to <tt class="filename">tclxml2.6</tt>.  This isn't strictly necessary, but it helps keep things organised.</p><p>You're on your own as far as the demos, programs and documentation go.</p></div></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="id269623"></a>Usage</h2></div></div><div></div></div><p>See the website for links to tutorials and the reference manual.</p><p>In the meantime, here's a quick tutorial:</p><pre class="programlisting">
package require xml

set parser [xml::parser]
$parser configure -elementstartcommand EStart \
    -characterdatacommand PCData

proc EStart {tag attlist args} {
    array set attr $attlist
    puts &quot;Element \&quot;$tag\&quot; started with [array size attr] attributes&quot;
}

proc PCData text {
    incr ::count [string length $text]
}

set count 0
$parser parse [read stdin]

puts &quot;The document contained $count characters&quot;
exit 0
</pre></div><div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="id269660"></a>XPath</h2></div></div><div></div></div><p>In addition to XML parsing packages, TclXML also provides a package for parsing XPath location paths.  The XPath package only parsing the path's syntax, it does interpret the path.  See <a href="http://tclxml.sourceforge.net/tcldom.html" target="_top">TclDOM</a> for a package that will interpret XPath location paths.</p><p>NB.  This package is in its infancy, and does not support the full range of XPath features.  Only a very limited subset of location paths are supported, of the form &quot;/simple/example[2]&quot;.  Paths within predicates will definitely fail.</p><p>To use the XPath package:</p><pre class="programlisting">
package require xpath
</pre><p>To parse a location path:</p><pre class="programlisting">
xpath::split {/simple/example}
</pre><p>This returns a Tcl list, each element of which is a three element sublist: {axis node-test {?predicate ...?}}.</p></div></div></body></html>
