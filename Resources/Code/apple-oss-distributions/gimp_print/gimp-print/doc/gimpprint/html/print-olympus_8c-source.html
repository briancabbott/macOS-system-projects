<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>libgimpprint API Reference: src/main/print-olympus.c Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.6 -->
<div class="qindex"><a class="qindex" href="index.html">Main&nbsp;Page</a> | <a class="qindex" href="modules.html">Modules</a> | <a class="qindex" href="classes.html">Alphabetical&nbsp;List</a> | <a class="qindex" href="annotated.html">Data&nbsp;Structures</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="functions.html">Data&nbsp;Fields</a> | <a class="qindex" href="globals.html">Globals</a> | <a class="qindex" href="pages.html">Related&nbsp;Pages</a></div>
<h1>src/main/print-olympus.c</h1><a href="print-olympus_8c.html">Go to the documentation of this file.</a><div class="fragment"><pre>00001 <span class="comment">/*</span>
00002 <span class="comment"> * "$Id: print-olympus_8c-source.html,v 1.1.1.2 2004/12/22 23:49:08 jlovell Exp $"</span>
00003 <span class="comment"> *</span>
00004 <span class="comment"> *   Print plug-in Olympus driver for the GIMP.</span>
00005 <span class="comment"> *</span>
00006 <span class="comment"> *   Copyright 2003 Michael Mraka (Michael.Mraka@linux.cz)</span>
00007 <span class="comment"> *</span>
00008 <span class="comment"> *   The plug-in is based on the code of the RAW plugin for the GIMP of</span>
00009 <span class="comment"> *   Michael Sweet (mike@easysw.com) and Robert Krawitz (rlk@alum.mit.edu)</span>
00010 <span class="comment"> *</span>
00011 <span class="comment"> *   This program is free software; you can redistribute it and/or modify it</span>
00012 <span class="comment"> *   under the terms of the GNU General Public License as published by the Free</span>
00013 <span class="comment"> *   Software Foundation; either version 2 of the License, or (at your option)</span>
00014 <span class="comment"> *   any later version.</span>
00015 <span class="comment"> *</span>
00016 <span class="comment"> *   This program is distributed in the hope that it will be useful, but</span>
00017 <span class="comment"> *   WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY</span>
00018 <span class="comment"> *   or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License</span>
00019 <span class="comment"> *   for more details.</span>
00020 <span class="comment"> *</span>
00021 <span class="comment"> *   You should have received a copy of the GNU General Public License</span>
00022 <span class="comment"> *   along with this program; if not, write to the Free Software</span>
00023 <span class="comment"> *   Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA 02111-1307, USA.</span>
00024 <span class="comment"> */</span>
00025 
00026 <span class="comment">/*</span>
00027 <span class="comment"> * This file must include only standard C header files.  The core code must</span>
00028 <span class="comment"> * compile on generic platforms that don't support glib, gimp, gtk, etc.</span>
00029 <span class="comment"> */</span>
00030 
00031 <span class="preprocessor">#ifdef HAVE_CONFIG_H</span>
00032 <span class="preprocessor"></span><span class="preprocessor">#include &lt;config.h&gt;</span>
00033 <span class="preprocessor">#endif</span>
00034 <span class="preprocessor"></span><span class="preprocessor">#include &lt;<a class="code" href="gimp-print_8h.html">gimp-print/gimp-print.h</a>&gt;</span>
00035 <span class="preprocessor">#include "<a class="code" href="gimp-print-internal_8h.html">gimp-print-internal.h</a>"</span>
00036 <span class="preprocessor">#include &lt;<a class="code" href="gimp-print-intl-internal_8h.html">gimp-print/gimp-print-intl-internal.h</a>&gt;</span>
00037 <span class="preprocessor">#include &lt;string.h&gt;</span>
00038 <span class="preprocessor">#include &lt;stdio.h&gt;</span>
00039 
00040 <span class="preprocessor">#ifdef __GNUC__</span>
00041 <span class="preprocessor"></span><span class="preprocessor">#define inline __inline__</span>
00042 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
00043 <span class="preprocessor"></span>
<a name="l00044"></a><a class="code" href="print-olympus_8c.html#a0">00044</a> <span class="preprocessor">#define OLYMPUS_INTERLACE_NONE  0</span>
<a name="l00045"></a><a class="code" href="print-olympus_8c.html#a1">00045</a> <span class="preprocessor"></span><span class="preprocessor">#define OLYMPUS_INTERLACE_LINE  1</span>
<a name="l00046"></a><a class="code" href="print-olympus_8c.html#a2">00046</a> <span class="preprocessor"></span><span class="preprocessor">#define OLYMPUS_INTERLACE_PLANE 2</span>
00047 <span class="preprocessor"></span>
<a name="l00048"></a><a class="code" href="print-olympus_8c.html#a3">00048</a> <span class="preprocessor">#define OLYMPUS_FEATURE_NONE            0x00000000</span>
<a name="l00049"></a><a class="code" href="print-olympus_8c.html#a4">00049</a> <span class="preprocessor"></span><span class="preprocessor">#define OLYMPUS_FEATURE_FULL_WIDTH      0x00000001</span>
<a name="l00050"></a><a class="code" href="print-olympus_8c.html#a5">00050</a> <span class="preprocessor"></span><span class="preprocessor">#define OLYMPUS_FEATURE_FULL_HEIGHT     0x00000002</span>
<a name="l00051"></a><a class="code" href="print-olympus_8c.html#a6">00051</a> <span class="preprocessor"></span><span class="preprocessor">#define OLYMPUS_FEATURE_BLOCK_ALIGN     0x00000004</span>
<a name="l00052"></a><a class="code" href="print-olympus_8c.html#a7">00052</a> <span class="preprocessor"></span><span class="preprocessor">#define OLYMPUS_FEATURE_BORDERLESS      0x00000008</span>
<a name="l00053"></a><a class="code" href="print-olympus_8c.html#a8">00053</a> <span class="preprocessor"></span><span class="preprocessor">#define OLYMPUS_FEATURE_WHITE_BORDER    0x00000010</span>
00054 <span class="preprocessor"></span>
<a name="l00055"></a><a class="code" href="print-olympus_8c.html#a9">00055</a> <span class="preprocessor">#define MIN(a,b)        (((a) &lt; (b)) ? (a) : (b))</span>
<a name="l00056"></a><a class="code" href="print-olympus_8c.html#a10">00056</a> <span class="preprocessor"></span><span class="preprocessor">#define MAX(a,b)        (((a) &gt; (b)) ? (a) : (b))</span>
00057 <span class="preprocessor"></span>
<a name="l00058"></a><a class="code" href="print-olympus_8c.html#a13">00058</a> <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="print-olympus_8c.html#a13">zero</a> = <span class="stringliteral">"\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0"</span>;
00059 
<a name="l00060"></a><a class="code" href="structink__t.html">00060</a> <span class="keyword">typedef</span> <span class="keyword">struct</span>
00061 <span class="keyword"></span>{
<a name="l00062"></a><a class="code" href="structink__t.html#o0">00062</a>   <span class="keyword">const</span> <span class="keywordtype">char</span> *output_type;
00063   <span class="keywordtype">int</span> output_channels;
<a name="l00064"></a><a class="code" href="structink__t.html#o2">00064</a>   <span class="keyword">const</span> <span class="keywordtype">char</span> *name;
<a name="l00065"></a><a class="code" href="structink__t.html#o3">00065</a>   <span class="keyword">const</span> <span class="keywordtype">char</span> *channel_order;
00066 } <a class="code" href="structink__t.html">ink_t</a>;
00067 
<a name="l00068"></a><a class="code" href="structink__list__t.html">00068</a> <span class="keyword">typedef</span> <span class="keyword">struct </span>{
<a name="l00069"></a><a class="code" href="structink__list__t.html#o0">00069</a>   <span class="keyword">const</span> <a class="code" href="structink__t.html">ink_t</a> *item;
<a name="l00070"></a><a class="code" href="structink__list__t.html#o1">00070</a>   size_t n_items;
00071 } <a class="code" href="structink__list__t.html">ink_list_t</a>;
00072 
<a name="l00073"></a><a class="code" href="structolymp__resolution__t.html">00073</a> <span class="keyword">typedef</span> <span class="keyword">struct </span>{
<a name="l00074"></a><a class="code" href="structolymp__resolution__t.html#o0">00074</a>   <span class="keyword">const</span> <span class="keywordtype">char</span>* name;
<a name="l00075"></a><a class="code" href="structolymp__resolution__t.html#o1">00075</a>   <span class="keywordtype">int</span> xdpi;
<a name="l00076"></a><a class="code" href="structolymp__resolution__t.html#o2">00076</a>   <span class="keywordtype">int</span> ydpi;
00077 } <a class="code" href="structolymp__resolution__t.html">olymp_resolution_t</a>;
00078 
<a name="l00079"></a><a class="code" href="structolymp__resolution__list__t.html">00079</a> <span class="keyword">typedef</span> <span class="keyword">struct </span>{
<a name="l00080"></a><a class="code" href="structolymp__resolution__list__t.html#o0">00080</a>   <span class="keyword">const</span> <a class="code" href="structolymp__resolution__t.html">olymp_resolution_t</a> *item;
<a name="l00081"></a><a class="code" href="structolymp__resolution__list__t.html#o1">00081</a>   size_t n_items;
00082 } <a class="code" href="structolymp__resolution__list__t.html">olymp_resolution_list_t</a>;
00083 
<a name="l00084"></a><a class="code" href="structolymp__pagesize__t.html">00084</a> <span class="keyword">typedef</span> <span class="keyword">struct </span>{
<a name="l00085"></a><a class="code" href="structolymp__pagesize__t.html#o0">00085</a>   <span class="keyword">const</span> <span class="keywordtype">char</span>* name;
<a name="l00086"></a><a class="code" href="structolymp__pagesize__t.html#o1">00086</a>   <span class="keyword">const</span> <span class="keywordtype">char</span>* text;
<a name="l00087"></a><a class="code" href="structolymp__pagesize__t.html#o2">00087</a>   <span class="keywordtype">int</span> width_pt;
<a name="l00088"></a><a class="code" href="structolymp__pagesize__t.html#o3">00088</a>   <span class="keywordtype">int</span> height_pt;
<a name="l00089"></a><a class="code" href="structolymp__pagesize__t.html#o4">00089</a>   <span class="keywordtype">int</span> border_pt_left;
<a name="l00090"></a><a class="code" href="structolymp__pagesize__t.html#o5">00090</a>   <span class="keywordtype">int</span> border_pt_right;
<a name="l00091"></a><a class="code" href="structolymp__pagesize__t.html#o6">00091</a>   <span class="keywordtype">int</span> border_pt_top;
<a name="l00092"></a><a class="code" href="structolymp__pagesize__t.html#o7">00092</a>   <span class="keywordtype">int</span> border_pt_bottom;
00093 } <a class="code" href="structolymp__pagesize__t.html">olymp_pagesize_t</a>;
00094 
<a name="l00095"></a><a class="code" href="structolymp__pagesize__list__t.html">00095</a> <span class="keyword">typedef</span> <span class="keyword">struct </span>{
<a name="l00096"></a><a class="code" href="structolymp__pagesize__list__t.html#o0">00096</a>   <span class="keyword">const</span> <a class="code" href="structolymp__pagesize__t.html">olymp_pagesize_t</a> *item;
<a name="l00097"></a><a class="code" href="structolymp__pagesize__list__t.html#o1">00097</a>   size_t n_items;
00098 } <a class="code" href="structolymp__pagesize__list__t.html">olymp_pagesize_list_t</a>;
00099 
<a name="l00100"></a><a class="code" href="structolymp__printsize__t.html">00100</a> <span class="keyword">typedef</span> <span class="keyword">struct </span>{
<a name="l00101"></a><a class="code" href="structolymp__printsize__t.html#o0">00101</a>   <span class="keyword">const</span> <span class="keywordtype">char</span>* res_name;
<a name="l00102"></a><a class="code" href="structolymp__printsize__t.html#o1">00102</a>   <span class="keyword">const</span> <span class="keywordtype">char</span>* pagesize_name;
<a name="l00103"></a><a class="code" href="structolymp__printsize__t.html#o2">00103</a>   <span class="keywordtype">int</span> width_px;
<a name="l00104"></a><a class="code" href="structolymp__printsize__t.html#o3">00104</a>   <span class="keywordtype">int</span> height_px;
00105 } <a class="code" href="structolymp__printsize__t.html">olymp_printsize_t</a>;
00106 
<a name="l00107"></a><a class="code" href="structolymp__printsize__list__t.html">00107</a> <span class="keyword">typedef</span> <span class="keyword">struct </span>{
<a name="l00108"></a><a class="code" href="structolymp__printsize__list__t.html#o0">00108</a>   <span class="keyword">const</span> <a class="code" href="structolymp__printsize__t.html">olymp_printsize_t</a> *item;
<a name="l00109"></a><a class="code" href="structolymp__printsize__list__t.html#o1">00109</a>   size_t n_items;
00110 } <a class="code" href="structolymp__printsize__list__t.html">olymp_printsize_list_t</a>;
00111 
00112 
<a name="l00113"></a><a class="code" href="structlaminate__t.html">00113</a> <span class="keyword">typedef</span> <span class="keyword">struct </span>{
<a name="l00114"></a><a class="code" href="structlaminate__t.html#o0">00114</a>   <span class="keyword">const</span> <span class="keywordtype">char</span> *name;
<a name="l00115"></a><a class="code" href="structlaminate__t.html#o1">00115</a>   <span class="keyword">const</span> <span class="keywordtype">char</span> *text;
<a name="l00116"></a><a class="code" href="structlaminate__t.html#o2">00116</a>   <span class="keyword">const</span> <a class="code" href="structstp__raw__t.html">stp_raw_t</a> seq;
00117 } <a class="code" href="structlaminate__t.html">laminate_t</a>;
00118 
<a name="l00119"></a><a class="code" href="structlaminate__list__t.html">00119</a> <span class="keyword">typedef</span> <span class="keyword">struct </span>{
<a name="l00120"></a><a class="code" href="structlaminate__list__t.html#o0">00120</a>   <span class="keyword">const</span> <a class="code" href="structlaminate__t.html">laminate_t</a> *item;
<a name="l00121"></a><a class="code" href="structlaminate__list__t.html#o1">00121</a>   size_t n_items;
00122 } <a class="code" href="structlaminate__list__t.html">laminate_list_t</a>;
00123 
<a name="l00124"></a><a class="code" href="structolympus__privdata__t.html">00124</a> <span class="keyword">typedef</span> <span class="keyword">struct</span>
00125 <span class="keyword"></span>{
<a name="l00126"></a><a class="code" href="structolympus__privdata__t.html#o1">00126</a>   <span class="keywordtype">int</span> xdpi, ydpi;
<a name="l00127"></a><a class="code" href="structolympus__privdata__t.html#o3">00127</a>   <span class="keywordtype">int</span> xsize, ysize;
<a name="l00128"></a><a class="code" href="structolympus__privdata__t.html#o4">00128</a>   <span class="keywordtype">char</span> plane;
<a name="l00129"></a><a class="code" href="structolympus__privdata__t.html#o6">00129</a>   <span class="keywordtype">int</span> block_min_x, block_min_y;
<a name="l00130"></a><a class="code" href="structolympus__privdata__t.html#o8">00130</a>   <span class="keywordtype">int</span> block_max_x, block_max_y;
<a name="l00131"></a><a class="code" href="structolympus__privdata__t.html#o9">00131</a>   <span class="keyword">const</span> <span class="keywordtype">char</span>* pagesize;
<a name="l00132"></a><a class="code" href="structolympus__privdata__t.html#o10">00132</a>   <span class="keyword">const</span> <a class="code" href="structlaminate__t.html">laminate_t</a>* laminate;
00133 } <a class="code" href="structolympus__privdata__t.html">olympus_privdata_t</a>;
00134 
<a name="l00135"></a><a class="code" href="print-olympus_8c.html#a14">00135</a> <span class="keyword">static</span> <a class="code" href="structolympus__privdata__t.html">olympus_privdata_t</a> <a class="code" href="print-olympus_8c.html#a14">privdata</a>;
00136 
<a name="l00137"></a><a class="code" href="structolympus__cap__t.html">00137</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><span class="comment">/* printer specific parameters */</span>
00138 {
<a name="l00139"></a><a class="code" href="structolympus__cap__t.html#o0">00139</a>   <span class="keywordtype">int</span> model;            <span class="comment">/* printer model number from printers.xml*/</span>
<a name="l00140"></a><a class="code" href="structolympus__cap__t.html#o1">00140</a>   <span class="keyword">const</span> <a class="code" href="structink__list__t.html">ink_list_t</a> *inks;
<a name="l00141"></a><a class="code" href="structolympus__cap__t.html#o2">00141</a>   <span class="keyword">const</span> <a class="code" href="structolymp__resolution__list__t.html">olymp_resolution_list_t</a> *resolution;
<a name="l00142"></a><a class="code" href="structolympus__cap__t.html#o3">00142</a>   <span class="keyword">const</span> <a class="code" href="structolymp__pagesize__list__t.html">olymp_pagesize_list_t</a> *pages;
<a name="l00143"></a><a class="code" href="structolympus__cap__t.html#o4">00143</a>   <span class="keyword">const</span> <a class="code" href="structolymp__printsize__list__t.html">olymp_printsize_list_t</a> *printsize;
<a name="l00144"></a><a class="code" href="structolympus__cap__t.html#o5">00144</a>   <span class="keywordtype">int</span> interlacing;      <span class="comment">/* color interlacing scheme */</span>
<a name="l00145"></a><a class="code" href="structolympus__cap__t.html#o6">00145</a>   <span class="keywordtype">int</span> block_size;
<a name="l00146"></a><a class="code" href="structolympus__cap__t.html#o7">00146</a>   <span class="keywordtype">int</span> features;         
00147   void (*printer_init_func)(<a class="code" href="structstp__vars.html">stp_vars_t</a> *);
00148   void (*printer_end_func)(<a class="code" href="structstp__vars.html">stp_vars_t</a> *);
00149   void (*plane_init_func)(<a class="code" href="structstp__vars.html">stp_vars_t</a> *);
00150   void (*plane_end_func)(<a class="code" href="structstp__vars.html">stp_vars_t</a> *);
00151   void (*block_init_func)(<a class="code" href="structstp__vars.html">stp_vars_t</a> *);
00152   void (*block_end_func)(<a class="code" href="structstp__vars.html">stp_vars_t</a> *);
<a name="l00153"></a><a class="code" href="structolympus__cap__t.html#o14">00153</a>   <span class="keyword">const</span> <span class="keywordtype">char</span> *adj_cyan;         <span class="comment">/* default color adjustment */</span>
<a name="l00154"></a><a class="code" href="structolympus__cap__t.html#o15">00154</a>   <span class="keyword">const</span> <span class="keywordtype">char</span> *adj_magenta;
<a name="l00155"></a><a class="code" href="structolympus__cap__t.html#o16">00155</a>   <span class="keyword">const</span> <span class="keywordtype">char</span> *adj_yellow;
<a name="l00156"></a><a class="code" href="structolympus__cap__t.html#o17">00156</a>   <span class="keyword">const</span> <a class="code" href="structlaminate__list__t.html">laminate_list_t</a> *laminate;
00157 } <a class="code" href="structolympus__cap__t.html">olympus_cap_t</a>;
00158 
00159 
00160 <span class="keyword">static</span> <span class="keyword">const</span> <a class="code" href="structolympus__cap__t.html">olympus_cap_t</a>* <a class="code" href="print-olympus_8c.html#a97">olympus_get_model_capabilities</a>(<span class="keywordtype">int</span> model);
00161 <span class="keyword">static</span> <span class="keyword">const</span> <a class="code" href="structlaminate__t.html">laminate_t</a>* <a class="code" href="print-olympus_8c.html#a98">olympus_get_laminate_pattern</a>(<a class="code" href="structstp__vars.html">stp_vars_t</a> *v);
00162 
00163 
<a name="l00164"></a><a class="code" href="print-olympus_8c.html#a15">00164</a> <span class="keyword">static</span> <span class="keyword">const</span> <a class="code" href="structink__t.html">ink_t</a> <a class="code" href="print-olympus_8c.html#a15">cmy_inks</a>[] =
00165 {
00166   { <span class="stringliteral">"CMY"</span>, 3, <span class="stringliteral">"CMY"</span>, <span class="stringliteral">"\1\2\3"</span> },
00167 };
00168 
<a name="l00169"></a><a class="code" href="print-olympus_8c.html#a16">00169</a> <span class="keyword">static</span> <span class="keyword">const</span> <a class="code" href="structink__list__t.html">ink_list_t</a> <a class="code" href="print-olympus_8c.html#a16">cmy_ink_list</a> =
00170 {
00171   <a class="code" href="print-olympus_8c.html#a15">cmy_inks</a>, <span class="keyword">sizeof</span>(<a class="code" href="print-olympus_8c.html#a15">cmy_inks</a>) / <span class="keyword">sizeof</span>(<a class="code" href="structink__t.html">ink_t</a>)
00172 };
00173 
<a name="l00174"></a><a class="code" href="print-olympus_8c.html#a17">00174</a> <span class="keyword">static</span> <span class="keyword">const</span> <a class="code" href="structink__t.html">ink_t</a> <a class="code" href="print-olympus_8c.html#a17">ymc_inks</a>[] =
00175 {
00176   { <span class="stringliteral">"CMY"</span>, 3, <span class="stringliteral">"CMY"</span>, <span class="stringliteral">"\3\2\1"</span> },
00177 };
00178 
<a name="l00179"></a><a class="code" href="print-olympus_8c.html#a18">00179</a> <span class="keyword">static</span> <span class="keyword">const</span> <a class="code" href="structink__list__t.html">ink_list_t</a> <a class="code" href="print-olympus_8c.html#a18">ymc_ink_list</a> =
00180 {
00181   <a class="code" href="print-olympus_8c.html#a17">ymc_inks</a>, <span class="keyword">sizeof</span>(<a class="code" href="print-olympus_8c.html#a17">ymc_inks</a>) / <span class="keyword">sizeof</span>(<a class="code" href="structink__t.html">ink_t</a>)
00182 };
00183 
<a name="l00184"></a><a class="code" href="print-olympus_8c.html#a19">00184</a> <span class="keyword">static</span> <span class="keyword">const</span> <a class="code" href="structink__t.html">ink_t</a> <a class="code" href="print-olympus_8c.html#a19">rgb_inks</a>[] =
00185 {
00186   { <span class="stringliteral">"RGB"</span>, 3, <span class="stringliteral">"RGB"</span>, <span class="stringliteral">"\1\2\3"</span> },
00187 };
00188 
<a name="l00189"></a><a class="code" href="print-olympus_8c.html#a20">00189</a> <span class="keyword">static</span> <span class="keyword">const</span> <a class="code" href="structink__list__t.html">ink_list_t</a> <a class="code" href="print-olympus_8c.html#a20">rgb_ink_list</a> =
00190 {
00191   <a class="code" href="print-olympus_8c.html#a19">rgb_inks</a>, <span class="keyword">sizeof</span>(<a class="code" href="print-olympus_8c.html#a19">rgb_inks</a>) / <span class="keyword">sizeof</span>(<a class="code" href="structink__t.html">ink_t</a>)
00192 };
00193 
<a name="l00194"></a><a class="code" href="print-olympus_8c.html#a21">00194</a> <span class="keyword">static</span> <span class="keyword">const</span> <a class="code" href="structink__t.html">ink_t</a> <a class="code" href="print-olympus_8c.html#a21">bgr_inks</a>[] =
00195 {
00196   { <span class="stringliteral">"RGB"</span>, 3, <span class="stringliteral">"RGB"</span>, <span class="stringliteral">"\3\2\1"</span> },
00197 };
00198 
<a name="l00199"></a><a class="code" href="print-olympus_8c.html#a22">00199</a> <span class="keyword">static</span> <span class="keyword">const</span> <a class="code" href="structink__list__t.html">ink_list_t</a> <a class="code" href="print-olympus_8c.html#a22">bgr_ink_list</a> =
00200 {
00201   <a class="code" href="print-olympus_8c.html#a21">bgr_inks</a>, <span class="keyword">sizeof</span>(<a class="code" href="print-olympus_8c.html#a21">bgr_inks</a>) / <span class="keyword">sizeof</span>(<a class="code" href="structink__t.html">ink_t</a>)
00202 };
00203 
00204 
00205 <span class="comment">/* Olympus P-10 */</span>
<a name="l00206"></a><a class="code" href="print-olympus_8c.html#a23">00206</a> <span class="keyword">static</span> <span class="keyword">const</span> <a class="code" href="structolymp__resolution__t.html">olymp_resolution_t</a> <a class="code" href="print-olympus_8c.html#a23">res_320dpi</a>[] =
00207 {
00208   { <span class="stringliteral">"320x320"</span>, 320, 320},
00209 };
00210 
<a name="l00211"></a><a class="code" href="print-olympus_8c.html#a24">00211</a> <span class="keyword">static</span> <span class="keyword">const</span> <a class="code" href="structolymp__resolution__list__t.html">olymp_resolution_list_t</a> <a class="code" href="print-olympus_8c.html#a24">res_320dpi_list</a> =
00212 {
00213   <a class="code" href="print-olympus_8c.html#a23">res_320dpi</a>, <span class="keyword">sizeof</span>(<a class="code" href="print-olympus_8c.html#a23">res_320dpi</a>) / <span class="keyword">sizeof</span>(<a class="code" href="structolymp__resolution__t.html">olymp_resolution_t</a>)
00214 };
00215 
<a name="l00216"></a><a class="code" href="print-olympus_8c.html#a25">00216</a> <span class="keyword">static</span> <span class="keyword">const</span> <a class="code" href="structolymp__pagesize__t.html">olymp_pagesize_t</a> <a class="code" href="print-olympus_8c.html#a25">p10_page</a>[] =
00217 {
00218   { <span class="stringliteral">"w288h432"</span>, <span class="stringliteral">"4 x 6"</span>, -1, -1, 0, 0, 16, 0},  <span class="comment">/* 4x6" */</span>
00219   { <span class="stringliteral">"B7"</span>, <span class="stringliteral">"3.5 x 5"</span>, -1, -1, 0, 0, 4, 0},       <span class="comment">/* 3.5x5" */</span>
00220   { <span class="stringliteral">"Custom"</span>, NULL, -1, -1, 28, 28, 48, 48},
00221 };
00222 
<a name="l00223"></a><a class="code" href="print-olympus_8c.html#a26">00223</a> <span class="keyword">static</span> <span class="keyword">const</span> <a class="code" href="structolymp__pagesize__list__t.html">olymp_pagesize_list_t</a> <a class="code" href="print-olympus_8c.html#a26">p10_page_list</a> =
00224 {
00225   <a class="code" href="print-olympus_8c.html#a25">p10_page</a>, <span class="keyword">sizeof</span>(<a class="code" href="print-olympus_8c.html#a25">p10_page</a>) / <span class="keyword">sizeof</span>(<a class="code" href="structolymp__pagesize__t.html">olymp_pagesize_t</a>)
00226 };
00227 
<a name="l00228"></a><a class="code" href="print-olympus_8c.html#a27">00228</a> <span class="keyword">static</span> <span class="keyword">const</span> <a class="code" href="structolymp__printsize__t.html">olymp_printsize_t</a> <a class="code" href="print-olympus_8c.html#a27">p10_printsize</a>[] =
00229 {
00230   { <span class="stringliteral">"320x320"</span>, <span class="stringliteral">"w288h432"</span>, 1280, 1848},
00231   { <span class="stringliteral">"320x320"</span>, <span class="stringliteral">"B7"</span>,  1144,  1591},
00232   { <span class="stringliteral">"320x320"</span>, <span class="stringliteral">"Custom"</span>, 1280, 1848},
00233 };
00234 
<a name="l00235"></a><a class="code" href="print-olympus_8c.html#a28">00235</a> <span class="keyword">static</span> <span class="keyword">const</span> <a class="code" href="structolymp__printsize__list__t.html">olymp_printsize_list_t</a> <a class="code" href="print-olympus_8c.html#a28">p10_printsize_list</a> =
00236 {
00237   <a class="code" href="print-olympus_8c.html#a27">p10_printsize</a>, <span class="keyword">sizeof</span>(<a class="code" href="print-olympus_8c.html#a27">p10_printsize</a>) / <span class="keyword">sizeof</span>(<a class="code" href="structolymp__printsize__t.html">olymp_printsize_t</a>)
00238 };
00239 
<a name="l00240"></a><a class="code" href="print-olympus_8c.html#a99">00240</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="print-olympus_8c.html#a99">p10_printer_init_func</a>(<a class="code" href="structstp__vars.html">stp_vars_t</a> *v)
00241 {
00242   <a class="code" href="group__util.html#ga10">stp_zfwrite</a>(<span class="stringliteral">"\033R\033M\033S\2\033N\1\033D\1\033Y"</span>, 1, 15, v);
00243   <a class="code" href="group__util.html#ga10">stp_zfwrite</a>((<a class="code" href="print-olympus_8c.html#a14">privdata</a>.<a class="code" href="structolympus__privdata__t.html#o10">laminate</a>-&gt;<a class="code" href="structlaminate__t.html#o2">seq</a>).data, 1,
00244                   (<a class="code" href="print-olympus_8c.html#a14">privdata</a>.<a class="code" href="structolympus__privdata__t.html#o10">laminate</a>-&gt;<a class="code" href="structlaminate__t.html#o2">seq</a>).bytes, v); <span class="comment">/* laminate */</span>
00245   <a class="code" href="group__util.html#ga10">stp_zfwrite</a>(<span class="stringliteral">"\033Z\0"</span>, 1, 3, v);
00246 }
00247 
<a name="l00248"></a><a class="code" href="print-olympus_8c.html#a100">00248</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="print-olympus_8c.html#a100">p10_printer_end_func</a>(<a class="code" href="structstp__vars.html">stp_vars_t</a> *v)
00249 {
00250   <a class="code" href="group__util.html#ga10">stp_zfwrite</a>(<span class="stringliteral">"\033P"</span>, 1, 2, v);
00251 }
00252 
<a name="l00253"></a><a class="code" href="print-olympus_8c.html#a101">00253</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="print-olympus_8c.html#a101">p10_block_init_func</a>(<a class="code" href="structstp__vars.html">stp_vars_t</a> *v)
00254 {
00255   <a class="code" href="print-util_8c.html#a7">stp_zprintf</a>(v, <span class="stringliteral">"\033T%c"</span>, <a class="code" href="print-olympus_8c.html#a14">privdata</a>.<a class="code" href="structolympus__privdata__t.html#o4">plane</a>);
00256   <a class="code" href="group__util.html#ga12">stp_put16_le</a>(<a class="code" href="print-olympus_8c.html#a14">privdata</a>.<a class="code" href="structolympus__privdata__t.html#o5">block_min_x</a>, v);
00257   <a class="code" href="group__util.html#ga12">stp_put16_le</a>(<a class="code" href="print-olympus_8c.html#a14">privdata</a>.<a class="code" href="structolympus__privdata__t.html#o6">block_min_y</a>, v);
00258   <a class="code" href="group__util.html#ga12">stp_put16_le</a>(<a class="code" href="print-olympus_8c.html#a14">privdata</a>.<a class="code" href="structolympus__privdata__t.html#o7">block_max_x</a> + 1, v);
00259   <a class="code" href="group__util.html#ga12">stp_put16_le</a>(<a class="code" href="print-olympus_8c.html#a14">privdata</a>.<a class="code" href="structolympus__privdata__t.html#o8">block_max_y</a> + 1, v);
00260 }
00261 
<a name="l00262"></a><a class="code" href="print-olympus_8c.html#a29">00262</a> <span class="keyword">static</span> <span class="keyword">const</span> <a class="code" href="structlaminate__t.html">laminate_t</a> <a class="code" href="print-olympus_8c.html#a29">p10_laminate</a>[] =
00263 {
00264   {<span class="stringliteral">"Coated"</span>,  <a class="code" href="group__intl__internal.html#ga6">N_</a>(<span class="stringliteral">"Coated"</span>),  {1, <span class="stringliteral">"\x00"</span>}},
00265   {<span class="stringliteral">"None"</span>,    <a class="code" href="group__intl__internal.html#ga6">N_</a>(<span class="stringliteral">"None"</span>),    {1, <span class="stringliteral">"\x02"</span>}},
00266 };
00267 
<a name="l00268"></a><a class="code" href="print-olympus_8c.html#a30">00268</a> <span class="keyword">static</span> <span class="keyword">const</span> <a class="code" href="structlaminate__list__t.html">laminate_list_t</a> <a class="code" href="print-olympus_8c.html#a30">p10_laminate_list</a> =
00269 {
00270   <a class="code" href="print-olympus_8c.html#a29">p10_laminate</a>, <span class="keyword">sizeof</span>(<a class="code" href="print-olympus_8c.html#a29">p10_laminate</a>) / <span class="keyword">sizeof</span>(<a class="code" href="structlaminate__t.html">laminate_t</a>)
00271 };
00272 
00273 
00274 <span class="comment">/* Olympus P-200 series */</span>
<a name="l00275"></a><a class="code" href="print-olympus_8c.html#a31">00275</a> <span class="keyword">static</span> <span class="keyword">const</span> <a class="code" href="structolymp__pagesize__t.html">olymp_pagesize_t</a> <a class="code" href="print-olympus_8c.html#a31">p200_page</a>[] =
00276 {
00277   { <span class="stringliteral">"ISOB7"</span>, <span class="stringliteral">"80x125mm"</span>, -1, -1, 16, 17, 33, 33},
00278   { <span class="stringliteral">"Custom"</span>, NULL, -1, -1, 16, 17, 33, 33},
00279 };
00280 
<a name="l00281"></a><a class="code" href="print-olympus_8c.html#a32">00281</a> <span class="keyword">static</span> <span class="keyword">const</span> <a class="code" href="structolymp__pagesize__list__t.html">olymp_pagesize_list_t</a> <a class="code" href="print-olympus_8c.html#a32">p200_page_list</a> =
00282 {
00283   <a class="code" href="print-olympus_8c.html#a31">p200_page</a>, <span class="keyword">sizeof</span>(<a class="code" href="print-olympus_8c.html#a31">p200_page</a>) / <span class="keyword">sizeof</span>(<a class="code" href="structolymp__pagesize__t.html">olymp_pagesize_t</a>)
00284 };
00285 
<a name="l00286"></a><a class="code" href="print-olympus_8c.html#a33">00286</a> <span class="keyword">static</span> <span class="keyword">const</span> <a class="code" href="structolymp__printsize__t.html">olymp_printsize_t</a> <a class="code" href="print-olympus_8c.html#a33">p200_printsize</a>[] =
00287 {
00288   { <span class="stringliteral">"320x320"</span>, <span class="stringliteral">"ISOB7"</span>, 960, 1280},
00289   { <span class="stringliteral">"320x320"</span>, <span class="stringliteral">"Custom"</span>, 960, 1280},
00290 };
00291 
<a name="l00292"></a><a class="code" href="print-olympus_8c.html#a34">00292</a> <span class="keyword">static</span> <span class="keyword">const</span> <a class="code" href="structolymp__printsize__list__t.html">olymp_printsize_list_t</a> <a class="code" href="print-olympus_8c.html#a34">p200_printsize_list</a> =
00293 {
00294   <a class="code" href="print-olympus_8c.html#a33">p200_printsize</a>, <span class="keyword">sizeof</span>(<a class="code" href="print-olympus_8c.html#a33">p200_printsize</a>) / <span class="keyword">sizeof</span>(<a class="code" href="structolymp__printsize__t.html">olymp_printsize_t</a>)
00295 };
00296 
<a name="l00297"></a><a class="code" href="print-olympus_8c.html#a102">00297</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="print-olympus_8c.html#a102">p200_printer_init_func</a>(<a class="code" href="structstp__vars.html">stp_vars_t</a> *v)
00298 {
00299   <a class="code" href="group__util.html#ga10">stp_zfwrite</a>(<span class="stringliteral">"S000001\0S010001\1"</span>, 1, 16, v);
00300 }
00301 
<a name="l00302"></a><a class="code" href="print-olympus_8c.html#a103">00302</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="print-olympus_8c.html#a103">p200_plane_init_func</a>(<a class="code" href="structstp__vars.html">stp_vars_t</a> *v)
00303 {
00304   <a class="code" href="print-util_8c.html#a7">stp_zprintf</a>(v, <span class="stringliteral">"P0%d9999"</span>, 3 - <a class="code" href="print-olympus_8c.html#a14">privdata</a>.<a class="code" href="structolympus__privdata__t.html#o4">plane</a>+1 );
00305   <a class="code" href="group__util.html#ga15">stp_put32_be</a>(<a class="code" href="print-olympus_8c.html#a14">privdata</a>.<a class="code" href="structolympus__privdata__t.html#o2">xsize</a> * <a class="code" href="print-olympus_8c.html#a14">privdata</a>.<a class="code" href="structolympus__privdata__t.html#o3">ysize</a>, v);
00306 }
00307 
<a name="l00308"></a><a class="code" href="print-olympus_8c.html#a104">00308</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="print-olympus_8c.html#a104">p200_printer_end_func</a>(<a class="code" href="structstp__vars.html">stp_vars_t</a> *v)
00309 {
00310   <a class="code" href="print-util_8c.html#a7">stp_zprintf</a>(v, <span class="stringliteral">"P000001\1"</span>);
00311 }
00312 
<a name="l00313"></a><a class="code" href="print-olympus_8c.html#a35">00313</a> <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span> <a class="code" href="print-olympus_8c.html#a35">p200_adj_any</a>[] =
00314   <span class="stringliteral">"&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n"</span>
00315   <span class="stringliteral">"&lt;gimp-print&gt;\n"</span>
00316   <span class="stringliteral">"&lt;curve wrap=\"nowrap\" type=\"spline\" gamma=\"0\"&gt;\n"</span>
00317   <span class="stringliteral">"&lt;sequence count=\"33\" lower-bound=\"0\" upper-bound=\"1\"&gt;\n"</span>
00318   <span class="stringliteral">"0.000000 0.039216 0.078431 0.117647 0.152941 0.192157 0.231373 0.266667\n"</span>
00319   <span class="stringliteral">"0.301961 0.341176 0.376471 0.411765 0.447059 0.482353 0.513725 0.549020\n"</span>
00320   <span class="stringliteral">"0.580392 0.615686 0.647059 0.678431 0.709804 0.741176 0.768627 0.796078\n"</span>
00321   <span class="stringliteral">"0.827451 0.854902 0.878431 0.905882 0.929412 0.949020 0.972549 0.988235\n"</span>
00322   <span class="stringliteral">"1.000000\n"</span>
00323   <span class="stringliteral">"&lt;/sequence&gt;\n"</span>
00324   <span class="stringliteral">"&lt;/curve&gt;\n"</span>
00325   <span class="stringliteral">"&lt;/gimp-print&gt;\n"</span>;
00326 
00327 
00328 <span class="comment">/* Olympus P-300 series */</span>
<a name="l00329"></a><a class="code" href="print-olympus_8c.html#a36">00329</a> <span class="keyword">static</span> <span class="keyword">const</span> <a class="code" href="structolymp__resolution__t.html">olymp_resolution_t</a> <a class="code" href="print-olympus_8c.html#a36">p300_res</a>[] =
00330 {
00331   { <span class="stringliteral">"306x306"</span>, 306, 306},
00332   { <span class="stringliteral">"153x153"</span>, 153, 153},
00333 };
00334 
<a name="l00335"></a><a class="code" href="print-olympus_8c.html#a37">00335</a> <span class="keyword">static</span> <span class="keyword">const</span> <a class="code" href="structolymp__resolution__list__t.html">olymp_resolution_list_t</a> <a class="code" href="print-olympus_8c.html#a37">p300_res_list</a> =
00336 {
00337   <a class="code" href="print-olympus_8c.html#a36">p300_res</a>, <span class="keyword">sizeof</span>(<a class="code" href="print-olympus_8c.html#a36">p300_res</a>) / <span class="keyword">sizeof</span>(<a class="code" href="structolymp__resolution__t.html">olymp_resolution_t</a>)
00338 };
00339 
<a name="l00340"></a><a class="code" href="print-olympus_8c.html#a38">00340</a> <span class="keyword">static</span> <span class="keyword">const</span> <a class="code" href="structolymp__pagesize__t.html">olymp_pagesize_t</a> <a class="code" href="print-olympus_8c.html#a38">p300_page</a>[] =
00341 {
00342   { <span class="stringliteral">"A6"</span>, NULL, -1, -1, 28, 28, 48, 48},
00343   { <span class="stringliteral">"Custom"</span>, NULL, -1, -1, 28, 28, 48, 48},
00344 };
00345 
<a name="l00346"></a><a class="code" href="print-olympus_8c.html#a39">00346</a> <span class="keyword">static</span> <span class="keyword">const</span> <a class="code" href="structolymp__pagesize__list__t.html">olymp_pagesize_list_t</a> <a class="code" href="print-olympus_8c.html#a39">p300_page_list</a> =
00347 {
00348   <a class="code" href="print-olympus_8c.html#a38">p300_page</a>, <span class="keyword">sizeof</span>(<a class="code" href="print-olympus_8c.html#a38">p300_page</a>) / <span class="keyword">sizeof</span>(<a class="code" href="structolymp__pagesize__t.html">olymp_pagesize_t</a>)
00349 };
00350 
<a name="l00351"></a><a class="code" href="print-olympus_8c.html#a40">00351</a> <span class="keyword">static</span> <span class="keyword">const</span> <a class="code" href="structolymp__printsize__t.html">olymp_printsize_t</a> <a class="code" href="print-olympus_8c.html#a40">p300_printsize</a>[] =
00352 {
00353   { <span class="stringliteral">"306x306"</span>, <span class="stringliteral">"A6"</span>, 1024, 1376},
00354   { <span class="stringliteral">"153x153"</span>, <span class="stringliteral">"A6"</span>,  512,  688},
00355   { <span class="stringliteral">"306x306"</span>, <span class="stringliteral">"Custom"</span>, 1024, 1376},
00356   { <span class="stringliteral">"153x153"</span>, <span class="stringliteral">"Custom"</span>, 1024, 1376},
00357 };
00358 
<a name="l00359"></a><a class="code" href="print-olympus_8c.html#a41">00359</a> <span class="keyword">static</span> <span class="keyword">const</span> <a class="code" href="structolymp__printsize__list__t.html">olymp_printsize_list_t</a> <a class="code" href="print-olympus_8c.html#a41">p300_printsize_list</a> =
00360 {
00361   <a class="code" href="print-olympus_8c.html#a40">p300_printsize</a>, <span class="keyword">sizeof</span>(<a class="code" href="print-olympus_8c.html#a40">p300_printsize</a>) / <span class="keyword">sizeof</span>(<a class="code" href="structolymp__printsize__t.html">olymp_printsize_t</a>)
00362 };
00363 
<a name="l00364"></a><a class="code" href="print-olympus_8c.html#a105">00364</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="print-olympus_8c.html#a105">p300_printer_init_func</a>(<a class="code" href="structstp__vars.html">stp_vars_t</a> *v)
00365 {
00366   <a class="code" href="group__util.html#ga10">stp_zfwrite</a>(<span class="stringliteral">"\033\033\033C\033N\1\033F\0\1\033MS\xff\xff\xff"</span>
00367               <span class="stringliteral">"\033Z"</span>, 1, 19, v);
00368   <a class="code" href="group__util.html#ga13">stp_put16_be</a>(<a class="code" href="print-olympus_8c.html#a14">privdata</a>.<a class="code" href="structolympus__privdata__t.html#o0">xdpi</a>, v);
00369   <a class="code" href="group__util.html#ga13">stp_put16_be</a>(<a class="code" href="print-olympus_8c.html#a14">privdata</a>.<a class="code" href="structolympus__privdata__t.html#o1">ydpi</a>, v);
00370 }
00371 
<a name="l00372"></a><a class="code" href="print-olympus_8c.html#a106">00372</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="print-olympus_8c.html#a106">p300_plane_end_func</a>(<a class="code" href="structstp__vars.html">stp_vars_t</a> *v)
00373 {
00374   <span class="keyword">const</span> <span class="keywordtype">char</span> *c = <span class="stringliteral">"CMY"</span>;
00375   <a class="code" href="print-util_8c.html#a7">stp_zprintf</a>(v, <span class="stringliteral">"\033\033\033P%cS"</span>, c[<a class="code" href="print-olympus_8c.html#a14">privdata</a>.<a class="code" href="structolympus__privdata__t.html#o4">plane</a>-1]);
00376   <a class="code" href="print-util_8c.html#a24">stp_deprintf</a>(<a class="code" href="group__util.html#ga49">STP_DBG_OLYMPUS</a>, <span class="stringliteral">"olympus: p300_plane_end_func: %c\n"</span>,
00377         c[<a class="code" href="print-olympus_8c.html#a14">privdata</a>.<a class="code" href="structolympus__privdata__t.html#o4">plane</a>-1]);
00378 }
00379 
<a name="l00380"></a><a class="code" href="print-olympus_8c.html#a107">00380</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="print-olympus_8c.html#a107">p300_block_init_func</a>(<a class="code" href="structstp__vars.html">stp_vars_t</a> *v)
00381 {
00382   <span class="keyword">const</span> <span class="keywordtype">char</span> *c = <span class="stringliteral">"CMY"</span>;
00383   <a class="code" href="print-util_8c.html#a7">stp_zprintf</a>(v, <span class="stringliteral">"\033\033\033W%c"</span>, c[<a class="code" href="print-olympus_8c.html#a14">privdata</a>.<a class="code" href="structolympus__privdata__t.html#o4">plane</a>-1]);
00384   <a class="code" href="group__util.html#ga13">stp_put16_be</a>(<a class="code" href="print-olympus_8c.html#a14">privdata</a>.<a class="code" href="structolympus__privdata__t.html#o6">block_min_y</a>, v);
00385   <a class="code" href="group__util.html#ga13">stp_put16_be</a>(<a class="code" href="print-olympus_8c.html#a14">privdata</a>.<a class="code" href="structolympus__privdata__t.html#o5">block_min_x</a>, v);
00386   <a class="code" href="group__util.html#ga13">stp_put16_be</a>(<a class="code" href="print-olympus_8c.html#a14">privdata</a>.<a class="code" href="structolympus__privdata__t.html#o8">block_max_y</a>, v);
00387   <a class="code" href="group__util.html#ga13">stp_put16_be</a>(<a class="code" href="print-olympus_8c.html#a14">privdata</a>.<a class="code" href="structolympus__privdata__t.html#o7">block_max_x</a>, v);
00388 
00389   <a class="code" href="print-util_8c.html#a24">stp_deprintf</a>(<a class="code" href="group__util.html#ga49">STP_DBG_OLYMPUS</a>, <span class="stringliteral">"olympus: p300_block_init_func: %d-%dx%d-%d\n"</span>,
00390         <a class="code" href="print-olympus_8c.html#a14">privdata</a>.<a class="code" href="structolympus__privdata__t.html#o5">block_min_x</a>, <a class="code" href="print-olympus_8c.html#a14">privdata</a>.<a class="code" href="structolympus__privdata__t.html#o7">block_max_x</a>,
00391         <a class="code" href="print-olympus_8c.html#a14">privdata</a>.<a class="code" href="structolympus__privdata__t.html#o6">block_min_y</a>, <a class="code" href="print-olympus_8c.html#a14">privdata</a>.<a class="code" href="structolympus__privdata__t.html#o8">block_max_y</a>);
00392 }
00393 
<a name="l00394"></a><a class="code" href="print-olympus_8c.html#a42">00394</a> <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span> <a class="code" href="print-olympus_8c.html#a42">p300_adj_cyan</a>[] =
00395   <span class="stringliteral">"&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n"</span>
00396   <span class="stringliteral">"&lt;gimp-print&gt;\n"</span>
00397   <span class="stringliteral">"&lt;curve wrap=\"nowrap\" type=\"spline\" gamma=\"0\"&gt;\n"</span>
00398   <span class="stringliteral">"&lt;sequence count=\"32\" lower-bound=\"0\" upper-bound=\"1\"&gt;\n"</span>
00399   <span class="stringliteral">"0.078431 0.211765 0.250980 0.282353 0.309804 0.333333 0.352941 0.368627\n"</span>
00400   <span class="stringliteral">"0.388235 0.403922 0.427451 0.443137 0.458824 0.478431 0.498039 0.513725\n"</span>
00401   <span class="stringliteral">"0.529412 0.545098 0.556863 0.576471 0.592157 0.611765 0.627451 0.647059\n"</span>
00402   <span class="stringliteral">"0.666667 0.682353 0.701961 0.713725 0.725490 0.729412 0.733333 0.737255\n"</span>
00403   <span class="stringliteral">"&lt;/sequence&gt;\n"</span>
00404   <span class="stringliteral">"&lt;/curve&gt;\n"</span>
00405   <span class="stringliteral">"&lt;/gimp-print&gt;\n"</span>;
00406 
<a name="l00407"></a><a class="code" href="print-olympus_8c.html#a43">00407</a> <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span> <a class="code" href="print-olympus_8c.html#a43">p300_adj_magenta</a>[] =
00408   <span class="stringliteral">"&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n"</span>
00409   <span class="stringliteral">"&lt;gimp-print&gt;\n"</span>
00410   <span class="stringliteral">"&lt;curve wrap=\"nowrap\" type=\"spline\" gamma=\"0\"&gt;\n"</span>
00411   <span class="stringliteral">"&lt;sequence count=\"32\" lower-bound=\"0\" upper-bound=\"1\"&gt;\n"</span>
00412   <span class="stringliteral">"0.047059 0.211765 0.250980 0.278431 0.305882 0.333333 0.349020 0.364706\n"</span>
00413   <span class="stringliteral">"0.380392 0.396078 0.415686 0.435294 0.450980 0.466667 0.482353 0.498039\n"</span>
00414   <span class="stringliteral">"0.513725 0.525490 0.541176 0.556863 0.572549 0.592157 0.611765 0.631373\n"</span>
00415   <span class="stringliteral">"0.650980 0.670588 0.694118 0.705882 0.721569 0.741176 0.745098 0.756863\n"</span>
00416   <span class="stringliteral">"&lt;/sequence&gt;\n"</span>
00417   <span class="stringliteral">"&lt;/curve&gt;\n"</span>
00418   <span class="stringliteral">"&lt;/gimp-print&gt;\n"</span>;
00419 
<a name="l00420"></a><a class="code" href="print-olympus_8c.html#a44">00420</a> <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span> <a class="code" href="print-olympus_8c.html#a44">p300_adj_yellow</a>[] =
00421   <span class="stringliteral">"&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n"</span>
00422   <span class="stringliteral">"&lt;gimp-print&gt;\n"</span>
00423   <span class="stringliteral">"&lt;curve wrap=\"nowrap\" type=\"spline\" gamma=\"0\"&gt;\n"</span>
00424   <span class="stringliteral">"&lt;sequence count=\"32\" lower-bound=\"0\" upper-bound=\"1\"&gt;\n"</span>
00425   <span class="stringliteral">"0.047059 0.117647 0.203922 0.250980 0.274510 0.301961 0.321569 0.337255\n"</span>
00426   <span class="stringliteral">"0.352941 0.364706 0.380392 0.396078 0.407843 0.423529 0.439216 0.450980\n"</span>
00427   <span class="stringliteral">"0.466667 0.482353 0.498039 0.513725 0.533333 0.552941 0.572549 0.596078\n"</span>
00428   <span class="stringliteral">"0.615686 0.635294 0.650980 0.666667 0.682353 0.690196 0.701961 0.713725\n"</span>
00429   <span class="stringliteral">"&lt;/sequence&gt;\n"</span>
00430   <span class="stringliteral">"&lt;/curve&gt;\n"</span>
00431   <span class="stringliteral">"&lt;/gimp-print&gt;\n"</span>;
00432 
00433 
00434 <span class="comment">/* Olympus P-400 series */</span>
<a name="l00435"></a><a class="code" href="print-olympus_8c.html#a45">00435</a> <span class="keyword">static</span> <span class="keyword">const</span> <a class="code" href="structolymp__resolution__t.html">olymp_resolution_t</a> <a class="code" href="print-olympus_8c.html#a45">res_314dpi</a>[] =
00436 {
00437   { <span class="stringliteral">"314x314"</span>, 314, 314},
00438 };
00439 
<a name="l00440"></a><a class="code" href="print-olympus_8c.html#a46">00440</a> <span class="keyword">static</span> <span class="keyword">const</span> <a class="code" href="structolymp__resolution__list__t.html">olymp_resolution_list_t</a> <a class="code" href="print-olympus_8c.html#a46">res_314dpi_list</a> =
00441 {
00442   <a class="code" href="print-olympus_8c.html#a45">res_314dpi</a>, <span class="keyword">sizeof</span>(<a class="code" href="print-olympus_8c.html#a45">res_314dpi</a>) / <span class="keyword">sizeof</span>(<a class="code" href="structolymp__resolution__t.html">olymp_resolution_t</a>)
00443 };
00444 
<a name="l00445"></a><a class="code" href="print-olympus_8c.html#a47">00445</a> <span class="keyword">static</span> <span class="keyword">const</span> <a class="code" href="structolymp__pagesize__t.html">olymp_pagesize_t</a> <a class="code" href="print-olympus_8c.html#a47">p400_page</a>[] =
00446 {
00447   { <span class="stringliteral">"A4"</span>, NULL, -1, -1, 22, 22, 54, 54},
00448   { <span class="stringliteral">"c8x10"</span>, <span class="stringliteral">"A5 wide"</span>, -1, -1, 58, 59, 84, 85},
00449   { <span class="stringliteral">"C6"</span>, <span class="stringliteral">"2 Postcards (A4)"</span>, -1, -1, 9, 9, 9, 9},
00450   { <span class="stringliteral">"Custom"</span>, NULL, -1, -1, 22, 22, 54, 54},
00451 };
00452 
<a name="l00453"></a><a class="code" href="print-olympus_8c.html#a48">00453</a> <span class="keyword">static</span> <span class="keyword">const</span> <a class="code" href="structolymp__pagesize__list__t.html">olymp_pagesize_list_t</a> <a class="code" href="print-olympus_8c.html#a48">p400_page_list</a> =
00454 {
00455   <a class="code" href="print-olympus_8c.html#a47">p400_page</a>, <span class="keyword">sizeof</span>(<a class="code" href="print-olympus_8c.html#a47">p400_page</a>) / <span class="keyword">sizeof</span>(<a class="code" href="structolymp__pagesize__t.html">olymp_pagesize_t</a>)
00456 };
00457 
<a name="l00458"></a><a class="code" href="print-olympus_8c.html#a49">00458</a> <span class="keyword">static</span> <span class="keyword">const</span> <a class="code" href="structolymp__printsize__t.html">olymp_printsize_t</a> <a class="code" href="print-olympus_8c.html#a49">p400_printsize</a>[] =
00459 {
00460   { <span class="stringliteral">"314x314"</span>, <span class="stringliteral">"A4"</span>, 2400, 3200},
00461   { <span class="stringliteral">"314x314"</span>, <span class="stringliteral">"c8x10"</span>, 2000, 2400},
00462   { <span class="stringliteral">"314x314"</span>, <span class="stringliteral">"C6"</span>, 1328, 1920},
00463   { <span class="stringliteral">"314x314"</span>, <span class="stringliteral">"Custom"</span>, 2400, 3200},
00464 };
00465 
<a name="l00466"></a><a class="code" href="print-olympus_8c.html#a50">00466</a> <span class="keyword">static</span> <span class="keyword">const</span> <a class="code" href="structolymp__printsize__list__t.html">olymp_printsize_list_t</a> <a class="code" href="print-olympus_8c.html#a50">p400_printsize_list</a> =
00467 {
00468   <a class="code" href="print-olympus_8c.html#a49">p400_printsize</a>, <span class="keyword">sizeof</span>(<a class="code" href="print-olympus_8c.html#a49">p400_printsize</a>) / <span class="keyword">sizeof</span>(<a class="code" href="structolymp__printsize__t.html">olymp_printsize_t</a>)
00469 };
00470 
<a name="l00471"></a><a class="code" href="print-olympus_8c.html#a108">00471</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="print-olympus_8c.html#a108">p400_printer_init_func</a>(<a class="code" href="structstp__vars.html">stp_vars_t</a> *v)
00472 {
00473   <span class="keywordtype">int</span> wide = (strcmp(<a class="code" href="print-olympus_8c.html#a14">privdata</a>.<a class="code" href="structolympus__privdata__t.html#o9">pagesize</a>, <span class="stringliteral">"c8x10"</span>) == 0
00474                   || strcmp(<a class="code" href="print-olympus_8c.html#a14">privdata</a>.<a class="code" href="structolympus__privdata__t.html#o9">pagesize</a>, <span class="stringliteral">"C6"</span>) == 0);
00475 
00476   <a class="code" href="print-util_8c.html#a7">stp_zprintf</a>(v, <span class="stringliteral">"\033ZQ"</span>); <a class="code" href="group__util.html#ga10">stp_zfwrite</a>(<a class="code" href="print-olympus_8c.html#a13">zero</a>, 1, 61, v);
00477   <a class="code" href="print-util_8c.html#a7">stp_zprintf</a>(v, <span class="stringliteral">"\033FP"</span>); <a class="code" href="group__util.html#ga10">stp_zfwrite</a>(<a class="code" href="print-olympus_8c.html#a13">zero</a>, 1, 61, v);
00478   <a class="code" href="print-util_8c.html#a7">stp_zprintf</a>(v, <span class="stringliteral">"\033ZF"</span>);
00479   <a class="code" href="group__util.html#ga11">stp_putc</a>((wide ? '\x40' : '\x00'), v); <a class="code" href="group__util.html#ga10">stp_zfwrite</a>(<a class="code" href="print-olympus_8c.html#a13">zero</a>, 1, 60, v);
00480   <a class="code" href="print-util_8c.html#a7">stp_zprintf</a>(v, <span class="stringliteral">"\033ZS"</span>);
00481   <span class="keywordflow">if</span> (wide)
00482     {
00483       <a class="code" href="group__util.html#ga13">stp_put16_be</a>(<a class="code" href="print-olympus_8c.html#a14">privdata</a>.<a class="code" href="structolympus__privdata__t.html#o3">ysize</a>, v);
00484       <a class="code" href="group__util.html#ga13">stp_put16_be</a>(<a class="code" href="print-olympus_8c.html#a14">privdata</a>.<a class="code" href="structolympus__privdata__t.html#o2">xsize</a>, v);
00485     }
00486   <span class="keywordflow">else</span>
00487     {
00488       <a class="code" href="group__util.html#ga13">stp_put16_be</a>(<a class="code" href="print-olympus_8c.html#a14">privdata</a>.<a class="code" href="structolympus__privdata__t.html#o2">xsize</a>, v);
00489       <a class="code" href="group__util.html#ga13">stp_put16_be</a>(<a class="code" href="print-olympus_8c.html#a14">privdata</a>.<a class="code" href="structolympus__privdata__t.html#o3">ysize</a>, v);
00490     }
00491   <a class="code" href="group__util.html#ga10">stp_zfwrite</a>(<a class="code" href="print-olympus_8c.html#a13">zero</a>, 1, 57, v);
00492   <a class="code" href="print-util_8c.html#a7">stp_zprintf</a>(v, <span class="stringliteral">"\033ZP"</span>); <a class="code" href="group__util.html#ga10">stp_zfwrite</a>(<a class="code" href="print-olympus_8c.html#a13">zero</a>, 1, 61, v);
00493 }
00494 
<a name="l00495"></a><a class="code" href="print-olympus_8c.html#a109">00495</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="print-olympus_8c.html#a109">p400_plane_init_func</a>(<a class="code" href="structstp__vars.html">stp_vars_t</a> *v)
00496 {
00497   <a class="code" href="print-util_8c.html#a7">stp_zprintf</a>(v, <span class="stringliteral">"\033ZC"</span>); <a class="code" href="group__util.html#ga10">stp_zfwrite</a>(<a class="code" href="print-olympus_8c.html#a13">zero</a>, 1, 61, v);
00498 }
00499 
<a name="l00500"></a><a class="code" href="print-olympus_8c.html#a110">00500</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="print-olympus_8c.html#a110">p400_plane_end_func</a>(<a class="code" href="structstp__vars.html">stp_vars_t</a> *v)
00501 {
00502   <a class="code" href="print-util_8c.html#a7">stp_zprintf</a>(v, <span class="stringliteral">"\033P"</span>); <a class="code" href="group__util.html#ga10">stp_zfwrite</a>(<a class="code" href="print-olympus_8c.html#a13">zero</a>, 1, 62, v);
00503 }
00504 
<a name="l00505"></a><a class="code" href="print-olympus_8c.html#a111">00505</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="print-olympus_8c.html#a111">p400_block_init_func</a>(<a class="code" href="structstp__vars.html">stp_vars_t</a> *v)
00506 {
00507   <span class="keywordtype">int</span> wide = (strcmp(<a class="code" href="print-olympus_8c.html#a14">privdata</a>.<a class="code" href="structolympus__privdata__t.html#o9">pagesize</a>, <span class="stringliteral">"c8x10"</span>) == 0
00508                   || strcmp(<a class="code" href="print-olympus_8c.html#a14">privdata</a>.<a class="code" href="structolympus__privdata__t.html#o9">pagesize</a>, <span class="stringliteral">"C6"</span>) == 0);
00509 
00510   <a class="code" href="print-util_8c.html#a7">stp_zprintf</a>(v, <span class="stringliteral">"\033Z%c"</span>, <span class="charliteral">'3'</span> - <a class="code" href="print-olympus_8c.html#a14">privdata</a>.<a class="code" href="structolympus__privdata__t.html#o4">plane</a> + 1);
00511   <span class="keywordflow">if</span> (wide)
00512     {
00513       <a class="code" href="group__util.html#ga13">stp_put16_be</a>(<a class="code" href="print-olympus_8c.html#a14">privdata</a>.<a class="code" href="structolympus__privdata__t.html#o3">ysize</a> - <a class="code" href="print-olympus_8c.html#a14">privdata</a>.<a class="code" href="structolympus__privdata__t.html#o8">block_max_y</a> - 1, v);
00514       <a class="code" href="group__util.html#ga13">stp_put16_be</a>(<a class="code" href="print-olympus_8c.html#a14">privdata</a>.<a class="code" href="structolympus__privdata__t.html#o2">xsize</a> - <a class="code" href="print-olympus_8c.html#a14">privdata</a>.<a class="code" href="structolympus__privdata__t.html#o7">block_max_x</a> - 1, v);
00515       <a class="code" href="group__util.html#ga13">stp_put16_be</a>(<a class="code" href="print-olympus_8c.html#a14">privdata</a>.<a class="code" href="structolympus__privdata__t.html#o8">block_max_y</a> - <a class="code" href="print-olympus_8c.html#a14">privdata</a>.<a class="code" href="structolympus__privdata__t.html#o6">block_min_y</a> + 1, v);
00516       <a class="code" href="group__util.html#ga13">stp_put16_be</a>(<a class="code" href="print-olympus_8c.html#a14">privdata</a>.<a class="code" href="structolympus__privdata__t.html#o7">block_max_x</a> - <a class="code" href="print-olympus_8c.html#a14">privdata</a>.<a class="code" href="structolympus__privdata__t.html#o5">block_min_x</a> + 1, v);
00517     }
00518   <span class="keywordflow">else</span>
00519     {
00520       <a class="code" href="group__util.html#ga13">stp_put16_be</a>(<a class="code" href="print-olympus_8c.html#a14">privdata</a>.<a class="code" href="structolympus__privdata__t.html#o5">block_min_x</a>, v);
00521       <a class="code" href="group__util.html#ga13">stp_put16_be</a>(<a class="code" href="print-olympus_8c.html#a14">privdata</a>.<a class="code" href="structolympus__privdata__t.html#o6">block_min_y</a>, v);
00522       <a class="code" href="group__util.html#ga13">stp_put16_be</a>(<a class="code" href="print-olympus_8c.html#a14">privdata</a>.<a class="code" href="structolympus__privdata__t.html#o7">block_max_x</a> - <a class="code" href="print-olympus_8c.html#a14">privdata</a>.<a class="code" href="structolympus__privdata__t.html#o5">block_min_x</a> + 1, v);
00523       <a class="code" href="group__util.html#ga13">stp_put16_be</a>(<a class="code" href="print-olympus_8c.html#a14">privdata</a>.<a class="code" href="structolympus__privdata__t.html#o8">block_max_y</a> - <a class="code" href="print-olympus_8c.html#a14">privdata</a>.<a class="code" href="structolympus__privdata__t.html#o6">block_min_y</a> + 1, v);
00524     }
00525   <a class="code" href="group__util.html#ga10">stp_zfwrite</a>(<a class="code" href="print-olympus_8c.html#a13">zero</a>, 1, 53, v);
00526 }
00527 
<a name="l00528"></a><a class="code" href="print-olympus_8c.html#a51">00528</a> <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span> <a class="code" href="print-olympus_8c.html#a51">p400_adj_cyan</a>[] =
00529   <span class="stringliteral">"&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n"</span>
00530   <span class="stringliteral">"&lt;gimp-print&gt;\n"</span>
00531   <span class="stringliteral">"&lt;curve wrap=\"nowrap\" type=\"spline\" gamma=\"0\"&gt;\n"</span>
00532   <span class="stringliteral">"&lt;sequence count=\"32\" lower-bound=\"0\" upper-bound=\"1\"&gt;\n"</span>
00533   <span class="stringliteral">"0.003922 0.031373 0.058824 0.090196 0.125490 0.156863 0.184314 0.219608\n"</span>
00534   <span class="stringliteral">"0.250980 0.278431 0.309804 0.341176 0.376471 0.403922 0.439216 0.470588\n"</span>
00535   <span class="stringliteral">"0.498039 0.517647 0.533333 0.545098 0.564706 0.576471 0.596078 0.615686\n"</span>
00536   <span class="stringliteral">"0.627451 0.647059 0.658824 0.678431 0.690196 0.705882 0.721569 0.737255\n"</span>
00537   <span class="stringliteral">"&lt;/sequence&gt;\n"</span>
00538   <span class="stringliteral">"&lt;/curve&gt;\n"</span>
00539   <span class="stringliteral">"&lt;/gimp-print&gt;\n"</span>;
00540   
<a name="l00541"></a><a class="code" href="print-olympus_8c.html#a52">00541</a> <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span> <a class="code" href="print-olympus_8c.html#a52">p400_adj_magenta</a>[] =
00542   <span class="stringliteral">"&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n"</span>
00543   <span class="stringliteral">"&lt;gimp-print&gt;\n"</span>
00544   <span class="stringliteral">"&lt;curve wrap=\"nowrap\" type=\"spline\" gamma=\"0\"&gt;\n"</span>
00545   <span class="stringliteral">"&lt;sequence count=\"32\" lower-bound=\"0\" upper-bound=\"1\"&gt;\n"</span>
00546   <span class="stringliteral">"0.003922 0.031373 0.062745 0.098039 0.125490 0.156863 0.188235 0.215686\n"</span>
00547   <span class="stringliteral">"0.250980 0.282353 0.309804 0.345098 0.376471 0.407843 0.439216 0.470588\n"</span>
00548   <span class="stringliteral">"0.501961 0.521569 0.549020 0.572549 0.592157 0.619608 0.643137 0.662745\n"</span>
00549   <span class="stringliteral">"0.682353 0.713725 0.737255 0.756863 0.784314 0.807843 0.827451 0.850980\n"</span>
00550   <span class="stringliteral">"&lt;/sequence&gt;\n"</span>
00551   <span class="stringliteral">"&lt;/curve&gt;\n"</span>
00552   <span class="stringliteral">"&lt;/gimp-print&gt;\n"</span>;
00553   
<a name="l00554"></a><a class="code" href="print-olympus_8c.html#a53">00554</a> <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span> <a class="code" href="print-olympus_8c.html#a53">p400_adj_yellow</a>[] =
00555   <span class="stringliteral">"&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n"</span>
00556   <span class="stringliteral">"&lt;gimp-print&gt;\n"</span>
00557   <span class="stringliteral">"&lt;curve wrap=\"nowrap\" type=\"spline\" gamma=\"0\"&gt;\n"</span>
00558   <span class="stringliteral">"&lt;sequence count=\"32\" lower-bound=\"0\" upper-bound=\"1\"&gt;\n"</span>
00559   <span class="stringliteral">"0.003922 0.027451 0.054902 0.090196 0.121569 0.156863 0.184314 0.215686\n"</span>
00560   <span class="stringliteral">"0.250980 0.282353 0.309804 0.345098 0.372549 0.400000 0.435294 0.466667\n"</span>
00561   <span class="stringliteral">"0.498039 0.525490 0.552941 0.580392 0.607843 0.631373 0.658824 0.678431\n"</span>
00562   <span class="stringliteral">"0.698039 0.725490 0.760784 0.784314 0.811765 0.839216 0.866667 0.890196\n"</span>
00563   <span class="stringliteral">"&lt;/sequence&gt;\n"</span>
00564   <span class="stringliteral">"&lt;/curve&gt;\n"</span>
00565   <span class="stringliteral">"&lt;/gimp-print&gt;\n"</span>;
00566 
00567 
00568 <span class="comment">/* Olympus P-440 series */</span>
<a name="l00569"></a><a class="code" href="print-olympus_8c.html#a54">00569</a> <span class="keyword">static</span> <span class="keyword">const</span> <a class="code" href="structolymp__pagesize__t.html">olymp_pagesize_t</a> <a class="code" href="print-olympus_8c.html#a54">p440_page</a>[] =
00570 {
00571   { <span class="stringliteral">"A4"</span>, NULL, -1, -1, 10, 9, 54, 54},
00572   { <span class="stringliteral">"c8x10"</span>, <span class="stringliteral">"A5 wide"</span>, -1, -1, 58, 59, 72, 72},
00573   { <span class="stringliteral">"C6"</span>, <span class="stringliteral">"2 Postcards (A4)"</span>, -1, -1, 9, 9, 9, 9},
00574   { <span class="stringliteral">"w255h581"</span>, <span class="stringliteral">"A6 wide"</span>, -1, -1, 25, 25, 25, 24},
00575   { <span class="stringliteral">"Custom"</span>, NULL, -1, -1, 22, 22, 54, 54},
00576 };
00577 
<a name="l00578"></a><a class="code" href="print-olympus_8c.html#a55">00578</a> <span class="keyword">static</span> <span class="keyword">const</span> <a class="code" href="structolymp__pagesize__list__t.html">olymp_pagesize_list_t</a> <a class="code" href="print-olympus_8c.html#a55">p440_page_list</a> =
00579 {
00580   <a class="code" href="print-olympus_8c.html#a54">p440_page</a>, <span class="keyword">sizeof</span>(<a class="code" href="print-olympus_8c.html#a54">p440_page</a>) / <span class="keyword">sizeof</span>(<a class="code" href="structolymp__pagesize__t.html">olymp_pagesize_t</a>)
00581 };
00582 
<a name="l00583"></a><a class="code" href="print-olympus_8c.html#a56">00583</a> <span class="keyword">static</span> <span class="keyword">const</span> <a class="code" href="structolymp__printsize__t.html">olymp_printsize_t</a> <a class="code" href="print-olympus_8c.html#a56">p440_printsize</a>[] =
00584 {
00585   { <span class="stringliteral">"314x314"</span>, <span class="stringliteral">"A4"</span>, 2508, 3200},
00586   { <span class="stringliteral">"314x314"</span>, <span class="stringliteral">"c8x10"</span>, 2000, 2508},
00587   { <span class="stringliteral">"314x314"</span>, <span class="stringliteral">"C6"</span>, 1328, 1920},
00588   { <span class="stringliteral">"314x314"</span>, <span class="stringliteral">"w255h581"</span>, 892, 2320},
00589   { <span class="stringliteral">"314x314"</span>, <span class="stringliteral">"Custom"</span>, 2508, 3200},
00590 };
00591 
<a name="l00592"></a><a class="code" href="print-olympus_8c.html#a57">00592</a> <span class="keyword">static</span> <span class="keyword">const</span> <a class="code" href="structolymp__printsize__list__t.html">olymp_printsize_list_t</a> <a class="code" href="print-olympus_8c.html#a57">p440_printsize_list</a> =
00593 {
00594   <a class="code" href="print-olympus_8c.html#a56">p440_printsize</a>, <span class="keyword">sizeof</span>(<a class="code" href="print-olympus_8c.html#a56">p440_printsize</a>) / <span class="keyword">sizeof</span>(<a class="code" href="structolymp__printsize__t.html">olymp_printsize_t</a>)
00595 };
00596 
<a name="l00597"></a><a class="code" href="print-olympus_8c.html#a112">00597</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="print-olympus_8c.html#a112">p440_printer_init_func</a>(<a class="code" href="structstp__vars.html">stp_vars_t</a> *v)
00598 {
00599   <span class="keywordtype">int</span> wide = ! (strcmp(<a class="code" href="print-olympus_8c.html#a14">privdata</a>.<a class="code" href="structolympus__privdata__t.html#o9">pagesize</a>, <span class="stringliteral">"A4"</span>) == 0
00600                   || strcmp(<a class="code" href="print-olympus_8c.html#a14">privdata</a>.<a class="code" href="structolympus__privdata__t.html#o9">pagesize</a>, <span class="stringliteral">"Custom"</span>) == 0);
00601 
00602   <a class="code" href="print-util_8c.html#a7">stp_zprintf</a>(v, <span class="stringliteral">"\033FP"</span>); <a class="code" href="group__util.html#ga10">stp_zfwrite</a>(<a class="code" href="print-olympus_8c.html#a13">zero</a>, 1, 61, v);
00603   <a class="code" href="print-util_8c.html#a7">stp_zprintf</a>(v, <span class="stringliteral">"\033Y"</span>);
00604   <a class="code" href="group__util.html#ga10">stp_zfwrite</a>((<a class="code" href="print-olympus_8c.html#a14">privdata</a>.<a class="code" href="structolympus__privdata__t.html#o10">laminate</a>-&gt;<a class="code" href="structlaminate__t.html#o2">seq</a>).data, 1,
00605                   (<a class="code" href="print-olympus_8c.html#a14">privdata</a>.<a class="code" href="structolympus__privdata__t.html#o10">laminate</a>-&gt;<a class="code" href="structlaminate__t.html#o2">seq</a>).bytes, v); <span class="comment">/* laminate */</span> 
00606   <a class="code" href="group__util.html#ga10">stp_zfwrite</a>(<a class="code" href="print-olympus_8c.html#a13">zero</a>, 1, 61, v);
00607   <a class="code" href="print-util_8c.html#a7">stp_zprintf</a>(v, <span class="stringliteral">"\033FC"</span>); <a class="code" href="group__util.html#ga10">stp_zfwrite</a>(<a class="code" href="print-olympus_8c.html#a13">zero</a>, 1, 61, v);
00608   <a class="code" href="print-util_8c.html#a7">stp_zprintf</a>(v, <span class="stringliteral">"\033ZF"</span>);
00609   <a class="code" href="group__util.html#ga11">stp_putc</a>((wide ? '\x40' : '\x00'), v); <a class="code" href="group__util.html#ga10">stp_zfwrite</a>(<a class="code" href="print-olympus_8c.html#a13">zero</a>, 1, 60, v);
00610   <a class="code" href="print-util_8c.html#a7">stp_zprintf</a>(v, <span class="stringliteral">"\033N\1"</span>); <a class="code" href="group__util.html#ga10">stp_zfwrite</a>(<a class="code" href="print-olympus_8c.html#a13">zero</a>, 1, 61, v);
00611   <a class="code" href="print-util_8c.html#a7">stp_zprintf</a>(v, <span class="stringliteral">"\033ZS"</span>);
00612   <span class="keywordflow">if</span> (wide)
00613     {
00614       <a class="code" href="group__util.html#ga13">stp_put16_be</a>(<a class="code" href="print-olympus_8c.html#a14">privdata</a>.<a class="code" href="structolympus__privdata__t.html#o3">ysize</a>, v);
00615       <a class="code" href="group__util.html#ga13">stp_put16_be</a>(<a class="code" href="print-olympus_8c.html#a14">privdata</a>.<a class="code" href="structolympus__privdata__t.html#o2">xsize</a>, v);
00616     }
00617   <span class="keywordflow">else</span>
00618     {
00619       <a class="code" href="group__util.html#ga13">stp_put16_be</a>(<a class="code" href="print-olympus_8c.html#a14">privdata</a>.<a class="code" href="structolympus__privdata__t.html#o2">xsize</a>, v);
00620       <a class="code" href="group__util.html#ga13">stp_put16_be</a>(<a class="code" href="print-olympus_8c.html#a14">privdata</a>.<a class="code" href="structolympus__privdata__t.html#o3">ysize</a>, v);
00621     }
00622   <a class="code" href="group__util.html#ga10">stp_zfwrite</a>(<a class="code" href="print-olympus_8c.html#a13">zero</a>, 1, 57, v);
00623   <span class="keywordflow">if</span> (strcmp(<a class="code" href="print-olympus_8c.html#a14">privdata</a>.<a class="code" href="structolympus__privdata__t.html#o9">pagesize</a>, <span class="stringliteral">"C6"</span>) == 0)
00624     {
00625       <a class="code" href="print-util_8c.html#a7">stp_zprintf</a>(v, <span class="stringliteral">"\033ZC"</span>); <a class="code" href="group__util.html#ga10">stp_zfwrite</a>(<a class="code" href="print-olympus_8c.html#a13">zero</a>, 1, 61, v);
00626     }
00627 }
00628 
<a name="l00629"></a><a class="code" href="print-olympus_8c.html#a113">00629</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="print-olympus_8c.html#a113">p440_printer_end_func</a>(<a class="code" href="structstp__vars.html">stp_vars_t</a> *v)
00630 {
00631   <a class="code" href="print-util_8c.html#a7">stp_zprintf</a>(v, <span class="stringliteral">"\033P"</span>); <a class="code" href="group__util.html#ga10">stp_zfwrite</a>(<a class="code" href="print-olympus_8c.html#a13">zero</a>, 1, 62, v);
00632 }
00633 
<a name="l00634"></a><a class="code" href="print-olympus_8c.html#a114">00634</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="print-olympus_8c.html#a114">p440_block_init_func</a>(<a class="code" href="structstp__vars.html">stp_vars_t</a> *v)
00635 {
00636   <span class="keywordtype">int</span> wide = ! (strcmp(<a class="code" href="print-olympus_8c.html#a14">privdata</a>.<a class="code" href="structolympus__privdata__t.html#o9">pagesize</a>, <span class="stringliteral">"A4"</span>) == 0
00637                   || strcmp(<a class="code" href="print-olympus_8c.html#a14">privdata</a>.<a class="code" href="structolympus__privdata__t.html#o9">pagesize</a>, <span class="stringliteral">"Custom"</span>) == 0);
00638 
00639   <a class="code" href="print-util_8c.html#a7">stp_zprintf</a>(v, <span class="stringliteral">"\033ZT"</span>);
00640   <span class="keywordflow">if</span> (wide)
00641     {
00642       <a class="code" href="group__util.html#ga13">stp_put16_be</a>(<a class="code" href="print-olympus_8c.html#a14">privdata</a>.<a class="code" href="structolympus__privdata__t.html#o3">ysize</a> - <a class="code" href="print-olympus_8c.html#a14">privdata</a>.<a class="code" href="structolympus__privdata__t.html#o8">block_max_y</a> - 1, v);
00643       <a class="code" href="group__util.html#ga13">stp_put16_be</a>(<a class="code" href="print-olympus_8c.html#a14">privdata</a>.<a class="code" href="structolympus__privdata__t.html#o2">xsize</a> - <a class="code" href="print-olympus_8c.html#a14">privdata</a>.<a class="code" href="structolympus__privdata__t.html#o7">block_max_x</a> - 1, v);
00644       <a class="code" href="group__util.html#ga13">stp_put16_be</a>(<a class="code" href="print-olympus_8c.html#a14">privdata</a>.<a class="code" href="structolympus__privdata__t.html#o8">block_max_y</a> - <a class="code" href="print-olympus_8c.html#a14">privdata</a>.<a class="code" href="structolympus__privdata__t.html#o6">block_min_y</a> + 1, v);
00645       <a class="code" href="group__util.html#ga13">stp_put16_be</a>(<a class="code" href="print-olympus_8c.html#a14">privdata</a>.<a class="code" href="structolympus__privdata__t.html#o7">block_max_x</a> - <a class="code" href="print-olympus_8c.html#a14">privdata</a>.<a class="code" href="structolympus__privdata__t.html#o5">block_min_x</a> + 1, v);
00646     }
00647   <span class="keywordflow">else</span>
00648     {
00649       <a class="code" href="group__util.html#ga13">stp_put16_be</a>(<a class="code" href="print-olympus_8c.html#a14">privdata</a>.<a class="code" href="structolympus__privdata__t.html#o5">block_min_x</a>, v);
00650       <a class="code" href="group__util.html#ga13">stp_put16_be</a>(<a class="code" href="print-olympus_8c.html#a14">privdata</a>.<a class="code" href="structolympus__privdata__t.html#o6">block_min_y</a>, v);
00651       <a class="code" href="group__util.html#ga13">stp_put16_be</a>(<a class="code" href="print-olympus_8c.html#a14">privdata</a>.<a class="code" href="structolympus__privdata__t.html#o7">block_max_x</a> - <a class="code" href="print-olympus_8c.html#a14">privdata</a>.<a class="code" href="structolympus__privdata__t.html#o5">block_min_x</a> + 1, v);
00652       <a class="code" href="group__util.html#ga13">stp_put16_be</a>(<a class="code" href="print-olympus_8c.html#a14">privdata</a>.<a class="code" href="structolympus__privdata__t.html#o8">block_max_y</a> - <a class="code" href="print-olympus_8c.html#a14">privdata</a>.<a class="code" href="structolympus__privdata__t.html#o6">block_min_y</a> + 1, v);
00653     }
00654   <a class="code" href="group__util.html#ga10">stp_zfwrite</a>(<a class="code" href="print-olympus_8c.html#a13">zero</a>, 1, 53, v);
00655 }
00656 
<a name="l00657"></a><a class="code" href="print-olympus_8c.html#a115">00657</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="print-olympus_8c.html#a115">p440_block_end_func</a>(<a class="code" href="structstp__vars.html">stp_vars_t</a> *v)
00658 {
00659   <span class="keywordtype">int</span> pad = (64 - (((<a class="code" href="print-olympus_8c.html#a14">privdata</a>.<a class="code" href="structolympus__privdata__t.html#o7">block_max_x</a> - <a class="code" href="print-olympus_8c.html#a14">privdata</a>.<a class="code" href="structolympus__privdata__t.html#o5">block_min_x</a> + 1)
00660           * (<a class="code" href="print-olympus_8c.html#a14">privdata</a>.<a class="code" href="structolympus__privdata__t.html#o8">block_max_y</a> - <a class="code" href="print-olympus_8c.html#a14">privdata</a>.<a class="code" href="structolympus__privdata__t.html#o6">block_min_y</a> + 1) * 3) % 64)) % 64;
00661   <a class="code" href="print-util_8c.html#a24">stp_deprintf</a>(<a class="code" href="group__util.html#ga49">STP_DBG_OLYMPUS</a>,
00662                   <span class="stringliteral">"olympus: max_x %d min_x %d max_y %d min_y %d\n"</span>,
00663                   <a class="code" href="print-olympus_8c.html#a14">privdata</a>.<a class="code" href="structolympus__privdata__t.html#o7">block_max_x</a>, <a class="code" href="print-olympus_8c.html#a14">privdata</a>.<a class="code" href="structolympus__privdata__t.html#o5">block_min_x</a>,
00664                   <a class="code" href="print-olympus_8c.html#a14">privdata</a>.<a class="code" href="structolympus__privdata__t.html#o8">block_max_y</a>, <a class="code" href="print-olympus_8c.html#a14">privdata</a>.<a class="code" href="structolympus__privdata__t.html#o6">block_min_y</a>);
00665   <a class="code" href="print-util_8c.html#a24">stp_deprintf</a>(<a class="code" href="group__util.html#ga49">STP_DBG_OLYMPUS</a>, <span class="stringliteral">"olympus: olympus-p440 padding=%d\n"</span>, pad);
00666   <a class="code" href="group__util.html#ga10">stp_zfwrite</a>(<a class="code" href="print-olympus_8c.html#a13">zero</a>, 1, pad, v);
00667 }
00668 
00669 
00670 <span class="comment">/* Canon CP-100 series */</span>
<a name="l00671"></a><a class="code" href="print-olympus_8c.html#a58">00671</a> <span class="keyword">static</span> <span class="keyword">const</span> <a class="code" href="structolymp__pagesize__t.html">olymp_pagesize_t</a> <a class="code" href="print-olympus_8c.html#a58">cpx00_page</a>[] =
00672 {
00673   { <span class="stringliteral">"Postcard"</span>, <span class="stringliteral">"Postcard 148x100mm"</span>, -1, -1, 13, 13, 16, 18},
00674   { <span class="stringliteral">"w253h337"</span>, <span class="stringliteral">"CP_L 89x119mm"</span>, -1, -1, 13, 13, 15, 15},
00675   { <span class="stringliteral">"w244h155"</span>, <span class="stringliteral">"Card 54x86mm"</span>, -1, -1, 15, 15, 13, 13},
00676   { <span class="stringliteral">"Custom"</span>, NULL, -1, -1, 13, 13, 16, 18},
00677 };
00678 
<a name="l00679"></a><a class="code" href="print-olympus_8c.html#a59">00679</a> <span class="keyword">static</span> <span class="keyword">const</span> <a class="code" href="structolymp__pagesize__list__t.html">olymp_pagesize_list_t</a> <a class="code" href="print-olympus_8c.html#a59">cpx00_page_list</a> =
00680 {
00681   <a class="code" href="print-olympus_8c.html#a58">cpx00_page</a>, <span class="keyword">sizeof</span>(<a class="code" href="print-olympus_8c.html#a58">cpx00_page</a>) / <span class="keyword">sizeof</span>(<a class="code" href="structolymp__pagesize__t.html">olymp_pagesize_t</a>)
00682 };
00683 
<a name="l00684"></a><a class="code" href="print-olympus_8c.html#a60">00684</a> <span class="keyword">static</span> <span class="keyword">const</span> <a class="code" href="structolymp__printsize__t.html">olymp_printsize_t</a> <a class="code" href="print-olympus_8c.html#a60">cpx00_printsize</a>[] =
00685 {
00686   { <span class="stringliteral">"314x314"</span>, <span class="stringliteral">"Postcard"</span>, 1232, 1808},
00687   { <span class="stringliteral">"314x314"</span>, <span class="stringliteral">"w253h337"</span>, 1100, 1456},
00688   { <span class="stringliteral">"314x314"</span>, <span class="stringliteral">"w244h155"</span>, 1040, 672},
00689   { <span class="stringliteral">"314x314"</span>, <span class="stringliteral">"Custom"</span>, 1232, 1808},
00690 };
00691 
<a name="l00692"></a><a class="code" href="print-olympus_8c.html#a61">00692</a> <span class="keyword">static</span> <span class="keyword">const</span> <a class="code" href="structolymp__printsize__list__t.html">olymp_printsize_list_t</a> <a class="code" href="print-olympus_8c.html#a61">cpx00_printsize_list</a> =
00693 {
00694   <a class="code" href="print-olympus_8c.html#a60">cpx00_printsize</a>, <span class="keyword">sizeof</span>(<a class="code" href="print-olympus_8c.html#a60">cpx00_printsize</a>) / <span class="keyword">sizeof</span>(<a class="code" href="structolymp__printsize__t.html">olymp_printsize_t</a>)
00695 };
00696 
<a name="l00697"></a><a class="code" href="print-olympus_8c.html#a116">00697</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="print-olympus_8c.html#a116">cpx00_printer_init_func</a>(<a class="code" href="structstp__vars.html">stp_vars_t</a> *v)
00698 {
00699   <span class="keywordtype">char</span> pg = (strcmp(<a class="code" href="print-olympus_8c.html#a14">privdata</a>.<a class="code" href="structolympus__privdata__t.html#o9">pagesize</a>, <span class="stringliteral">"Postcard"</span>) == 0 ? <span class="charliteral">'\1'</span> :
00700                 (strcmp(<a class="code" href="print-olympus_8c.html#a14">privdata</a>.<a class="code" href="structolympus__privdata__t.html#o9">pagesize</a>, <span class="stringliteral">"w253h337"</span>) == 0 ? <span class="charliteral">'\2'</span> :
00701                 (strcmp(<a class="code" href="print-olympus_8c.html#a14">privdata</a>.<a class="code" href="structolympus__privdata__t.html#o9">pagesize</a>, <span class="stringliteral">"w244h155"</span>) == 0 ? <span class="charliteral">'\3'</span> :
00702                 (strcmp(<a class="code" href="print-olympus_8c.html#a14">privdata</a>.<a class="code" href="structolympus__privdata__t.html#o9">pagesize</a>, <span class="stringliteral">"w283h566"</span>) == 0 ? <span class="charliteral">'\4'</span> : 
00703                  <span class="charliteral">'\1'</span> ))));
00704 
00705   <a class="code" href="group__util.html#ga13">stp_put16_be</a>(0x4000, v);
00706   <a class="code" href="group__util.html#ga11">stp_putc</a>(<span class="charliteral">'\0'</span>, v);
00707   <a class="code" href="group__util.html#ga11">stp_putc</a>(pg, v);
00708   <a class="code" href="group__util.html#ga10">stp_zfwrite</a>(<a class="code" href="print-olympus_8c.html#a13">zero</a>, 1, 8, v);
00709 }
00710 
<a name="l00711"></a><a class="code" href="print-olympus_8c.html#a117">00711</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="print-olympus_8c.html#a117">cpx00_plane_init_func</a>(<a class="code" href="structstp__vars.html">stp_vars_t</a> *v)
00712 {
00713   <a class="code" href="group__util.html#ga13">stp_put16_be</a>(0x4001, v);
00714   <a class="code" href="group__util.html#ga12">stp_put16_le</a>(3 - <a class="code" href="print-olympus_8c.html#a14">privdata</a>.<a class="code" href="structolympus__privdata__t.html#o4">plane</a>, v);
00715   <a class="code" href="group__util.html#ga14">stp_put32_le</a>(<a class="code" href="print-olympus_8c.html#a14">privdata</a>.<a class="code" href="structolympus__privdata__t.html#o2">xsize</a> * <a class="code" href="print-olympus_8c.html#a14">privdata</a>.<a class="code" href="structolympus__privdata__t.html#o3">ysize</a>, v);
00716   <a class="code" href="group__util.html#ga10">stp_zfwrite</a>(<a class="code" href="print-olympus_8c.html#a13">zero</a>, 1, 4, v);
00717 }
00718 
<a name="l00719"></a><a class="code" href="print-olympus_8c.html#a62">00719</a> <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span> <a class="code" href="print-olympus_8c.html#a62">cpx00_adj_cyan</a>[] =
00720   <span class="stringliteral">"&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n"</span>
00721   <span class="stringliteral">"&lt;gimp-print&gt;\n"</span>
00722   <span class="stringliteral">"&lt;curve wrap=\"nowrap\" type=\"spline\" gamma=\"0\"&gt;\n"</span>
00723   <span class="stringliteral">"&lt;sequence count=\"32\" lower-bound=\"0\" upper-bound=\"1\"&gt;\n"</span>
00724   <span class="stringliteral">"0.000000 0.035294 0.070588 0.101961 0.117647 0.168627 0.180392 0.227451\n"</span>
00725   <span class="stringliteral">"0.258824 0.286275 0.317647 0.341176 0.376471 0.411765 0.427451 0.478431\n"</span>
00726   <span class="stringliteral">"0.505882 0.541176 0.576471 0.611765 0.654902 0.678431 0.705882 0.737255\n"</span>
00727   <span class="stringliteral">"0.764706 0.792157 0.811765 0.839216 0.862745 0.894118 0.909804 0.925490\n"</span>
00728   <span class="stringliteral">"&lt;/sequence&gt;\n"</span>
00729   <span class="stringliteral">"&lt;/curve&gt;\n"</span>
00730   <span class="stringliteral">"&lt;/gimp-print&gt;\n"</span>;
00731   
<a name="l00732"></a><a class="code" href="print-olympus_8c.html#a63">00732</a> <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span> <a class="code" href="print-olympus_8c.html#a63">cpx00_adj_magenta</a>[] =
00733   <span class="stringliteral">"&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n"</span>
00734   <span class="stringliteral">"&lt;gimp-print&gt;\n"</span>
00735   <span class="stringliteral">"&lt;curve wrap=\"nowrap\" type=\"spline\" gamma=\"0\"&gt;\n"</span>
00736   <span class="stringliteral">"&lt;sequence count=\"32\" lower-bound=\"0\" upper-bound=\"1\"&gt;\n"</span>
00737   <span class="stringliteral">"0.011765 0.019608 0.035294 0.047059 0.054902 0.101961 0.133333 0.156863\n"</span>
00738   <span class="stringliteral">"0.192157 0.235294 0.274510 0.321569 0.360784 0.403922 0.443137 0.482353\n"</span>
00739   <span class="stringliteral">"0.521569 0.549020 0.584314 0.619608 0.658824 0.705882 0.749020 0.792157\n"</span>
00740   <span class="stringliteral">"0.831373 0.890196 0.933333 0.964706 0.988235 0.992157 0.992157 0.996078\n"</span>
00741   <span class="stringliteral">"&lt;/sequence&gt;\n"</span>
00742   <span class="stringliteral">"&lt;/curve&gt;\n"</span>
00743   <span class="stringliteral">"&lt;/gimp-print&gt;\n"</span>;
00744   
<a name="l00745"></a><a class="code" href="print-olympus_8c.html#a64">00745</a> <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span> <a class="code" href="print-olympus_8c.html#a64">cpx00_adj_yellow</a>[] =
00746   <span class="stringliteral">"&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n"</span>
00747   <span class="stringliteral">"&lt;gimp-print&gt;\n"</span>
00748   <span class="stringliteral">"&lt;curve wrap=\"nowrap\" type=\"spline\" gamma=\"0\"&gt;\n"</span>
00749   <span class="stringliteral">"&lt;sequence count=\"32\" lower-bound=\"0\" upper-bound=\"1\"&gt;\n"</span>
00750   <span class="stringliteral">"0.003922 0.015686 0.015686 0.023529 0.027451 0.054902 0.094118 0.129412\n"</span>
00751   <span class="stringliteral">"0.180392 0.219608 0.250980 0.286275 0.317647 0.341176 0.388235 0.427451\n"</span>
00752   <span class="stringliteral">"0.470588 0.509804 0.552941 0.596078 0.627451 0.682353 0.768627 0.796078\n"</span>
00753   <span class="stringliteral">"0.890196 0.921569 0.949020 0.968627 0.984314 0.992157 0.992157 1.000000\n"</span>
00754   <span class="stringliteral">"&lt;/sequence&gt;\n"</span>
00755   <span class="stringliteral">"&lt;/curve&gt;\n"</span>
00756   <span class="stringliteral">"&lt;/gimp-print&gt;\n"</span>;
00757 
00758 
00759 <span class="comment">/* Canon CP-220 series */</span>
<a name="l00760"></a><a class="code" href="print-olympus_8c.html#a65">00760</a> <span class="keyword">static</span> <span class="keyword">const</span> <a class="code" href="structolymp__pagesize__t.html">olymp_pagesize_t</a> <a class="code" href="print-olympus_8c.html#a65">cp220_page</a>[] =
00761 {
00762   { <span class="stringliteral">"Postcard"</span>, <span class="stringliteral">"Postcard 148x100mm"</span>, -1, -1, 13, 13, 16, 18},
00763   { <span class="stringliteral">"w253h337"</span>, <span class="stringliteral">"CP_L 89x119mm"</span>, -1, -1, 13, 13, 15, 15},
00764   { <span class="stringliteral">"w244h155"</span>, <span class="stringliteral">"Card 54x86mm"</span>, -1, -1, 15, 15, 13, 13},
00765   { <span class="stringliteral">"w283h566"</span>, <span class="stringliteral">"Wide 200x100mm"</span>, -1, -1, 13, 13, 20, 20},
00766   { <span class="stringliteral">"Custom"</span>, NULL, -1, -1, 13, 13, 16, 18},
00767 };
00768 
<a name="l00769"></a><a class="code" href="print-olympus_8c.html#a66">00769</a> <span class="keyword">static</span> <span class="keyword">const</span> <a class="code" href="structolymp__pagesize__list__t.html">olymp_pagesize_list_t</a> <a class="code" href="print-olympus_8c.html#a66">cp220_page_list</a> =
00770 {
00771   <a class="code" href="print-olympus_8c.html#a65">cp220_page</a>, <span class="keyword">sizeof</span>(<a class="code" href="print-olympus_8c.html#a65">cp220_page</a>) / <span class="keyword">sizeof</span>(<a class="code" href="structolymp__pagesize__t.html">olymp_pagesize_t</a>)
00772 };
00773 
<a name="l00774"></a><a class="code" href="print-olympus_8c.html#a67">00774</a> <span class="keyword">static</span> <span class="keyword">const</span> <a class="code" href="structolymp__printsize__t.html">olymp_printsize_t</a> <a class="code" href="print-olympus_8c.html#a67">cp220_printsize</a>[] =
00775 {
00776   { <span class="stringliteral">"314x314"</span>, <span class="stringliteral">"Postcard"</span>, 1232, 1808},
00777   { <span class="stringliteral">"314x314"</span>, <span class="stringliteral">"w253h337"</span>, 1100, 1456},
00778   { <span class="stringliteral">"314x314"</span>, <span class="stringliteral">"w244h155"</span>, 1040, 672},
00779   { <span class="stringliteral">"314x314"</span>, <span class="stringliteral">"w283h566"</span>, 1232, 2416},
00780   { <span class="stringliteral">"314x314"</span>, <span class="stringliteral">"Custom"</span>, 1232, 1808},
00781 };
00782 
<a name="l00783"></a><a class="code" href="print-olympus_8c.html#a68">00783</a> <span class="keyword">static</span> <span class="keyword">const</span> <a class="code" href="structolymp__printsize__list__t.html">olymp_printsize_list_t</a> <a class="code" href="print-olympus_8c.html#a68">cp220_printsize_list</a> =
00784 {
00785   <a class="code" href="print-olympus_8c.html#a67">cp220_printsize</a>, <span class="keyword">sizeof</span>(<a class="code" href="print-olympus_8c.html#a67">cp220_printsize</a>) / <span class="keyword">sizeof</span>(<a class="code" href="structolymp__printsize__t.html">olymp_printsize_t</a>)
00786 };
00787 
00788 
00789 <span class="comment">/* Sony UP-DP10 */</span>
<a name="l00790"></a><a class="code" href="print-olympus_8c.html#a69">00790</a> <span class="keyword">static</span> <span class="keyword">const</span> <a class="code" href="structolymp__resolution__t.html">olymp_resolution_t</a> <a class="code" href="print-olympus_8c.html#a69">updp10_res</a>[] =
00791 {
00792   { <span class="stringliteral">"300x300"</span>, 300, 300},
00793 };
00794 
<a name="l00795"></a><a class="code" href="print-olympus_8c.html#a70">00795</a> <span class="keyword">static</span> <span class="keyword">const</span> <a class="code" href="structolymp__resolution__list__t.html">olymp_resolution_list_t</a> <a class="code" href="print-olympus_8c.html#a70">updp10_res_list</a> =
00796 {
00797   <a class="code" href="print-olympus_8c.html#a69">updp10_res</a>, <span class="keyword">sizeof</span>(<a class="code" href="print-olympus_8c.html#a69">updp10_res</a>) / <span class="keyword">sizeof</span>(<a class="code" href="structolymp__resolution__t.html">olymp_resolution_t</a>)
00798 };
00799 
<a name="l00800"></a><a class="code" href="print-olympus_8c.html#a71">00800</a> <span class="keyword">static</span> <span class="keyword">const</span> <a class="code" href="structolymp__pagesize__t.html">olymp_pagesize_t</a> <a class="code" href="print-olympus_8c.html#a71">updp10_page</a>[] =
00801 {
00802   { <span class="stringliteral">"w288h432"</span>, <span class="stringliteral">"UPC-10P23 (2:3)"</span>, -1, -1, 12, 12, 18, 18},
00803   { <span class="stringliteral">"w288h387"</span>, <span class="stringliteral">"UPC-10P34 (3:4)"</span>, -1, -1, 12, 12, 16, 16},
00804   { <span class="stringliteral">"w288h432"</span>, <span class="stringliteral">"UPC-10S01 (Sticker)"</span>, -1, -1, 12, 12, 18, 18},
00805   { <span class="stringliteral">"Custom"</span>, NULL, -1, -1, 12, 12, 0, 0},
00806 };
00807 
<a name="l00808"></a><a class="code" href="print-olympus_8c.html#a72">00808</a> <span class="keyword">static</span> <span class="keyword">const</span> <a class="code" href="structolymp__pagesize__list__t.html">olymp_pagesize_list_t</a> <a class="code" href="print-olympus_8c.html#a72">updp10_page_list</a> =
00809 {
00810   <a class="code" href="print-olympus_8c.html#a71">updp10_page</a>, <span class="keyword">sizeof</span>(<a class="code" href="print-olympus_8c.html#a71">updp10_page</a>) / <span class="keyword">sizeof</span>(<a class="code" href="structolymp__pagesize__t.html">olymp_pagesize_t</a>)
00811 };
00812 
<a name="l00813"></a><a class="code" href="print-olympus_8c.html#a73">00813</a> <span class="keyword">static</span> <span class="keyword">const</span> <a class="code" href="structolymp__printsize__t.html">olymp_printsize_t</a> <a class="code" href="print-olympus_8c.html#a73">updp10_printsize</a>[] =
00814 {
00815   { <span class="stringliteral">"300x300"</span>, <span class="stringliteral">"w288h432"</span>, 1200, 1800},
00816   { <span class="stringliteral">"300x300"</span>, <span class="stringliteral">"w288h387"</span>, 1200, 1600},
00817   { <span class="stringliteral">"300x300"</span>, <span class="stringliteral">"Custom"</span>, 1200, 1800},
00818 };
00819 
<a name="l00820"></a><a class="code" href="print-olympus_8c.html#a74">00820</a> <span class="keyword">static</span> <span class="keyword">const</span> <a class="code" href="structolymp__printsize__list__t.html">olymp_printsize_list_t</a> <a class="code" href="print-olympus_8c.html#a74">updp10_printsize_list</a> =
00821 {
00822   <a class="code" href="print-olympus_8c.html#a73">updp10_printsize</a>, <span class="keyword">sizeof</span>(<a class="code" href="print-olympus_8c.html#a73">updp10_printsize</a>) / <span class="keyword">sizeof</span>(<a class="code" href="structolymp__printsize__t.html">olymp_printsize_t</a>)
00823 };
00824 
<a name="l00825"></a><a class="code" href="print-olympus_8c.html#a118">00825</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="print-olympus_8c.html#a118">updp10_printer_init_func</a>(<a class="code" href="structstp__vars.html">stp_vars_t</a> *v)
00826 {
00827   <a class="code" href="group__util.html#ga10">stp_zfwrite</a>(<span class="stringliteral">"\x98\xff\xff\xff\xff\xff\xff\xff"</span>
00828               <span class="stringliteral">"\x14\x00\x00\x00\x1b\x15\x00\x00"</span>
00829               <span class="stringliteral">"\x00\x0d\x00\x00\x00\x00\x00\xc7"</span>
00830               <span class="stringliteral">"\x00\x00\x00\x00"</span>, 1, 28, v);
00831   <a class="code" href="group__util.html#ga13">stp_put16_be</a>(<a class="code" href="print-olympus_8c.html#a14">privdata</a>.<a class="code" href="structolympus__privdata__t.html#o2">xsize</a>, v);
00832   <a class="code" href="group__util.html#ga13">stp_put16_be</a>(<a class="code" href="print-olympus_8c.html#a14">privdata</a>.<a class="code" href="structolympus__privdata__t.html#o3">ysize</a>, v);
00833   <a class="code" href="group__util.html#ga14">stp_put32_le</a>(<a class="code" href="print-olympus_8c.html#a14">privdata</a>.<a class="code" href="structolympus__privdata__t.html#o2">xsize</a>*<a class="code" href="print-olympus_8c.html#a14">privdata</a>.<a class="code" href="structolympus__privdata__t.html#o3">ysize</a>*3+11, v);
00834   <a class="code" href="group__util.html#ga10">stp_zfwrite</a>(<span class="stringliteral">"\x1b\xea\x00\x00\x00\x00"</span>, 1, 6, v);
00835   <a class="code" href="group__util.html#ga15">stp_put32_be</a>(<a class="code" href="print-olympus_8c.html#a14">privdata</a>.<a class="code" href="structolympus__privdata__t.html#o2">xsize</a>*<a class="code" href="print-olympus_8c.html#a14">privdata</a>.<a class="code" href="structolympus__privdata__t.html#o3">ysize</a>*3, v);
00836   <a class="code" href="group__util.html#ga10">stp_zfwrite</a>(<span class="stringliteral">"\x00"</span>, 1, 1, v);
00837 }
00838 
<a name="l00839"></a><a class="code" href="print-olympus_8c.html#a119">00839</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="print-olympus_8c.html#a119">updp10_printer_end_func</a>(<a class="code" href="structstp__vars.html">stp_vars_t</a> *v)
00840 {
00841         <a class="code" href="group__util.html#ga10">stp_zfwrite</a>(<span class="stringliteral">"\x12\x00\x00\x00\x1b\xe1\x00\x00"</span>
00842                     <span class="stringliteral">"\x00\xb0\x00\x00\04"</span>, 1, 13, v);
00843         <a class="code" href="group__util.html#ga10">stp_zfwrite</a>((<a class="code" href="print-olympus_8c.html#a14">privdata</a>.<a class="code" href="structolympus__privdata__t.html#o10">laminate</a>-&gt;<a class="code" href="structlaminate__t.html#o2">seq</a>).data, 1,
00844                         (<a class="code" href="print-olympus_8c.html#a14">privdata</a>.<a class="code" href="structolympus__privdata__t.html#o10">laminate</a>-&gt;<a class="code" href="structlaminate__t.html#o2">seq</a>).bytes, v); <span class="comment">/*laminate pattern*/</span>
00845         <a class="code" href="group__util.html#ga10">stp_zfwrite</a>(<span class="stringliteral">"\x00\x00\x00\x00"</span> , 1, 4, v);
00846         <a class="code" href="group__util.html#ga13">stp_put16_be</a>(<a class="code" href="print-olympus_8c.html#a14">privdata</a>.<a class="code" href="structolympus__privdata__t.html#o3">ysize</a>, v);
00847         <a class="code" href="group__util.html#ga13">stp_put16_be</a>(<a class="code" href="print-olympus_8c.html#a14">privdata</a>.<a class="code" href="structolympus__privdata__t.html#o2">xsize</a>, v);
00848         <a class="code" href="group__util.html#ga10">stp_zfwrite</a>(<span class="stringliteral">"\xff\xff\xff\xff\x09\x00\x00\x00"</span>
00849                     <span class="stringliteral">"\x1b\xee\x00\x00\x00\x02\x00\x00"</span>
00850                     <span class="stringliteral">"\x01\x07\x00\x00\x00\x1b\x0a\x00"</span>
00851                     <span class="stringliteral">"\x00\x00\x00\x00\xfd\xff\xff\xff"</span>
00852                     <span class="stringliteral">"\xff\xff\xff\xff\xf8\xff\xff\xff"</span>
00853                     , 1, 40, v);
00854 }
00855 
<a name="l00856"></a><a class="code" href="print-olympus_8c.html#a75">00856</a> <span class="keyword">static</span> <span class="keyword">const</span> <a class="code" href="structlaminate__t.html">laminate_t</a> <a class="code" href="print-olympus_8c.html#a75">updp10_laminate</a>[] =
00857 {
00858   {<span class="stringliteral">"Glossy"</span>,  <a class="code" href="group__intl__internal.html#ga6">N_</a>(<span class="stringliteral">"Glossy"</span>),  {1, <span class="stringliteral">"\x00"</span>}},
00859   {<span class="stringliteral">"Texture"</span>, <a class="code" href="group__intl__internal.html#ga6">N_</a>(<span class="stringliteral">"Texture"</span>), {1, <span class="stringliteral">"\x08"</span>}},
00860   {<span class="stringliteral">"Matte"</span>,   <a class="code" href="group__intl__internal.html#ga6">N_</a>(<span class="stringliteral">"Matte"</span>),   {1, <span class="stringliteral">"\x0c"</span>}},
00861 };
00862 
<a name="l00863"></a><a class="code" href="print-olympus_8c.html#a76">00863</a> <span class="keyword">static</span> <span class="keyword">const</span> <a class="code" href="structlaminate__list__t.html">laminate_list_t</a> <a class="code" href="print-olympus_8c.html#a76">updp10_laminate_list</a> =
00864 {
00865   <a class="code" href="print-olympus_8c.html#a75">updp10_laminate</a>, <span class="keyword">sizeof</span>(<a class="code" href="print-olympus_8c.html#a75">updp10_laminate</a>) / <span class="keyword">sizeof</span>(<a class="code" href="structlaminate__t.html">laminate_t</a>)
00866 };
00867 
<a name="l00868"></a><a class="code" href="print-olympus_8c.html#a77">00868</a> <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span> <a class="code" href="print-olympus_8c.html#a77">updp10_adj_cyan</a>[] =
00869   <span class="stringliteral">"&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n"</span>
00870   <span class="stringliteral">"&lt;gimp-print&gt;\n"</span>
00871   <span class="stringliteral">"&lt;curve wrap=\"nowrap\" type=\"spline\" gamma=\"0\"&gt;\n"</span>
00872   <span class="stringliteral">"&lt;sequence count=\"33\" lower-bound=\"0\" upper-bound=\"1\"&gt;\n"</span>
00873   <span class="stringliteral">"0.113725 0.188235 0.247059 0.286275 0.317647 0.345098 0.368627 0.384314\n"</span>
00874   <span class="stringliteral">"0.400000 0.407843 0.423529 0.439216 0.450980 0.466667 0.482353 0.498039\n"</span>
00875   <span class="stringliteral">"0.509804 0.525490 0.545098 0.560784 0.580392 0.596078 0.619608 0.643137\n"</span>
00876   <span class="stringliteral">"0.662745 0.686275 0.709804 0.729412 0.756863 0.780392 0.811765 0.843137\n"</span>
00877   <span class="stringliteral">"1.000000\n"</span>
00878   <span class="stringliteral">"&lt;/sequence&gt;\n"</span>
00879   <span class="stringliteral">"&lt;/curve&gt;\n"</span>
00880   <span class="stringliteral">"&lt;/gimp-print&gt;\n"</span>;
00881   
<a name="l00882"></a><a class="code" href="print-olympus_8c.html#a78">00882</a> <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span> <a class="code" href="print-olympus_8c.html#a78">updp10_adj_magenta</a>[] =
00883   <span class="stringliteral">"&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n"</span>
00884   <span class="stringliteral">"&lt;gimp-print&gt;\n"</span>
00885   <span class="stringliteral">"&lt;curve wrap=\"nowrap\" type=\"spline\" gamma=\"0\"&gt;\n"</span>
00886   <span class="stringliteral">"&lt;sequence count=\"33\" lower-bound=\"0\" upper-bound=\"1\"&gt;\n"</span>
00887   <span class="stringliteral">"0.105882 0.211765 0.286275 0.333333 0.364706 0.388235 0.403922 0.415686\n"</span>
00888   <span class="stringliteral">"0.427451 0.439216 0.450980 0.462745 0.478431 0.494118 0.505882 0.521569\n"</span>
00889   <span class="stringliteral">"0.537255 0.552941 0.568627 0.584314 0.600000 0.619608 0.643137 0.662745\n"</span>
00890   <span class="stringliteral">"0.682353 0.709804 0.733333 0.760784 0.792157 0.823529 0.858824 0.890196\n"</span>
00891   <span class="stringliteral">"1.000000\n"</span>
00892   <span class="stringliteral">"&lt;/sequence&gt;\n"</span>
00893   <span class="stringliteral">"&lt;/curve&gt;\n"</span>
00894   <span class="stringliteral">"&lt;/gimp-print&gt;\n"</span>;
00895   
<a name="l00896"></a><a class="code" href="print-olympus_8c.html#a79">00896</a> <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span> <a class="code" href="print-olympus_8c.html#a79">updp10_adj_yellow</a>[] =
00897   <span class="stringliteral">"&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n"</span>
00898   <span class="stringliteral">"&lt;gimp-print&gt;\n"</span>
00899   <span class="stringliteral">"&lt;curve wrap=\"nowrap\" type=\"spline\" gamma=\"0\"&gt;\n"</span>
00900   <span class="stringliteral">"&lt;sequence count=\"33\" lower-bound=\"0\" upper-bound=\"1\"&gt;\n"</span>
00901   <span class="stringliteral">"0.101961 0.160784 0.196078 0.227451 0.243137 0.254902 0.266667 0.286275\n"</span>
00902   <span class="stringliteral">"0.309804 0.337255 0.368627 0.396078 0.423529 0.443137 0.462745 0.478431\n"</span>
00903   <span class="stringliteral">"0.501961 0.517647 0.537255 0.556863 0.576471 0.596078 0.619608 0.643137\n"</span>
00904   <span class="stringliteral">"0.666667 0.690196 0.709804 0.737255 0.760784 0.780392 0.796078 0.803922\n"</span>
00905   <span class="stringliteral">"1.000000\n"</span>
00906   <span class="stringliteral">"&lt;/sequence&gt;\n"</span>
00907   <span class="stringliteral">"&lt;/curve&gt;\n"</span>
00908   <span class="stringliteral">"&lt;/gimp-print&gt;\n"</span>;
00909 
00910 
00911 <span class="comment">/* Fujifilm CX-400 */</span>
<a name="l00912"></a><a class="code" href="print-olympus_8c.html#a80">00912</a> <span class="keyword">static</span> <span class="keyword">const</span> <a class="code" href="structolymp__resolution__t.html">olymp_resolution_t</a> <a class="code" href="print-olympus_8c.html#a80">cx400_res</a>[] =
00913 {
00914   { <span class="stringliteral">"317x316"</span>, 317, 316},
00915 };
00916 
<a name="l00917"></a><a class="code" href="print-olympus_8c.html#a81">00917</a> <span class="keyword">static</span> <span class="keyword">const</span> <a class="code" href="structolymp__resolution__list__t.html">olymp_resolution_list_t</a> <a class="code" href="print-olympus_8c.html#a81">cx400_res_list</a> =
00918 {
00919   <a class="code" href="print-olympus_8c.html#a80">cx400_res</a>, <span class="keyword">sizeof</span>(<a class="code" href="print-olympus_8c.html#a80">cx400_res</a>) / <span class="keyword">sizeof</span>(<a class="code" href="structolymp__resolution__t.html">olymp_resolution_t</a>)
00920 };
00921 
<a name="l00922"></a><a class="code" href="print-olympus_8c.html#a82">00922</a> <span class="keyword">static</span> <span class="keyword">const</span> <a class="code" href="structolymp__pagesize__t.html">olymp_pagesize_t</a> <a class="code" href="print-olympus_8c.html#a82">cx400_page</a>[] =
00923 {
00924   { <span class="stringliteral">"w288h432"</span>, NULL, -1, -1, 23, 23, 28, 28},
00925   { <span class="stringliteral">"w288h387"</span>, <span class="stringliteral">"4x5 3/8 (Digital Camera 3:4)"</span>, -1, -1, 23, 23, 27, 26},
00926   { <span class="stringliteral">"w288h504"</span>, NULL, -1, -1, 23, 23, 23, 22},
00927   { <span class="stringliteral">"Custom"</span>, NULL, -1, -1, 0, 0, 0, 0},
00928 };
00929 
<a name="l00930"></a><a class="code" href="print-olympus_8c.html#a83">00930</a> <span class="keyword">static</span> <span class="keyword">const</span> <a class="code" href="structolymp__pagesize__list__t.html">olymp_pagesize_list_t</a> <a class="code" href="print-olympus_8c.html#a83">cx400_page_list</a> =
00931 {
00932   <a class="code" href="print-olympus_8c.html#a82">cx400_page</a>, <span class="keyword">sizeof</span>(<a class="code" href="print-olympus_8c.html#a82">cx400_page</a>) / <span class="keyword">sizeof</span>(<a class="code" href="structolymp__pagesize__t.html">olymp_pagesize_t</a>)
00933 };
00934 
<a name="l00935"></a><a class="code" href="print-olympus_8c.html#a84">00935</a> <span class="keyword">static</span> <span class="keyword">const</span> <a class="code" href="structolymp__printsize__t.html">olymp_printsize_t</a> <a class="code" href="print-olympus_8c.html#a84">cx400_printsize</a>[] =
00936 {
00937   { <span class="stringliteral">"317x316"</span>, <span class="stringliteral">"w288h387"</span>, 1268, 1658},
00938   { <span class="stringliteral">"317x316"</span>, <span class="stringliteral">"w288h432"</span>, 1268, 1842},
00939   { <span class="stringliteral">"317x316"</span>, <span class="stringliteral">"w288h504"</span>, 1268, 2208},
00940   { <span class="stringliteral">"317x316"</span>, <span class="stringliteral">"Custom"</span>, 1268, 1842},
00941 };
00942 
<a name="l00943"></a><a class="code" href="print-olympus_8c.html#a85">00943</a> <span class="keyword">static</span> <span class="keyword">const</span> <a class="code" href="structolymp__printsize__list__t.html">olymp_printsize_list_t</a> <a class="code" href="print-olympus_8c.html#a85">cx400_printsize_list</a> =
00944 {
00945   <a class="code" href="print-olympus_8c.html#a84">cx400_printsize</a>, <span class="keyword">sizeof</span>(<a class="code" href="print-olympus_8c.html#a84">cx400_printsize</a>) / <span class="keyword">sizeof</span>(<a class="code" href="structolymp__printsize__t.html">olymp_printsize_t</a>)
00946 };
00947 
<a name="l00948"></a><a class="code" href="print-olympus_8c.html#a120">00948</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="print-olympus_8c.html#a120">cx400_printer_init_func</a>(<a class="code" href="structstp__vars.html">stp_vars_t</a> *v)
00949 {
00950   <span class="keywordtype">char</span> pg = <span class="charliteral">'\0'</span>;
00951   <span class="keyword">const</span> <span class="keywordtype">char</span> *pname = <span class="stringliteral">"XXXXXX"</span>;                                         
00952 
00953   <a class="code" href="print-util_8c.html#a24">stp_deprintf</a>(<a class="code" href="group__util.html#ga49">STP_DBG_OLYMPUS</a>,
00954         <span class="stringliteral">"olympus: fuji driver %s\n"</span>, <a class="code" href="group__vars.html#ga13">stp_get_driver</a>(v));
00955   <span class="keywordflow">if</span> (strcmp(<a class="code" href="group__vars.html#ga13">stp_get_driver</a>(v),<span class="stringliteral">"fujifilm-cx400"</span>) == 0)
00956     pname = <span class="stringliteral">"NX1000"</span>;
00957   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp(<a class="code" href="group__vars.html#ga13">stp_get_driver</a>(v),<span class="stringliteral">"fujifilm-cx550"</span>) == 0)
00958     pname = <span class="stringliteral">"QX200\0"</span>;
00959 
00960   <a class="code" href="group__util.html#ga10">stp_zfwrite</a>(<span class="stringliteral">"FUJIFILM"</span>, 1, 8, v);
00961   <a class="code" href="group__util.html#ga10">stp_zfwrite</a>(pname, 1, 6, v);
00962   <a class="code" href="group__util.html#ga11">stp_putc</a>(<span class="charliteral">'\0'</span>, v);
00963   <a class="code" href="group__util.html#ga12">stp_put16_le</a>(<a class="code" href="print-olympus_8c.html#a14">privdata</a>.<a class="code" href="structolympus__privdata__t.html#o2">xsize</a>, v);
00964   <a class="code" href="group__util.html#ga12">stp_put16_le</a>(<a class="code" href="print-olympus_8c.html#a14">privdata</a>.<a class="code" href="structolympus__privdata__t.html#o3">ysize</a>, v);
00965   <span class="keywordflow">if</span> (strcmp(<a class="code" href="print-olympus_8c.html#a14">privdata</a>.<a class="code" href="structolympus__privdata__t.html#o9">pagesize</a>,<span class="stringliteral">"w288h504"</span>) == 0)
00966     pg = '\x0d';
00967   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp(<a class="code" href="print-olympus_8c.html#a14">privdata</a>.<a class="code" href="structolympus__privdata__t.html#o9">pagesize</a>,<span class="stringliteral">"w288h432"</span>) == 0)
00968     pg = '\x0c';
00969   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp(<a class="code" href="print-olympus_8c.html#a14">privdata</a>.<a class="code" href="structolympus__privdata__t.html#o9">pagesize</a>,<span class="stringliteral">"w288h387"</span>) == 0)
00970     pg = '\x0b';
00971   <a class="code" href="group__util.html#ga11">stp_putc</a>(pg, v);
00972   <a class="code" href="group__util.html#ga10">stp_zfwrite</a>(<span class="stringliteral">"\x00\x00\x00\x00\x00\x01\x00\x01\x00\x00\x00\x00"</span>
00973                   <span class="stringliteral">"\x00\x00\x2d\x00\x00\x00\x00"</span>, 1, 19, v);
00974   <a class="code" href="group__util.html#ga10">stp_zfwrite</a>(<span class="stringliteral">"FUJIFILM"</span>, 1, 8, v);
00975   <a class="code" href="group__util.html#ga10">stp_zfwrite</a>(pname, 1, 6, v);
00976   <a class="code" href="group__util.html#ga11">stp_putc</a>(<span class="charliteral">'\1'</span>, v);
00977 }
00978   
<a name="l00979"></a><a class="code" href="print-olympus_8c.html#a86">00979</a> <span class="keyword">static</span> <span class="keyword">const</span> <a class="code" href="structolymp__resolution__t.html">olymp_resolution_t</a> <a class="code" href="print-olympus_8c.html#a86">all_resolutions</a>[] =
00980 {
00981   { <span class="stringliteral">"306x306"</span>, 306, 306},
00982   { <span class="stringliteral">"153x153"</span>, 153, 153},
00983   { <span class="stringliteral">"314x314"</span>, 314, 314},
00984   { <span class="stringliteral">"300x300"</span>, 300, 300},
00985   { <span class="stringliteral">"317x316"</span>, 317, 316},
00986   { <span class="stringliteral">"320x320"</span>, 320, 320},
00987 };
00988 
<a name="l00989"></a><a class="code" href="print-olympus_8c.html#a87">00989</a> <span class="keyword">static</span> <span class="keyword">const</span> <a class="code" href="structolymp__resolution__list__t.html">olymp_resolution_list_t</a> <a class="code" href="print-olympus_8c.html#a87">all_res_list</a> =
00990 {
00991   <a class="code" href="print-olympus_8c.html#a86">all_resolutions</a>, <span class="keyword">sizeof</span>(<a class="code" href="print-olympus_8c.html#a86">all_resolutions</a>) / <span class="keyword">sizeof</span>(<a class="code" href="structolymp__resolution__t.html">olymp_resolution_t</a>)
00992 };
00993 
<a name="l00994"></a><a class="code" href="print-olympus_8c.html#a88">00994</a> <span class="keyword">static</span> <span class="keyword">const</span> <a class="code" href="structolympus__cap__t.html">olympus_cap_t</a> <a class="code" href="print-olympus_8c.html#a88">olympus_model_capabilities</a>[] =
00995 {
00996   { <span class="comment">/* Olympus P-10 */</span>
00997     2,          
00998     &amp;<a class="code" href="print-olympus_8c.html#a20">rgb_ink_list</a>,
00999     &amp;<a class="code" href="print-olympus_8c.html#a24">res_320dpi_list</a>,
01000     &amp;<a class="code" href="print-olympus_8c.html#a26">p10_page_list</a>,
01001     &amp;<a class="code" href="print-olympus_8c.html#a28">p10_printsize_list</a>,
01002     <a class="code" href="print-olympus_8c.html#a2">OLYMPUS_INTERLACE_PLANE</a>,
01003     1848,
01004     <a class="code" href="print-olympus_8c.html#a4">OLYMPUS_FEATURE_FULL_WIDTH</a> | <a class="code" href="print-olympus_8c.html#a5">OLYMPUS_FEATURE_FULL_HEIGHT</a>,
01005     &amp;<a class="code" href="print-olympus_8c.html#a99">p10_printer_init_func</a>, &amp;<a class="code" href="print-olympus_8c.html#a100">p10_printer_end_func</a>,
01006     NULL, NULL, 
01007     &amp;<a class="code" href="print-olympus_8c.html#a101">p10_block_init_func</a>, NULL,
01008     NULL, NULL, NULL,   <span class="comment">/* color profile/adjustment is built into printer */</span>
01009     &amp;<a class="code" href="print-olympus_8c.html#a30">p10_laminate_list</a>,
01010   },
01011   { <span class="comment">/* Olympus P-200 */</span>
01012     4,          
01013     &amp;<a class="code" href="print-olympus_8c.html#a18">ymc_ink_list</a>,
01014     &amp;<a class="code" href="print-olympus_8c.html#a24">res_320dpi_list</a>,
01015     &amp;<a class="code" href="print-olympus_8c.html#a32">p200_page_list</a>,
01016     &amp;<a class="code" href="print-olympus_8c.html#a34">p200_printsize_list</a>,
01017     <a class="code" href="print-olympus_8c.html#a2">OLYMPUS_INTERLACE_PLANE</a>,
01018     1280,
01019     <a class="code" href="print-olympus_8c.html#a4">OLYMPUS_FEATURE_FULL_WIDTH</a> | <a class="code" href="print-olympus_8c.html#a6">OLYMPUS_FEATURE_BLOCK_ALIGN</a>,
01020     &amp;<a class="code" href="print-olympus_8c.html#a102">p200_printer_init_func</a>, &amp;<a class="code" href="print-olympus_8c.html#a104">p200_printer_end_func</a>,
01021     &amp;<a class="code" href="print-olympus_8c.html#a103">p200_plane_init_func</a>, NULL,
01022     NULL, NULL,
01023     <a class="code" href="print-olympus_8c.html#a35">p200_adj_any</a>, <a class="code" href="print-olympus_8c.html#a35">p200_adj_any</a>, <a class="code" href="print-olympus_8c.html#a35">p200_adj_any</a>,
01024     NULL,
01025   },
01026   { <span class="comment">/* Olympus P-300 */</span>
01027     0,          
01028     &amp;<a class="code" href="print-olympus_8c.html#a18">ymc_ink_list</a>,
01029     &amp;<a class="code" href="print-olympus_8c.html#a37">p300_res_list</a>,
01030     &amp;<a class="code" href="print-olympus_8c.html#a39">p300_page_list</a>,
01031     &amp;<a class="code" href="print-olympus_8c.html#a41">p300_printsize_list</a>,
01032     <a class="code" href="print-olympus_8c.html#a2">OLYMPUS_INTERLACE_PLANE</a>,
01033     16,
01034     <a class="code" href="print-olympus_8c.html#a4">OLYMPUS_FEATURE_FULL_WIDTH</a> | <a class="code" href="print-olympus_8c.html#a6">OLYMPUS_FEATURE_BLOCK_ALIGN</a>,
01035     &amp;<a class="code" href="print-olympus_8c.html#a105">p300_printer_init_func</a>, NULL,
01036     NULL, &amp;<a class="code" href="print-olympus_8c.html#a106">p300_plane_end_func</a>,
01037     &amp;<a class="code" href="print-olympus_8c.html#a107">p300_block_init_func</a>, NULL,
01038     <a class="code" href="print-olympus_8c.html#a42">p300_adj_cyan</a>, <a class="code" href="print-olympus_8c.html#a43">p300_adj_magenta</a>, <a class="code" href="print-olympus_8c.html#a44">p300_adj_yellow</a>,
01039     NULL,
01040   },
01041   { <span class="comment">/* Olympus P-400 */</span>
01042     1,
01043     &amp;<a class="code" href="print-olympus_8c.html#a18">ymc_ink_list</a>,
01044     &amp;<a class="code" href="print-olympus_8c.html#a46">res_314dpi_list</a>,
01045     &amp;<a class="code" href="print-olympus_8c.html#a48">p400_page_list</a>,
01046     &amp;<a class="code" href="print-olympus_8c.html#a50">p400_printsize_list</a>,
01047     <a class="code" href="print-olympus_8c.html#a2">OLYMPUS_INTERLACE_PLANE</a>,
01048     180,
01049     <a class="code" href="print-olympus_8c.html#a4">OLYMPUS_FEATURE_FULL_WIDTH</a> | <a class="code" href="print-olympus_8c.html#a5">OLYMPUS_FEATURE_FULL_HEIGHT</a>,
01050     &amp;<a class="code" href="print-olympus_8c.html#a108">p400_printer_init_func</a>, NULL,
01051     &amp;<a class="code" href="print-olympus_8c.html#a109">p400_plane_init_func</a>, &amp;<a class="code" href="print-olympus_8c.html#a110">p400_plane_end_func</a>,
01052     &amp;<a class="code" href="print-olympus_8c.html#a111">p400_block_init_func</a>, NULL,
01053     <a class="code" href="print-olympus_8c.html#a51">p400_adj_cyan</a>, <a class="code" href="print-olympus_8c.html#a52">p400_adj_magenta</a>, <a class="code" href="print-olympus_8c.html#a53">p400_adj_yellow</a>,
01054     NULL,
01055   },
01056   { <span class="comment">/* Olympus P-440 */</span>
01057     3,
01058     &amp;<a class="code" href="print-olympus_8c.html#a22">bgr_ink_list</a>,
01059     &amp;<a class="code" href="print-olympus_8c.html#a46">res_314dpi_list</a>,
01060     &amp;<a class="code" href="print-olympus_8c.html#a55">p440_page_list</a>,
01061     &amp;<a class="code" href="print-olympus_8c.html#a57">p440_printsize_list</a>,
01062     <a class="code" href="print-olympus_8c.html#a0">OLYMPUS_INTERLACE_NONE</a>,
01063     128,
01064     <a class="code" href="print-olympus_8c.html#a4">OLYMPUS_FEATURE_FULL_WIDTH</a> | <a class="code" href="print-olympus_8c.html#a5">OLYMPUS_FEATURE_FULL_HEIGHT</a>,
01065     &amp;<a class="code" href="print-olympus_8c.html#a112">p440_printer_init_func</a>, &amp;<a class="code" href="print-olympus_8c.html#a113">p440_printer_end_func</a>,
01066     NULL, NULL,
01067     &amp;<a class="code" href="print-olympus_8c.html#a114">p440_block_init_func</a>, &amp;<a class="code" href="print-olympus_8c.html#a115">p440_block_end_func</a>,
01068     NULL, NULL, NULL,   <span class="comment">/* color profile/adjustment is built into printer */</span>
01069     &amp;<a class="code" href="print-olympus_8c.html#a30">p10_laminate_list</a>,
01070   },
01071   { <span class="comment">/* Canon CP-100, CP-200, CP-300 */</span>
01072     1000,
01073     &amp;<a class="code" href="print-olympus_8c.html#a18">ymc_ink_list</a>,
01074     &amp;<a class="code" href="print-olympus_8c.html#a46">res_314dpi_list</a>,
01075     &amp;<a class="code" href="print-olympus_8c.html#a59">cpx00_page_list</a>,
01076     &amp;<a class="code" href="print-olympus_8c.html#a61">cpx00_printsize_list</a>,
01077     <a class="code" href="print-olympus_8c.html#a2">OLYMPUS_INTERLACE_PLANE</a>,
01078     1808,
01079     <a class="code" href="print-olympus_8c.html#a4">OLYMPUS_FEATURE_FULL_WIDTH</a> | <a class="code" href="print-olympus_8c.html#a5">OLYMPUS_FEATURE_FULL_HEIGHT</a>
01080       | <a class="code" href="print-olympus_8c.html#a7">OLYMPUS_FEATURE_BORDERLESS</a> | <a class="code" href="print-olympus_8c.html#a8">OLYMPUS_FEATURE_WHITE_BORDER</a>,
01081     &amp;<a class="code" href="print-olympus_8c.html#a116">cpx00_printer_init_func</a>, NULL,
01082     &amp;<a class="code" href="print-olympus_8c.html#a117">cpx00_plane_init_func</a>, NULL,
01083     NULL, NULL,
01084     <a class="code" href="print-olympus_8c.html#a62">cpx00_adj_cyan</a>, <a class="code" href="print-olympus_8c.html#a63">cpx00_adj_magenta</a>, <a class="code" href="print-olympus_8c.html#a64">cpx00_adj_yellow</a>,
01085     NULL,
01086   },
01087   { <span class="comment">/* Canon CP-220, CP-330 */</span>
01088     1001,
01089     &amp;<a class="code" href="print-olympus_8c.html#a18">ymc_ink_list</a>,
01090     &amp;<a class="code" href="print-olympus_8c.html#a46">res_314dpi_list</a>,
01091     &amp;<a class="code" href="print-olympus_8c.html#a66">cp220_page_list</a>,
01092     &amp;<a class="code" href="print-olympus_8c.html#a68">cp220_printsize_list</a>,
01093     <a class="code" href="print-olympus_8c.html#a2">OLYMPUS_INTERLACE_PLANE</a>,
01094     1808,
01095     <a class="code" href="print-olympus_8c.html#a4">OLYMPUS_FEATURE_FULL_WIDTH</a> | <a class="code" href="print-olympus_8c.html#a5">OLYMPUS_FEATURE_FULL_HEIGHT</a>
01096       | <a class="code" href="print-olympus_8c.html#a7">OLYMPUS_FEATURE_BORDERLESS</a> | <a class="code" href="print-olympus_8c.html#a8">OLYMPUS_FEATURE_WHITE_BORDER</a>,
01097     &amp;<a class="code" href="print-olympus_8c.html#a116">cpx00_printer_init_func</a>, NULL,
01098     &amp;<a class="code" href="print-olympus_8c.html#a117">cpx00_plane_init_func</a>, NULL,
01099     NULL, NULL,
01100     <a class="code" href="print-olympus_8c.html#a62">cpx00_adj_cyan</a>, <a class="code" href="print-olympus_8c.html#a63">cpx00_adj_magenta</a>, <a class="code" href="print-olympus_8c.html#a64">cpx00_adj_yellow</a>,
01101     NULL,
01102   },
01103   { <span class="comment">/* Sony UP-DP10  */</span>
01104     2000,
01105     &amp;<a class="code" href="print-olympus_8c.html#a16">cmy_ink_list</a>,
01106     &amp;<a class="code" href="print-olympus_8c.html#a70">updp10_res_list</a>,
01107     &amp;<a class="code" href="print-olympus_8c.html#a72">updp10_page_list</a>,
01108     &amp;<a class="code" href="print-olympus_8c.html#a74">updp10_printsize_list</a>,
01109     <a class="code" href="print-olympus_8c.html#a0">OLYMPUS_INTERLACE_NONE</a>,
01110     1800,
01111     <a class="code" href="print-olympus_8c.html#a4">OLYMPUS_FEATURE_FULL_WIDTH</a> | <a class="code" href="print-olympus_8c.html#a5">OLYMPUS_FEATURE_FULL_HEIGHT</a>
01112       | <a class="code" href="print-olympus_8c.html#a7">OLYMPUS_FEATURE_BORDERLESS</a>,
01113     &amp;<a class="code" href="print-olympus_8c.html#a118">updp10_printer_init_func</a>, &amp;<a class="code" href="print-olympus_8c.html#a119">updp10_printer_end_func</a>,
01114     NULL, NULL,
01115     NULL, NULL,
01116     <a class="code" href="print-olympus_8c.html#a77">updp10_adj_cyan</a>, <a class="code" href="print-olympus_8c.html#a78">updp10_adj_magenta</a>, <a class="code" href="print-olympus_8c.html#a79">updp10_adj_yellow</a>,
01117     &amp;<a class="code" href="print-olympus_8c.html#a76">updp10_laminate_list</a>,
01118   },
01119   { <span class="comment">/* Fujifilm Printpix CX-400  */</span>
01120     3000,
01121     &amp;<a class="code" href="print-olympus_8c.html#a20">rgb_ink_list</a>,
01122     &amp;<a class="code" href="print-olympus_8c.html#a81">cx400_res_list</a>,
01123     &amp;<a class="code" href="print-olympus_8c.html#a83">cx400_page_list</a>,
01124     &amp;<a class="code" href="print-olympus_8c.html#a85">cx400_printsize_list</a>,
01125     <a class="code" href="print-olympus_8c.html#a0">OLYMPUS_INTERLACE_NONE</a>,
01126     2208,
01127     <a class="code" href="print-olympus_8c.html#a4">OLYMPUS_FEATURE_FULL_WIDTH</a> | <a class="code" href="print-olympus_8c.html#a5">OLYMPUS_FEATURE_FULL_HEIGHT</a>
01128       | <a class="code" href="print-olympus_8c.html#a7">OLYMPUS_FEATURE_BORDERLESS</a>,
01129     &amp;<a class="code" href="print-olympus_8c.html#a120">cx400_printer_init_func</a>, NULL,
01130     NULL, NULL,
01131     NULL, NULL,
01132     NULL, NULL, NULL,   <span class="comment">/* color profile/adjustment is built into printer */</span>
01133     NULL,
01134   },
01135   { <span class="comment">/* Fujifilm Printpix CX-550  */</span>
01136     3001,
01137     &amp;<a class="code" href="print-olympus_8c.html#a20">rgb_ink_list</a>,
01138     &amp;<a class="code" href="print-olympus_8c.html#a81">cx400_res_list</a>,
01139     &amp;<a class="code" href="print-olympus_8c.html#a83">cx400_page_list</a>,
01140     &amp;<a class="code" href="print-olympus_8c.html#a85">cx400_printsize_list</a>,
01141     <a class="code" href="print-olympus_8c.html#a0">OLYMPUS_INTERLACE_NONE</a>,
01142     2208,
01143     <a class="code" href="print-olympus_8c.html#a4">OLYMPUS_FEATURE_FULL_WIDTH</a> | <a class="code" href="print-olympus_8c.html#a5">OLYMPUS_FEATURE_FULL_HEIGHT</a>
01144       | <a class="code" href="print-olympus_8c.html#a7">OLYMPUS_FEATURE_BORDERLESS</a>,
01145     &amp;<a class="code" href="print-olympus_8c.html#a120">cx400_printer_init_func</a>, NULL,
01146     NULL, NULL,
01147     NULL, NULL,
01148     NULL, NULL, NULL,   <span class="comment">/* color profile/adjustment is built into printer */</span>
01149     NULL,
01150   },
01151 };
01152 
<a name="l01153"></a><a class="code" href="print-olympus_8c.html#a89">01153</a> <span class="keyword">static</span> <span class="keyword">const</span> <a class="code" href="structstp__parameter__t.html">stp_parameter_t</a> <a class="code" href="print-olympus_8c.html#a89">the_parameters</a>[] =
01154 {
01155   {
01156     <span class="stringliteral">"PageSize"</span>, <a class="code" href="group__intl__internal.html#ga6">N_</a>(<span class="stringliteral">"Page Size"</span>), <a class="code" href="group__intl__internal.html#ga6">N_</a>(<span class="stringliteral">"Basic Printer Setup"</span>),
01157     <a class="code" href="group__intl__internal.html#ga6">N_</a>(<span class="stringliteral">"Size of the paper being printed to"</span>),
01158     <a class="code" href="group__vars.html#gga132a7">STP_PARAMETER_TYPE_STRING_LIST</a>, <a class="code" href="group__vars.html#gga133a19">STP_PARAMETER_CLASS_CORE</a>,
01159     <a class="code" href="group__vars.html#gga134a21">STP_PARAMETER_LEVEL_BASIC</a>, 1, 1, -1, 1, 0
01160   },
01161   {
01162     <span class="stringliteral">"MediaType"</span>, <a class="code" href="group__intl__internal.html#ga6">N_</a>(<span class="stringliteral">"Media Type"</span>), <a class="code" href="group__intl__internal.html#ga6">N_</a>(<span class="stringliteral">"Basic Printer Setup"</span>),
01163     <a class="code" href="group__intl__internal.html#ga6">N_</a>(<span class="stringliteral">"Type of media (plain paper, photo paper, etc.)"</span>),
01164     <a class="code" href="group__vars.html#gga132a7">STP_PARAMETER_TYPE_STRING_LIST</a>, <a class="code" href="group__vars.html#gga133a17">STP_PARAMETER_CLASS_FEATURE</a>,
01165     <a class="code" href="group__vars.html#gga134a21">STP_PARAMETER_LEVEL_BASIC</a>, 1, 1, -1, 1, 0
01166   },
01167   {
01168     <span class="stringliteral">"InputSlot"</span>, <a class="code" href="group__intl__internal.html#ga6">N_</a>(<span class="stringliteral">"Media Source"</span>), <a class="code" href="group__intl__internal.html#ga6">N_</a>(<span class="stringliteral">"Basic Printer Setup"</span>),
01169     <a class="code" href="group__intl__internal.html#ga6">N_</a>(<span class="stringliteral">"Source (input slot) of the media"</span>),
01170     <a class="code" href="group__vars.html#gga132a7">STP_PARAMETER_TYPE_STRING_LIST</a>, <a class="code" href="group__vars.html#gga133a17">STP_PARAMETER_CLASS_FEATURE</a>,
01171     <a class="code" href="group__vars.html#gga134a21">STP_PARAMETER_LEVEL_BASIC</a>, 1, 1, -1, 1, 0
01172   },
01173   {
01174     <span class="stringliteral">"Resolution"</span>, <a class="code" href="group__intl__internal.html#ga6">N_</a>(<span class="stringliteral">"Resolution"</span>), <a class="code" href="group__intl__internal.html#ga6">N_</a>(<span class="stringliteral">"Basic Printer Setup"</span>),
01175     <a class="code" href="group__intl__internal.html#ga6">N_</a>(<span class="stringliteral">"Resolution and quality of the print"</span>),
01176     <a class="code" href="group__vars.html#gga132a7">STP_PARAMETER_TYPE_STRING_LIST</a>, <a class="code" href="group__vars.html#gga133a17">STP_PARAMETER_CLASS_FEATURE</a>,
01177     <a class="code" href="group__vars.html#gga134a21">STP_PARAMETER_LEVEL_BASIC</a>, 1, 1, -1, 1, 0
01178   },
01179   {
01180     <span class="stringliteral">"InkType"</span>, <a class="code" href="group__intl__internal.html#ga6">N_</a>(<span class="stringliteral">"Ink Type"</span>), <a class="code" href="group__intl__internal.html#ga6">N_</a>(<span class="stringliteral">"Advanced Printer Setup"</span>),
01181     <a class="code" href="group__intl__internal.html#ga6">N_</a>(<span class="stringliteral">"Type of ink in the printer"</span>),
01182     <a class="code" href="group__vars.html#gga132a7">STP_PARAMETER_TYPE_STRING_LIST</a>, <a class="code" href="group__vars.html#gga133a17">STP_PARAMETER_CLASS_FEATURE</a>,
01183     <a class="code" href="group__vars.html#gga134a21">STP_PARAMETER_LEVEL_BASIC</a>, 1, 1, -1, 1, 0
01184   },
01185   {
01186     <span class="stringliteral">"Laminate"</span>, <a class="code" href="group__intl__internal.html#ga6">N_</a>(<span class="stringliteral">"Laminate Pattern"</span>), <a class="code" href="group__intl__internal.html#ga6">N_</a>(<span class="stringliteral">"Advanced Printer Setup"</span>),
01187     <a class="code" href="group__intl__internal.html#ga6">N_</a>(<span class="stringliteral">"Laminate Pattern"</span>),
01188     <a class="code" href="group__vars.html#gga132a7">STP_PARAMETER_TYPE_STRING_LIST</a>, <a class="code" href="group__vars.html#gga133a17">STP_PARAMETER_CLASS_FEATURE</a>,
01189     <a class="code" href="group__vars.html#gga134a21">STP_PARAMETER_LEVEL_BASIC</a>, 1, 0, -1, 1, 0
01190   },
01191   {
01192     <span class="stringliteral">"Borderless"</span>, <a class="code" href="group__intl__internal.html#ga6">N_</a>(<span class="stringliteral">"Borderless"</span>), <a class="code" href="group__intl__internal.html#ga6">N_</a>(<span class="stringliteral">"Advanced Printer Setup"</span>),
01193     <a class="code" href="group__intl__internal.html#ga6">N_</a>(<span class="stringliteral">"Print without borders"</span>),
01194     <a class="code" href="group__vars.html#gga132a9">STP_PARAMETER_TYPE_BOOLEAN</a>, <a class="code" href="group__vars.html#gga133a17">STP_PARAMETER_CLASS_FEATURE</a>,
01195     <a class="code" href="group__vars.html#gga134a21">STP_PARAMETER_LEVEL_BASIC</a>, 1, 0, -1, 1, 0
01196   },
01197   {
01198     <span class="stringliteral">"PrintingMode"</span>, <a class="code" href="group__intl__internal.html#ga6">N_</a>(<span class="stringliteral">"Printing Mode"</span>), <a class="code" href="group__intl__internal.html#ga6">N_</a>(<span class="stringliteral">"Core Parameter"</span>),
01199     <a class="code" href="group__intl__internal.html#ga6">N_</a>(<span class="stringliteral">"Printing Output Mode"</span>),
01200     <a class="code" href="group__vars.html#gga132a7">STP_PARAMETER_TYPE_STRING_LIST</a>, <a class="code" href="group__vars.html#gga133a19">STP_PARAMETER_CLASS_CORE</a>,
01201     <a class="code" href="group__vars.html#gga134a21">STP_PARAMETER_LEVEL_BASIC</a>, 1, 1, -1, 1, 0
01202   },
01203 };
01204 
<a name="l01205"></a><a class="code" href="print-olympus_8c.html#a90">01205</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="print-olympus_8c.html#a90">the_parameter_count</a> =
01206 <span class="keyword">sizeof</span>(<a class="code" href="print-olympus_8c.html#a89">the_parameters</a>) / <span class="keyword">sizeof</span>(<span class="keyword">const</span> <a class="code" href="structstp__parameter__t.html">stp_parameter_t</a>);
01207 
01208 <span class="keyword">typedef</span> <span class="keyword">struct</span>
01209 <span class="keyword"></span>{
01210   <span class="keyword">const</span> <a class="code" href="structstp__parameter__t.html">stp_parameter_t</a> param;
01211   <span class="keywordtype">double</span> min;
01212   <span class="keywordtype">double</span> <a class="code" href="print-lexmark_8c.html#a6">max</a>;
01213   <span class="keywordtype">double</span> defval;
01214   <span class="keywordtype">int</span> color_only;
01215 } <a class="code" href="structfloat__param__t.html">float_param_t</a>;
01216 
<a name="l01217"></a><a class="code" href="print-olympus_8c.html#a91">01217</a> <span class="keyword">static</span> <span class="keyword">const</span> <a class="code" href="structfloat__param__t.html">float_param_t</a> <a class="code" href="print-olympus_8c.html#a91">float_parameters</a>[] =
01218 {
01219   {
01220     {
01221       <span class="stringliteral">"CyanDensity"</span>, <a class="code" href="group__intl__internal.html#ga6">N_</a>(<span class="stringliteral">"Cyan Balance"</span>), <a class="code" href="group__intl__internal.html#ga6">N_</a>(<span class="stringliteral">"Output Level Adjustment"</span>),
01222       <a class="code" href="group__intl__internal.html#ga6">N_</a>(<span class="stringliteral">"Adjust the cyan balance"</span>),
01223       <a class="code" href="group__vars.html#gga132a10">STP_PARAMETER_TYPE_DOUBLE</a>, <a class="code" href="group__vars.html#gga133a18">STP_PARAMETER_CLASS_OUTPUT</a>,
01224       <a class="code" href="group__vars.html#gga134a22">STP_PARAMETER_LEVEL_ADVANCED</a>, 0, 1, 1, 1, 0
01225     }, 0.0, 2.0, 1.0, 1
01226   },
01227   {
01228     {
01229       <span class="stringliteral">"MagentaDensity"</span>, <a class="code" href="group__intl__internal.html#ga6">N_</a>(<span class="stringliteral">"Magenta Balance"</span>), <a class="code" href="group__intl__internal.html#ga6">N_</a>(<span class="stringliteral">"Output Level Adjustment"</span>),
01230       <a class="code" href="group__intl__internal.html#ga6">N_</a>(<span class="stringliteral">"Adjust the magenta balance"</span>),
01231       <a class="code" href="group__vars.html#gga132a10">STP_PARAMETER_TYPE_DOUBLE</a>, <a class="code" href="group__vars.html#gga133a18">STP_PARAMETER_CLASS_OUTPUT</a>,
01232       <a class="code" href="group__vars.html#gga134a22">STP_PARAMETER_LEVEL_ADVANCED</a>, 0, 1, 2, 1, 0
01233     }, 0.0, 2.0, 1.0, 1
01234   },
01235   {
01236     {
01237       <span class="stringliteral">"YellowDensity"</span>, <a class="code" href="group__intl__internal.html#ga6">N_</a>(<span class="stringliteral">"Yellow Balance"</span>), <a class="code" href="group__intl__internal.html#ga6">N_</a>(<span class="stringliteral">"Output Level Adjustment"</span>),
01238       <a class="code" href="group__intl__internal.html#ga6">N_</a>(<span class="stringliteral">"Adjust the yellow balance"</span>),
01239       <a class="code" href="group__vars.html#gga132a10">STP_PARAMETER_TYPE_DOUBLE</a>, <a class="code" href="group__vars.html#gga133a18">STP_PARAMETER_CLASS_OUTPUT</a>,
01240       <a class="code" href="group__vars.html#gga134a22">STP_PARAMETER_LEVEL_ADVANCED</a>, 0, 1, 3, 1, 0
01241     }, 0.0, 2.0, 1.0, 1
01242   },
01243   {
01244     {
01245       <span class="stringliteral">"BlackDensity"</span>, <a class="code" href="group__intl__internal.html#ga6">N_</a>(<span class="stringliteral">"Black Balance"</span>), <a class="code" href="group__intl__internal.html#ga6">N_</a>(<span class="stringliteral">"Output Level Adjustment"</span>),
01246       <a class="code" href="group__intl__internal.html#ga6">N_</a>(<span class="stringliteral">"Adjust the black balance"</span>),
01247       <a class="code" href="group__vars.html#gga132a10">STP_PARAMETER_TYPE_DOUBLE</a>, <a class="code" href="group__vars.html#gga133a18">STP_PARAMETER_CLASS_OUTPUT</a>,
01248       <a class="code" href="group__vars.html#gga134a22">STP_PARAMETER_LEVEL_ADVANCED</a>, 0, 1, 0, 1, 0
01249     }, 0.0, 2.0, 1.0, 1
01250   },
01251 };    
01252 
<a name="l01253"></a><a class="code" href="print-olympus_8c.html#a92">01253</a> <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="print-olympus_8c.html#a92">float_parameter_count</a> =
01254 <span class="keyword">sizeof</span>(<a class="code" href="print-olympus_8c.html#a91">float_parameters</a>) / <span class="keyword">sizeof</span>(<span class="keyword">const</span> <a class="code" href="structfloat__param__t.html">float_param_t</a>);
01255 
<a name="l01256"></a><a class="code" href="print-olympus_8c.html#a97">01256</a> <span class="keyword">static</span> <span class="keyword">const</span> <a class="code" href="structolympus__cap__t.html">olympus_cap_t</a>* <a class="code" href="print-olympus_8c.html#a97">olympus_get_model_capabilities</a>(<span class="keywordtype">int</span> model)
01257 {
01258   <span class="keywordtype">int</span> i;
01259   <span class="keywordtype">int</span> models = <span class="keyword">sizeof</span>(<a class="code" href="print-olympus_8c.html#a88">olympus_model_capabilities</a>) / <span class="keyword">sizeof</span>(<a class="code" href="structolympus__cap__t.html">olympus_cap_t</a>);
01260 
01261   <span class="keywordflow">for</span> (i=0; i&lt;models; i++)
01262     {
01263       <span class="keywordflow">if</span> (<a class="code" href="print-olympus_8c.html#a88">olympus_model_capabilities</a>[i].<a class="code" href="structolympus__cap__t.html#o0">model</a> == model)
01264         <span class="keywordflow">return</span> &amp;(<a class="code" href="print-olympus_8c.html#a88">olympus_model_capabilities</a>[i]);
01265     }
01266   <a class="code" href="print-util_8c.html#a24">stp_deprintf</a>(<a class="code" href="group__util.html#ga49">STP_DBG_OLYMPUS</a>,
01267         <span class="stringliteral">"olympus: model %d not found in capabilities list.\n"</span>, model);
01268   <span class="keywordflow">return</span> &amp;(<a class="code" href="print-olympus_8c.html#a88">olympus_model_capabilities</a>[0]);
01269 }
01270 
<a name="l01271"></a><a class="code" href="print-olympus_8c.html#a98">01271</a> <span class="keyword">static</span> <span class="keyword">const</span> <a class="code" href="structlaminate__t.html">laminate_t</a>* <a class="code" href="print-olympus_8c.html#a98">olympus_get_laminate_pattern</a>(<a class="code" href="structstp__vars.html">stp_vars_t</a> *v)
01272 {
01273   <span class="keyword">const</span> <span class="keywordtype">char</span> *lpar = <a class="code" href="group__vars.html#ga36">stp_get_string_parameter</a>(v, <span class="stringliteral">"Laminate"</span>);
01274   <span class="keyword">const</span> <a class="code" href="structolympus__cap__t.html">olympus_cap_t</a> *caps = <a class="code" href="print-olympus_8c.html#a97">olympus_get_model_capabilities</a>(
01275                                                 <a class="code" href="group__printer.html#ga23">stp_get_model_id</a>(v));
01276   <span class="keyword">const</span> <a class="code" href="structlaminate__list__t.html">laminate_list_t</a> *llist = caps-&gt;<a class="code" href="structolympus__cap__t.html#o17">laminate</a>;
01277   <span class="keyword">const</span> <a class="code" href="structlaminate__t.html">laminate_t</a> *l = NULL;
01278   <span class="keywordtype">int</span> i;
01279 
01280   <span class="keywordflow">for</span> (i = 0; i &lt; llist-&gt;<a class="code" href="structlaminate__list__t.html#o1">n_items</a>; i++)
01281     {
01282       l = &amp;(llist-&gt;<a class="code" href="structlaminate__list__t.html#o0">item</a>[i]);
01283       <span class="keywordflow">if</span> (strcmp(l-&gt;<a class="code" href="structlaminate__t.html#o0">name</a>, lpar) == 0)
01284          <span class="keywordflow">break</span>;
01285     }
01286   <span class="keywordflow">return</span> l;
01287 }
01288   
01289 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l01290"></a><a class="code" href="print-olympus_8c.html#a121">01290</a> <a class="code" href="print-olympus_8c.html#a121">olympus_printsize</a>(<span class="keyword">const</span> <a class="code" href="structstp__vars.html">stp_vars_t</a> *v,
01291                    <span class="keywordtype">int</span>  *width,
01292                    <span class="keywordtype">int</span>  *height)
01293 {
01294   <span class="keywordtype">int</span> i;
01295   <span class="keyword">const</span> <span class="keywordtype">char</span> *page = <a class="code" href="group__vars.html#ga36">stp_get_string_parameter</a>(v, <span class="stringliteral">"PageSize"</span>);
01296   <span class="keyword">const</span> <span class="keywordtype">char</span> *resolution = <a class="code" href="group__vars.html#ga36">stp_get_string_parameter</a>(v, <span class="stringliteral">"Resolution"</span>);
01297   <span class="keyword">const</span> <a class="code" href="structolympus__cap__t.html">olympus_cap_t</a> *caps = <a class="code" href="print-olympus_8c.html#a97">olympus_get_model_capabilities</a>(
01298                                                 <a class="code" href="group__printer.html#ga23">stp_get_model_id</a>(v));
01299   <span class="keyword">const</span> <a class="code" href="structolymp__printsize__list__t.html">olymp_printsize_list_t</a> *p = caps-&gt;<a class="code" href="structolympus__cap__t.html#o4">printsize</a>;
01300 
01301   <span class="keywordflow">for</span> (i = 0; i &lt; p-&gt;<a class="code" href="structolymp__printsize__list__t.html#o1">n_items</a>; i++)
01302     {
01303       <span class="keywordflow">if</span> (strcmp(p-&gt;<a class="code" href="structolymp__printsize__list__t.html#o0">item</a>[i].<a class="code" href="structolymp__printsize__t.html#o0">res_name</a>,resolution) == 0 &amp;&amp;
01304           strcmp(p-&gt;<a class="code" href="structolymp__printsize__list__t.html#o0">item</a>[i].<a class="code" href="structolymp__printsize__t.html#o1">pagesize_name</a>,page) == 0)
01305         {
01306           *width  = p-&gt;<a class="code" href="structolymp__printsize__list__t.html#o0">item</a>[i].<a class="code" href="structolymp__printsize__t.html#o2">width_px</a>;
01307           *height = p-&gt;<a class="code" href="structolymp__printsize__list__t.html#o0">item</a>[i].<a class="code" href="structolymp__printsize__t.html#o3">height_px</a>;
01308           <span class="keywordflow">return</span>;
01309         }
01310     }
01311   <a class="code" href="print-util_8c.html#a20">stp_erprintf</a>(<span class="stringliteral">"olympus_printsize: printsize not found (%s, %s)\n"</span>,
01312                page, resolution);
01313 }
01314 
01315 <span class="keyword">static</span> <span class="keywordtype">int</span>
<a name="l01316"></a><a class="code" href="print-olympus_8c.html#a122">01316</a> <a class="code" href="print-olympus_8c.html#a122">olympus_feature</a>(<span class="keyword">const</span> <a class="code" href="structolympus__cap__t.html">olympus_cap_t</a> *caps, <span class="keywordtype">int</span> feature)
01317 {
01318   <span class="keywordflow">return</span> ((caps-&gt;<a class="code" href="structolympus__cap__t.html#o7">features</a> &amp; feature) == feature);
01319 }
01320 
01321 <span class="keyword">static</span> <a class="code" href="group__vars.html#ga1">stp_parameter_list_t</a>
<a name="l01322"></a><a class="code" href="print-olympus_8c.html#a123">01322</a> <a class="code" href="print-olympus_8c.html#a123">olympus_list_parameters</a>(<span class="keyword">const</span> <a class="code" href="structstp__vars.html">stp_vars_t</a> *v)
01323 {
01324   <a class="code" href="group__vars.html#ga1">stp_parameter_list_t</a> *ret = <a class="code" href="group__vars.html#ga43">stp_parameter_list_create</a>();
01325   <span class="keywordtype">int</span> i;
01326 
01327   <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="print-olympus_8c.html#a90">the_parameter_count</a>; i++)
01328     <a class="code" href="group__vars.html#ga82">stp_parameter_list_add_param</a>(ret, &amp;(<a class="code" href="print-olympus_8c.html#a89">the_parameters</a>[i]));
01329   <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="print-olympus_8c.html#a92">float_parameter_count</a>; i++)
01330     <a class="code" href="group__vars.html#ga82">stp_parameter_list_add_param</a>(ret, &amp;(<a class="code" href="print-olympus_8c.html#a91">float_parameters</a>[i].param));
01331   <span class="keywordflow">return</span> ret;
01332 }
01333 
01334 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l01335"></a><a class="code" href="print-olympus_8c.html#a124">01335</a> <a class="code" href="print-olympus_8c.html#a124">olympus_parameters</a>(<span class="keyword">const</span> <a class="code" href="structstp__vars.html">stp_vars_t</a> *v, <span class="keyword">const</span> <span class="keywordtype">char</span> *name,
01336                <a class="code" href="structstp__parameter__t.html">stp_parameter_t</a> *description)
01337 {
01338   <span class="keywordtype">int</span>   i;
01339   <span class="keyword">const</span> <a class="code" href="structolympus__cap__t.html">olympus_cap_t</a> *caps = <a class="code" href="print-olympus_8c.html#a97">olympus_get_model_capabilities</a>(
01340                                                 <a class="code" href="group__printer.html#ga23">stp_get_model_id</a>(v));
01341 
01342   description-&gt;<a class="code" href="structstp__parameter__t.html#o4">p_type</a> = <a class="code" href="group__vars.html#gga132a16">STP_PARAMETER_TYPE_INVALID</a>;
01343   <span class="keywordflow">if</span> (name == NULL)
01344     <span class="keywordflow">return</span>;
01345 
01346   description-&gt;<a class="code" href="structstp__parameter__t.html#o26">deflt</a>.str = NULL;
01347   <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="print-olympus_8c.html#a92">float_parameter_count</a>; i++)
01348     <span class="keywordflow">if</span> (strcmp(name, <a class="code" href="print-olympus_8c.html#a91">float_parameters</a>[i].param.name) == 0)
01349       {
01350         <a class="code" href="group__vars.html#ga75">stp_fill_parameter_settings</a>(description,
01351                                      &amp;(<a class="code" href="print-olympus_8c.html#a91">float_parameters</a>[i].param));
01352         description-&gt;<a class="code" href="structstp__parameter__t.html#o26">deflt</a>.dbl = <a class="code" href="print-olympus_8c.html#a91">float_parameters</a>[i].<a class="code" href="structfloat__param__t.html#o3">defval</a>;
01353         description-&gt;<a class="code" href="structstp__parameter__t.html#o18">bounds</a>.dbl.upper = <a class="code" href="print-olympus_8c.html#a91">float_parameters</a>[i].<a class="code" href="structfloat__param__t.html#o2">max</a>;
01354         description-&gt;<a class="code" href="structstp__parameter__t.html#o18">bounds</a>.dbl.lower = <a class="code" href="print-olympus_8c.html#a91">float_parameters</a>[i].<a class="code" href="structfloat__param__t.html#o1">min</a>;
01355       }
01356 
01357   <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="print-olympus_8c.html#a90">the_parameter_count</a>; i++)
01358     <span class="keywordflow">if</span> (strcmp(name, <a class="code" href="print-olympus_8c.html#a89">the_parameters</a>[i].name) == 0)
01359       {
01360         <a class="code" href="group__vars.html#ga75">stp_fill_parameter_settings</a>(description, &amp;(<a class="code" href="print-olympus_8c.html#a89">the_parameters</a>[i]));
01361         <span class="keywordflow">break</span>;
01362       }
01363   <span class="keywordflow">if</span> (strcmp(name, <span class="stringliteral">"PageSize"</span>) == 0)
01364     {
01365       <span class="keywordtype">int</span> default_specified = 0;
01366       <span class="keyword">const</span> <a class="code" href="structolymp__pagesize__list__t.html">olymp_pagesize_list_t</a> *p = caps-&gt;<a class="code" href="structolympus__cap__t.html#o3">pages</a>;
01367       <span class="keyword">const</span> <span class="keywordtype">char</span>* text;
01368 
01369       description-&gt;<a class="code" href="structstp__parameter__t.html#o18">bounds</a>.str = <a class="code" href="string-list_8h.html#a1">stp_string_list_create</a>();
01370       <span class="keywordflow">for</span> (i = 0; i &lt; p-&gt;<a class="code" href="structolymp__pagesize__list__t.html#o1">n_items</a>; i++)
01371         {
01372           <span class="keyword">const</span> <a class="code" href="structstp__papersize__t.html">stp_papersize_t</a> *pt = <a class="code" href="group__papersize.html#ga9">stp_get_papersize_by_name</a>(
01373                           p-&gt;<a class="code" href="structolymp__pagesize__list__t.html#o0">item</a>[i].<a class="code" href="structolymp__pagesize__t.html#o0">name</a>);
01374 
01375           text = (p-&gt;<a class="code" href="structolymp__pagesize__list__t.html#o0">item</a>[i].<a class="code" href="structolymp__pagesize__t.html#o1">text</a> ? p-&gt;<a class="code" href="structolymp__pagesize__list__t.html#o0">item</a>[i].<a class="code" href="structolymp__pagesize__t.html#o1">text</a> : pt-&gt;<a class="code" href="structstp__papersize__t.html#o1">text</a>);
01376           <a class="code" href="string-list_8c.html#a11">stp_string_list_add_string</a>(description-&gt;<a class="code" href="structstp__parameter__t.html#o18">bounds</a>.str,
01377                           p-&gt;<a class="code" href="structolymp__pagesize__list__t.html#o0">item</a>[i].<a class="code" href="structolymp__pagesize__t.html#o0">name</a>, text);
01378           <span class="keywordflow">if</span> (! default_specified &amp;&amp; pt &amp;&amp; pt-&gt;<a class="code" href="structstp__papersize__t.html#o3">width</a> &gt; 0 &amp;&amp; pt-&gt;<a class="code" href="structstp__papersize__t.html#o4">height</a> &gt; 0)
01379             {
01380               description-&gt;<a class="code" href="structstp__parameter__t.html#o26">deflt</a>.str = p-&gt;<a class="code" href="structolymp__pagesize__list__t.html#o0">item</a>[i].<a class="code" href="structolymp__pagesize__t.html#o0">name</a>;
01381               default_specified = 1;
01382             }
01383         }
01384       <span class="keywordflow">if</span> (!default_specified)
01385         description-&gt;<a class="code" href="structstp__parameter__t.html#o26">deflt</a>.str =
01386           <a class="code" href="string-list_8c.html#a6">stp_string_list_param</a>(description-&gt;<a class="code" href="structstp__parameter__t.html#o18">bounds</a>.str, 0)-&gt;<a class="code" href="structstp__param__string__t.html#o0">name</a>;
01387     }
01388   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp(name, <span class="stringliteral">"MediaType"</span>) == 0)
01389     {
01390       description-&gt;<a class="code" href="structstp__parameter__t.html#o18">bounds</a>.str = <a class="code" href="string-list_8h.html#a1">stp_string_list_create</a>();
01391       description-&gt;<a class="code" href="structstp__parameter__t.html#o8">is_active</a> = 0;
01392     }
01393   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp(name, <span class="stringliteral">"InputSlot"</span>) == 0)
01394     {
01395       description-&gt;<a class="code" href="structstp__parameter__t.html#o18">bounds</a>.str = <a class="code" href="string-list_8h.html#a1">stp_string_list_create</a>();
01396       description-&gt;<a class="code" href="structstp__parameter__t.html#o8">is_active</a> = 0;
01397     }
01398   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp(name, <span class="stringliteral">"Resolution"</span>) == 0)
01399     {
01400       <span class="keywordtype">char</span> res_text[24];
01401       <span class="keyword">const</span> <a class="code" href="structolymp__resolution__list__t.html">olymp_resolution_list_t</a> *r = caps-&gt;<a class="code" href="structolympus__cap__t.html#o2">resolution</a>;
01402 
01403       description-&gt;<a class="code" href="structstp__parameter__t.html#o18">bounds</a>.str = <a class="code" href="string-list_8h.html#a1">stp_string_list_create</a>();
01404       <span class="keywordflow">for</span> (i = 0; i &lt; r-&gt;<a class="code" href="structolymp__resolution__list__t.html#o1">n_items</a>; i++)
01405         {
01406           sprintf(res_text, <span class="stringliteral">"%s DPI"</span>, r-&gt;<a class="code" href="structolymp__resolution__list__t.html#o0">item</a>[i].<a class="code" href="structolymp__resolution__t.html#o0">name</a>);
01407           <a class="code" href="string-list_8c.html#a11">stp_string_list_add_string</a>(description-&gt;<a class="code" href="structstp__parameter__t.html#o18">bounds</a>.str,
01408                 r-&gt;<a class="code" href="structolymp__resolution__list__t.html#o0">item</a>[i].<a class="code" href="structolymp__resolution__t.html#o0">name</a>, <a class="code" href="group__intl__internal.html#ga5">_</a>(res_text));
01409         }
01410       <span class="keywordflow">if</span> (r-&gt;<a class="code" href="structolymp__resolution__list__t.html#o1">n_items</a> &lt; 1)
01411         description-&gt;<a class="code" href="structstp__parameter__t.html#o8">is_active</a> = 0;
01412       description-&gt;<a class="code" href="structstp__parameter__t.html#o26">deflt</a>.str =
01413         <a class="code" href="string-list_8c.html#a6">stp_string_list_param</a>(description-&gt;<a class="code" href="structstp__parameter__t.html#o18">bounds</a>.str, 0)-&gt;<a class="code" href="structstp__param__string__t.html#o0">name</a>;
01414     }
01415   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp(name, <span class="stringliteral">"InkType"</span>) == 0)
01416     {
01417       description-&gt;<a class="code" href="structstp__parameter__t.html#o18">bounds</a>.str = <a class="code" href="string-list_8h.html#a1">stp_string_list_create</a>();
01418       <span class="keywordflow">for</span> (i = 0; i &lt; caps-&gt;<a class="code" href="structolympus__cap__t.html#o1">inks</a>-&gt;<a class="code" href="structink__list__t.html#o1">n_items</a>; i++)
01419         <a class="code" href="string-list_8c.html#a11">stp_string_list_add_string</a>(description-&gt;<a class="code" href="structstp__parameter__t.html#o18">bounds</a>.str,
01420                           caps-&gt;<a class="code" href="structolympus__cap__t.html#o1">inks</a>-&gt;<a class="code" href="structink__list__t.html#o0">item</a>[i].<a class="code" href="structink__t.html#o2">name</a>, caps-&gt;<a class="code" href="structolympus__cap__t.html#o1">inks</a>-&gt;<a class="code" href="structink__list__t.html#o0">item</a>[i].<a class="code" href="structink__t.html#o2">name</a>);
01421       description-&gt;<a class="code" href="structstp__parameter__t.html#o26">deflt</a>.str =
01422         <a class="code" href="string-list_8c.html#a6">stp_string_list_param</a>(description-&gt;<a class="code" href="structstp__parameter__t.html#o18">bounds</a>.str, 0)-&gt;<a class="code" href="structstp__param__string__t.html#o0">name</a>;
01423       <span class="keywordflow">if</span> (caps-&gt;<a class="code" href="structolympus__cap__t.html#o1">inks</a>-&gt;<a class="code" href="structink__list__t.html#o1">n_items</a> &lt; 2)
01424         description-&gt;<a class="code" href="structstp__parameter__t.html#o8">is_active</a> = 0;
01425     }
01426   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp(name, <span class="stringliteral">"Laminate"</span>) == 0)
01427     {
01428       description-&gt;<a class="code" href="structstp__parameter__t.html#o18">bounds</a>.str = <a class="code" href="string-list_8h.html#a1">stp_string_list_create</a>();
01429       <span class="keywordflow">if</span> (caps-&gt;<a class="code" href="structolympus__cap__t.html#o17">laminate</a>)
01430         {
01431           <span class="keyword">const</span> <a class="code" href="structlaminate__list__t.html">laminate_list_t</a> *llist = caps-&gt;<a class="code" href="structolympus__cap__t.html#o17">laminate</a>;
01432 
01433           <span class="keywordflow">for</span> (i = 0; i &lt; llist-&gt;<a class="code" href="structlaminate__list__t.html#o1">n_items</a>; i++)
01434             {
01435               <span class="keyword">const</span> <a class="code" href="structlaminate__t.html">laminate_t</a> *l = &amp;(llist-&gt;<a class="code" href="structlaminate__list__t.html#o0">item</a>[i]);
01436               <a class="code" href="string-list_8c.html#a11">stp_string_list_add_string</a>(description-&gt;<a class="code" href="structstp__parameter__t.html#o18">bounds</a>.str,
01437                                 l-&gt;<a class="code" href="structlaminate__t.html#o0">name</a>, l-&gt;<a class="code" href="structlaminate__t.html#o1">text</a>);
01438             }
01439           description-&gt;<a class="code" href="structstp__parameter__t.html#o26">deflt</a>.str =
01440           <a class="code" href="string-list_8c.html#a6">stp_string_list_param</a>(description-&gt;<a class="code" href="structstp__parameter__t.html#o18">bounds</a>.str, 0)-&gt;<a class="code" href="structstp__param__string__t.html#o0">name</a>;
01441           description-&gt;<a class="code" href="structstp__parameter__t.html#o8">is_active</a> = 1;
01442         }
01443     }
01444   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp(name, <span class="stringliteral">"Borderless"</span>) == 0)
01445     {
01446       <span class="keywordflow">if</span> (<a class="code" href="print-olympus_8c.html#a122">olympus_feature</a>(caps, <a class="code" href="print-olympus_8c.html#a7">OLYMPUS_FEATURE_BORDERLESS</a>)) 
01447         description-&gt;<a class="code" href="structstp__parameter__t.html#o8">is_active</a> = 1;
01448     }
01449   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp(name, <span class="stringliteral">"PrintingMode"</span>) == 0)
01450     {
01451       description-&gt;<a class="code" href="structstp__parameter__t.html#o18">bounds</a>.str = <a class="code" href="string-list_8h.html#a1">stp_string_list_create</a>();
01452       <a class="code" href="string-list_8h.html#a7">stp_string_list_add_string</a>
01453         (description-&gt;<a class="code" href="structstp__parameter__t.html#o18">bounds</a>.str, <span class="stringliteral">"Color"</span>, <a class="code" href="group__intl__internal.html#ga5">_</a>(<span class="stringliteral">"Color"</span>));
01454       description-&gt;<a class="code" href="structstp__parameter__t.html#o26">deflt</a>.str =
01455         <a class="code" href="string-list_8c.html#a6">stp_string_list_param</a>(description-&gt;<a class="code" href="structstp__parameter__t.html#o18">bounds</a>.str, 0)-&gt;<a class="code" href="structstp__param__string__t.html#o0">name</a>;
01456     }
01457   <span class="keywordflow">else</span>
01458     description-&gt;<a class="code" href="structstp__parameter__t.html#o8">is_active</a> = 0;
01459 }
01460 
01461 
01462 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l01463"></a><a class="code" href="print-olympus_8c.html#a125">01463</a> <a class="code" href="print-olympus_8c.html#a125">olympus_imageable_area</a>(<span class="keyword">const</span> <a class="code" href="structstp__vars.html">stp_vars_t</a> *v,
01464                    <span class="keywordtype">int</span>  *left,
01465                    <span class="keywordtype">int</span>  *right,
01466                    <span class="keywordtype">int</span>  *bottom,
01467                    <span class="keywordtype">int</span>  *top)
01468 {
01469   <span class="keywordtype">int</span> width, height;
01470   <span class="keywordtype">int</span> i;
01471   <span class="keyword">const</span> <span class="keywordtype">char</span> *page = <a class="code" href="group__vars.html#ga36">stp_get_string_parameter</a>(v, <span class="stringliteral">"PageSize"</span>);
01472   <span class="keyword">const</span> <a class="code" href="structstp__papersize__t.html">stp_papersize_t</a> *pt = <a class="code" href="group__papersize.html#ga9">stp_get_papersize_by_name</a>(page);
01473   <span class="keyword">const</span> <a class="code" href="structolympus__cap__t.html">olympus_cap_t</a> *caps = <a class="code" href="print-olympus_8c.html#a97">olympus_get_model_capabilities</a>(
01474                                                 <a class="code" href="group__printer.html#ga23">stp_get_model_id</a>(v));
01475   <span class="keyword">const</span> <a class="code" href="structolymp__pagesize__list__t.html">olymp_pagesize_list_t</a> *p = caps-&gt;<a class="code" href="structolympus__cap__t.html#o3">pages</a>;
01476 
01477   <span class="keywordflow">for</span> (i = 0; i &lt; p-&gt;<a class="code" href="structolymp__pagesize__list__t.html#o1">n_items</a>; i++)
01478     {
01479       <span class="keywordflow">if</span> (strcmp(p-&gt;<a class="code" href="structolymp__pagesize__list__t.html#o0">item</a>[i].<a class="code" href="structolymp__pagesize__t.html#o0">name</a>,pt-&gt;<a class="code" href="structstp__papersize__t.html#o0">name</a>) == 0)
01480         {
01481 <span class="comment">/*</span>
01482 <span class="comment">          if (p-&gt;item[i].width_pt &gt;= 0)</span>
01483 <span class="comment">                  stp_set_page_width(v, p-&gt;item[i].width_pt);</span>
01484 <span class="comment">          if (p-&gt;item[i].height_pt &gt;= 0)</span>
01485 <span class="comment">                  stp_set_page_height(v, p-&gt;item[i].height_pt);</span>
01486 <span class="comment">*/</span>
01487 
01488           <a class="code" href="group__papersize.html#ga13">stp_default_media_size</a>(v, &amp;width, &amp;height);
01489     
01490           
01491           <span class="keywordflow">if</span> (<a class="code" href="print-olympus_8c.html#a122">olympus_feature</a>(caps, <a class="code" href="print-olympus_8c.html#a7">OLYMPUS_FEATURE_BORDERLESS</a>)
01492             &amp;&amp; <a class="code" href="group__vars.html#ga62">stp_get_boolean_parameter</a>(v, <span class="stringliteral">"Borderless"</span>))
01493             {
01494               *left = 0;
01495               *top  = 0;
01496               *right  = width;
01497               *bottom = height;
01498             }
01499           <span class="keywordflow">else</span>
01500             {
01501               *left = p-&gt;<a class="code" href="structolymp__pagesize__list__t.html#o0">item</a>[i].<a class="code" href="structolymp__pagesize__t.html#o4">border_pt_left</a>;
01502               *top  = p-&gt;<a class="code" href="structolymp__pagesize__list__t.html#o0">item</a>[i].<a class="code" href="structolymp__pagesize__t.html#o6">border_pt_top</a>;
01503               *right  = width  - p-&gt;<a class="code" href="structolymp__pagesize__list__t.html#o0">item</a>[i].<a class="code" href="structolymp__pagesize__t.html#o5">border_pt_right</a>;
01504               *bottom = height - p-&gt;<a class="code" href="structolymp__pagesize__list__t.html#o0">item</a>[i].<a class="code" href="structolymp__pagesize__t.html#o7">border_pt_bottom</a>;
01505             }
01506           <span class="keywordflow">break</span>;
01507         }
01508     }
01509 }
01510 
01511 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l01512"></a><a class="code" href="print-olympus_8c.html#a126">01512</a> <a class="code" href="print-olympus_8c.html#a126">olympus_limit</a>(<span class="keyword">const</span> <a class="code" href="structstp__vars.html">stp_vars_t</a> *v,                      <span class="comment">/* I */</span>
01513             <span class="keywordtype">int</span> *width, <span class="keywordtype">int</span> *height,
01514             <span class="keywordtype">int</span> *min_width, <span class="keywordtype">int</span> *min_height)
01515 {
01516   *width = 65535;
01517   *height = 65535;
01518   *min_width = 1;
01519   *min_height = 1;
01520 }
01521 
01522 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l01523"></a><a class="code" href="print-olympus_8c.html#a127">01523</a> <a class="code" href="print-olympus_8c.html#a127">olympus_describe_resolution</a>(<span class="keyword">const</span> <a class="code" href="structstp__vars.html">stp_vars_t</a> *v, <span class="keywordtype">int</span> *x, <span class="keywordtype">int</span> *y)
01524 {
01525   <span class="keyword">const</span> <span class="keywordtype">char</span> *resolution = <a class="code" href="group__vars.html#ga36">stp_get_string_parameter</a>(v, <span class="stringliteral">"Resolution"</span>);
01526   <span class="keywordtype">int</span> i;
01527 
01528   *x = -1;
01529   *y = -1;
01530   <span class="keywordflow">if</span> (resolution)
01531     {
01532       <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="print-olympus_8c.html#a87">all_res_list</a>.<a class="code" href="structolymp__resolution__list__t.html#o1">n_items</a>; i++)
01533         {
01534           <span class="keywordflow">if</span> (strcmp(resolution, <a class="code" href="print-olympus_8c.html#a87">all_res_list</a>.<a class="code" href="structolymp__resolution__list__t.html#o0">item</a>[i].<a class="code" href="structolymp__resolution__t.html#o0">name</a>) == 0)
01535             {
01536               *x = <a class="code" href="print-olympus_8c.html#a87">all_res_list</a>.<a class="code" href="structolymp__resolution__list__t.html#o0">item</a>[i].<a class="code" href="structolymp__resolution__t.html#o1">xdpi</a>;
01537               *y = <a class="code" href="print-olympus_8c.html#a87">all_res_list</a>.<a class="code" href="structolymp__resolution__list__t.html#o0">item</a>[i].<a class="code" href="structolymp__resolution__t.html#o2">ydpi</a>;
01538             }
01539         }
01540     }  
01541   <span class="keywordflow">return</span>;
01542 }
01543 
01544 <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span> *
<a name="l01545"></a><a class="code" href="print-olympus_8c.html#a128">01545</a> <a class="code" href="print-olympus_8c.html#a128">olympus_describe_output</a>(<span class="keyword">const</span> <a class="code" href="structstp__vars.html">stp_vars_t</a> *v)
01546 {
01547   <span class="keywordflow">return</span> <span class="stringliteral">"CMY"</span>;
01548 }
01549 
01550 <span class="keyword">static</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> *
<a name="l01551"></a><a class="code" href="print-olympus_8c.html#a129">01551</a> <a class="code" href="print-olympus_8c.html#a129">olympus_get_cached_output</a>(<a class="code" href="structstp__vars.html">stp_vars_t</a> *v,
01552              <a class="code" href="structstp__image.html">stp_image_t</a> *image,
01553              <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> **cache,
01554              <span class="keywordtype">int</span> line, <span class="keywordtype">int</span> size)
01555 {
01556   <span class="keywordtype">unsigned</span> zero_mask;
01557 
01558   <a class="code" href="print-util_8c.html#a24">stp_deprintf</a>(<a class="code" href="group__util.html#ga49">STP_DBG_OLYMPUS</a>, <span class="stringliteral">"olympus: get row %d"</span>, line);
01559   <span class="keywordflow">if</span> (cache[line] == NULL)
01560     {
01561       <a class="code" href="print-util_8c.html#a24">stp_deprintf</a>(<a class="code" href="group__util.html#ga49">STP_DBG_OLYMPUS</a>, <span class="stringliteral">" (calling stp_color_get_row())\n"</span>);
01562       <span class="keywordflow">if</span> (!<a class="code" href="group__color.html#ga14">stp_color_get_row</a>(v, image, line, &amp;zero_mask))
01563         {
01564           cache[line] = <a class="code" href="group__util.html#ga28">stp_malloc</a>(size);
01565           memcpy(cache[line], <a class="code" href="channel_8c.html#a21">stp_channel_get_output</a>(v), size);
01566         }
01567     }
01568   <span class="keywordflow">else</span>
01569     {
01570       <a class="code" href="print-util_8c.html#a24">stp_deprintf</a>(<a class="code" href="group__util.html#ga49">STP_DBG_OLYMPUS</a>, <span class="stringliteral">" (cached)\n"</span>);
01571     }
01572   <span class="keywordflow">return</span> cache[line];
01573 }
01574 
01575 <span class="comment">/*</span>
01576 <span class="comment"> * olympus_print()</span>
01577 <span class="comment"> */</span>
01578 <span class="keyword">static</span> <span class="keywordtype">int</span>
<a name="l01579"></a><a class="code" href="print-olympus_8c.html#a130">01579</a> <a class="code" href="print-olympus_8c.html#a130">olympus_do_print</a>(<a class="code" href="structstp__vars.html">stp_vars_t</a> *v, <a class="code" href="structstp__image.html">stp_image_t</a> *image)
01580 {
01581   <span class="keywordtype">int</span> i, j;
01582   <span class="keywordtype">int</span> y, min_y, max_y;                  <span class="comment">/* Looping vars */</span>
01583   <span class="keywordtype">int</span> min_x, max_x;
01584   <span class="keywordtype">int</span> out_channels, out_bytes;
01585   <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> *final_out = NULL;
01586   <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>  *char_out = NULL;
01587   <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> *real_out = NULL;
01588   <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> *err_out = NULL;
01589   <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> **rows = NULL;         <span class="comment">/* "cache" of rows read from image */</span>
01590   <span class="keywordtype">int</span> char_out_width;
01591   <span class="keywordtype">int</span> status = 1;
01592   <span class="keywordtype">int</span> ink_channels = 1;
01593   <span class="keyword">const</span> <span class="keywordtype">char</span> *ink_order = NULL;
01594   <a class="code" href="structstp__curve.html">stp_curve_t</a>   *adjustment = NULL;
01595 
01596   <span class="keywordtype">int</span> r_errdiv, r_errmod;
01597   <span class="keywordtype">int</span> r_errval  = 0;
01598   <span class="keywordtype">int</span> r_errlast = -1;
01599   <span class="keywordtype">int</span> r_errline = 0;
01600   <span class="keywordtype">int</span> c_errdiv, c_errmod;
01601   <span class="keywordtype">int</span> c_errval  = 0;
01602   <span class="keywordtype">int</span> c_errlast = -1;
01603   <span class="keywordtype">int</span> c_errcol = 0;
01604 
01605   <span class="keyword">const</span> <span class="keywordtype">int</span> model           = <a class="code" href="group__printer.html#ga23">stp_get_model_id</a>(v); 
01606   <span class="keyword">const</span> <span class="keywordtype">char</span> *ink_type      = <a class="code" href="group__vars.html#ga36">stp_get_string_parameter</a>(v, <span class="stringliteral">"InkType"</span>);
01607   <span class="keyword">const</span> <a class="code" href="structolympus__cap__t.html">olympus_cap_t</a> *caps = <a class="code" href="print-olympus_8c.html#a97">olympus_get_model_capabilities</a>(model);
01608   <span class="keywordtype">int</span> max_print_px_width, max_print_px_height;
01609   <span class="keywordtype">int</span> xdpi, ydpi;       <span class="comment">/* Resolution */</span>
01610 
01611   <span class="comment">/* image in pixels */</span>
01612   <span class="keywordtype">int</span> image_px_width;
01613   <span class="keywordtype">int</span> image_px_height;
01614 
01615   <span class="comment">/* output in 1/72" */</span>
01616   <span class="keywordtype">int</span> out_pt_width  = <a class="code" href="group__vars.html#ga22">stp_get_width</a>(v);
01617   <span class="keywordtype">int</span> out_pt_height = <a class="code" href="group__vars.html#ga24">stp_get_height</a>(v);
01618   <span class="keywordtype">int</span> out_pt_left   = <a class="code" href="group__vars.html#ga18">stp_get_left</a>(v);
01619   <span class="keywordtype">int</span> out_pt_top    = <a class="code" href="group__vars.html#ga20">stp_get_top</a>(v);
01620 
01621   <span class="comment">/* output in pixels */</span>
01622   <span class="keywordtype">int</span> out_px_width, out_px_height;
01623   <span class="keywordtype">int</span> out_px_left, out_px_right, out_px_top, out_px_bottom;
01624 
01625   <span class="comment">/* page in 1/72" */</span>
01626   <span class="keywordtype">int</span> page_pt_width  = <a class="code" href="group__vars.html#ga26">stp_get_page_width</a>(v);
01627   <span class="keywordtype">int</span> page_pt_height = <a class="code" href="group__vars.html#ga28">stp_get_page_height</a>(v);
01628   <span class="keywordtype">int</span> page_pt_left = 0;
01629   <span class="keywordtype">int</span> page_pt_right = 0;
01630   <span class="keywordtype">int</span> page_pt_top = 0;
01631   <span class="keywordtype">int</span> page_pt_bottom = 0;
01632 
01633   <span class="comment">/* page w/out borders in pixels (according to selected dpi) */</span>
01634   <span class="keywordtype">int</span> print_px_width;
01635   <span class="keywordtype">int</span> print_px_height;
01636   
01637   <span class="keywordtype">int</span> pl;
01638   <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *zeros = NULL;
01639 
01640   <span class="keywordflow">if</span> (!<a class="code" href="group__vars.html#ga34">stp_verify</a>(v))
01641     {
01642       <a class="code" href="print-util_8c.html#a18">stp_eprintf</a>(v, <a class="code" href="group__intl__internal.html#ga5">_</a>(<span class="stringliteral">"Print options not verified; cannot print.\n"</span>));
01643       <span class="keywordflow">return</span> 0;
01644     }
01645 
01646   <a class="code" href="group__image.html#ga0">stp_image_init</a>(image);
01647   image_px_width  = <a class="code" href="group__image.html#ga2">stp_image_width</a>(image);
01648   image_px_height = <a class="code" href="group__image.html#ga3">stp_image_height</a>(image);
01649 
01650   <a class="code" href="group__vars.html#ga32">stp_describe_resolution</a>(v, &amp;xdpi, &amp;ydpi);
01651   <a class="code" href="print-olympus_8c.html#a121">olympus_printsize</a>(v, &amp;max_print_px_width, &amp;max_print_px_height);
01652 
01653   <a class="code" href="print-olympus_8c.html#a14">privdata</a>.<a class="code" href="structolympus__privdata__t.html#o9">pagesize</a> = <a class="code" href="group__vars.html#ga36">stp_get_string_parameter</a>(v, <span class="stringliteral">"PageSize"</span>);
01654   <span class="keywordflow">if</span> (caps-&gt;<a class="code" href="structolympus__cap__t.html#o17">laminate</a>)
01655           <a class="code" href="print-olympus_8c.html#a14">privdata</a>.<a class="code" href="structolympus__privdata__t.html#o10">laminate</a> = <a class="code" href="print-olympus_8c.html#a98">olympus_get_laminate_pattern</a>(v);
01656 
01657   <span class="keywordflow">if</span> (<a class="code" href="print-olympus_8c.html#a122">olympus_feature</a>(caps, <a class="code" href="print-olympus_8c.html#a8">OLYMPUS_FEATURE_WHITE_BORDER</a>))
01658     <a class="code" href="group__papersize.html#ga13">stp_default_media_size</a>(v, &amp;page_pt_right, &amp;page_pt_bottom);
01659   <span class="keywordflow">else</span>
01660     <a class="code" href="print-olympus_8c.html#a125">olympus_imageable_area</a>(v, &amp;page_pt_left, &amp;page_pt_right,
01661         &amp;page_pt_bottom, &amp;page_pt_top);
01662   
01663   print_px_width  = <a class="code" href="print-canon_8c.html#a6">MIN</a>(max_print_px_width,
01664                         (page_pt_right - page_pt_left) * xdpi / 72);
01665   print_px_height = <a class="code" href="print-canon_8c.html#a6">MIN</a>(max_print_px_height,
01666                         (page_pt_bottom - page_pt_top) * ydpi / 72);
01667   out_px_width  = out_pt_width  * xdpi / 72;
01668   out_px_height = out_pt_height * ydpi / 72;
01669 
01670 
01671   <span class="comment">/* if image size is close enough to output size send out original size */</span>
01672   <span class="keywordflow">if</span> (out_px_width - image_px_width &gt; -5
01673       &amp;&amp; out_px_width - image_px_width &lt; 5
01674       &amp;&amp; out_px_height - image_px_height &gt; -5
01675       &amp;&amp; out_px_height - image_px_height &lt; 5)
01676     {
01677       out_px_width  = image_px_width;
01678       out_px_height = image_px_height;
01679     }
01680 
01681   out_px_width  = <a class="code" href="print-canon_8c.html#a6">MIN</a>(out_px_width, print_px_width);
01682   out_px_height = <a class="code" href="print-canon_8c.html#a6">MIN</a>(out_px_height, print_px_height);
01683   out_px_left   = <a class="code" href="print-canon_8c.html#a6">MIN</a>(((out_pt_left - page_pt_left) * xdpi / 72),
01684                         print_px_width - out_px_width);
01685   out_px_top    = <a class="code" href="print-canon_8c.html#a6">MIN</a>(((out_pt_top  - page_pt_top)  * ydpi / 72),
01686                         print_px_height - out_px_height);
01687   out_px_right  = out_px_left + out_px_width;
01688   out_px_bottom = out_px_top  + out_px_height;
01689   
01690 
01691   <a class="code" href="print-util_8c.html#a24">stp_deprintf</a>(<a class="code" href="group__util.html#ga49">STP_DBG_OLYMPUS</a>,
01692               <span class="stringliteral">"paper (pt)   %d x %d\n"</span>
01693               <span class="stringliteral">"image (px)   %d x %d\n"</span>
01694               <span class="stringliteral">"image (pt)   %d x %d\n"</span>
01695               <span class="stringliteral">"* out (pt)   %d x %d\n"</span>
01696               <span class="stringliteral">"* out (px)   %d x %d\n"</span>
01697               <span class="stringliteral">"* left x top (pt) %d x %d\n"</span>
01698               <span class="stringliteral">"* left x top (px) %d x %d\n"</span>
01699               <span class="stringliteral">"border (pt) (%d - %d) = %d x (%d - %d) = %d\n"</span>
01700               <span class="stringliteral">"printable pixels (px)   %d x %d\n"</span>
01701               <span class="stringliteral">"res (dpi)               %d x %d\n"</span>,
01702               page_pt_width, page_pt_height,
01703               image_px_width, image_px_height,
01704               image_px_width * 72 / xdpi, image_px_height * 72 / ydpi,
01705               out_pt_width, out_pt_height,
01706               out_px_width, out_px_height,
01707               out_pt_left, out_pt_top,
01708               out_px_left, out_px_top,
01709               page_pt_right, page_pt_left, page_pt_right - page_pt_left,
01710               page_pt_bottom, page_pt_top, page_pt_bottom - page_pt_top,
01711               print_px_width, print_px_height,
01712               xdpi, ydpi
01713               );        
01714 
01715   <a class="code" href="print-olympus_8c.html#a14">privdata</a>.<a class="code" href="structolympus__privdata__t.html#o0">xdpi</a> = xdpi;
01716   <a class="code" href="print-olympus_8c.html#a14">privdata</a>.<a class="code" href="structolympus__privdata__t.html#o1">ydpi</a> = ydpi;
01717   <a class="code" href="print-olympus_8c.html#a14">privdata</a>.<a class="code" href="structolympus__privdata__t.html#o2">xsize</a> = print_px_width;
01718   <a class="code" href="print-olympus_8c.html#a14">privdata</a>.<a class="code" href="structolympus__privdata__t.html#o3">ysize</a> = print_px_height;
01719 
01720   <a class="code" href="group__vars.html#ga32">stp_set_string_parameter</a>(v, <span class="stringliteral">"STPIOutputType"</span>, <span class="stringliteral">"CMY"</span>);
01721   
01722   <span class="keywordflow">if</span> (caps-&gt;<a class="code" href="structolympus__cap__t.html#o14">adj_cyan</a> &amp;&amp;
01723         !<a class="code" href="group__vars.html#ga106">stp_check_curve_parameter</a>(v, <span class="stringliteral">"CyanCurve"</span>, <a class="code" href="group__vars.html#gga135a32">STP_PARAMETER_ACTIVE</a>))
01724     {
01725       adjustment = <a class="code" href="group__curve.html#ga66">stp_curve_create_from_string</a>(caps-&gt;<a class="code" href="structolympus__cap__t.html#o14">adj_cyan</a>);
01726       <a class="code" href="group__vars.html#ga47">stp_set_curve_parameter</a>(v, <span class="stringliteral">"CyanCurve"</span>, adjustment);
01727       <a class="code" href="group__vars.html#ga97">stp_set_curve_parameter_active</a>(v, <span class="stringliteral">"CyanCurve"</span>, <a class="code" href="group__vars.html#gga135a32">STP_PARAMETER_ACTIVE</a>);
01728       <a class="code" href="group__curve.html#ga22">stp_curve_destroy</a>(adjustment);
01729     }
01730   <span class="keywordflow">if</span> (caps-&gt;<a class="code" href="structolympus__cap__t.html#o15">adj_magenta</a> &amp;&amp;
01731         !<a class="code" href="group__vars.html#ga106">stp_check_curve_parameter</a>(v, <span class="stringliteral">"MagentaCurve"</span>, <a class="code" href="group__vars.html#gga135a32">STP_PARAMETER_ACTIVE</a>))
01732     {
01733       adjustment = <a class="code" href="group__curve.html#ga66">stp_curve_create_from_string</a>(caps-&gt;<a class="code" href="structolympus__cap__t.html#o15">adj_magenta</a>);
01734       <a class="code" href="group__vars.html#ga47">stp_set_curve_parameter</a>(v, <span class="stringliteral">"MagentaCurve"</span>, adjustment);
01735       <a class="code" href="group__vars.html#ga97">stp_set_curve_parameter_active</a>(v, <span class="stringliteral">"MagentaCurve"</span>, <a class="code" href="group__vars.html#gga135a32">STP_PARAMETER_ACTIVE</a>);
01736       <a class="code" href="group__curve.html#ga22">stp_curve_destroy</a>(adjustment);
01737     }
01738   <span class="keywordflow">if</span> (caps-&gt;<a class="code" href="structolympus__cap__t.html#o16">adj_yellow</a> &amp;&amp;
01739         !<a class="code" href="group__vars.html#ga106">stp_check_curve_parameter</a>(v, <span class="stringliteral">"YellowCurve"</span>, <a class="code" href="group__vars.html#gga135a32">STP_PARAMETER_ACTIVE</a>))
01740     {
01741       adjustment = <a class="code" href="group__curve.html#ga66">stp_curve_create_from_string</a>(caps-&gt;<a class="code" href="structolympus__cap__t.html#o16">adj_yellow</a>);
01742       <a class="code" href="group__vars.html#ga47">stp_set_curve_parameter</a>(v, <span class="stringliteral">"YellowCurve"</span>, adjustment);
01743       <a class="code" href="group__vars.html#ga97">stp_set_curve_parameter_active</a>(v, <span class="stringliteral">"YellowCurve"</span>, <a class="code" href="group__vars.html#gga135a32">STP_PARAMETER_ACTIVE</a>);
01744       <a class="code" href="group__curve.html#ga22">stp_curve_destroy</a>(adjustment);
01745     }
01746 
01747   <span class="keywordflow">if</span> (ink_type)
01748     {
01749       <span class="keywordflow">for</span> (i = 0; i &lt; caps-&gt;<a class="code" href="structolympus__cap__t.html#o1">inks</a>-&gt;<a class="code" href="structink__list__t.html#o1">n_items</a>; i++)
01750         <span class="keywordflow">if</span> (strcmp(ink_type, caps-&gt;<a class="code" href="structolympus__cap__t.html#o1">inks</a>-&gt;<a class="code" href="structink__list__t.html#o0">item</a>[i].<a class="code" href="structink__t.html#o2">name</a>) == 0)
01751           {
01752             <a class="code" href="group__vars.html#ga32">stp_set_string_parameter</a>(v, <span class="stringliteral">"STPIOutputType"</span>,
01753                                      caps-&gt;<a class="code" href="structolympus__cap__t.html#o1">inks</a>-&gt;<a class="code" href="structink__list__t.html#o0">item</a>[i].<a class="code" href="structink__t.html#o0">output_type</a>);
01754             ink_channels = caps-&gt;<a class="code" href="structolympus__cap__t.html#o1">inks</a>-&gt;<a class="code" href="structink__list__t.html#o0">item</a>[i].<a class="code" href="structink__t.html#o1">output_channels</a>;
01755             ink_order = caps-&gt;<a class="code" href="structolympus__cap__t.html#o1">inks</a>-&gt;<a class="code" href="structink__list__t.html#o0">item</a>[i].<a class="code" href="structink__t.html#o3">channel_order</a>;
01756             <span class="keywordflow">break</span>;
01757           }
01758     }
01759 
01760   <a class="code" href="channel_8c.html#a2">stp_channel_reset</a>(v);
01761   <span class="keywordflow">for</span> (i = 0; i &lt; ink_channels; i++)
01762     <a class="code" href="channel_8c.html#a6">stp_channel_add</a>(v, i, 0, 1.0);
01763 
01764   out_channels = <a class="code" href="group__color.html#ga13">stp_color_init</a>(v, image, 65536);
01765 
01766 <span class="preprocessor">#if 0</span>
01767 <span class="preprocessor"></span>  <span class="keywordflow">if</span> (out_channels != ink_channels &amp;&amp; out_channels != 1 &amp;&amp; ink_channels != 1)
01768     {
01769       <a class="code" href="print-util_8c.html#a18">stp_eprintf</a>(v, <span class="stringliteral">"Internal error!  Output channels or input channels must be 1\n"</span>);
01770       <span class="keywordflow">return</span> 0;
01771     }
01772 <span class="preprocessor">#endif</span>
01773 <span class="preprocessor"></span>
01774   rows = <a class="code" href="group__util.html#ga29">stp_zalloc</a>(image_px_height * <span class="keyword">sizeof</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> *));
01775   err_out = <a class="code" href="group__util.html#ga28">stp_malloc</a>(print_px_width * ink_channels * 2);
01776   <span class="keywordflow">if</span> (out_channels != ink_channels)
01777     final_out = <a class="code" href="group__util.html#ga28">stp_malloc</a>(print_px_width * ink_channels * 2);
01778 
01779   <a class="code" href="group__vars.html#ga67">stp_set_float_parameter</a>(v, <span class="stringliteral">"Density"</span>, 1.0);
01780 
01781   <span class="keywordflow">if</span> (ink_type &amp;&amp; 
01782         (strcmp(ink_type, <span class="stringliteral">"RGB"</span>) == 0 || strcmp(ink_type, <span class="stringliteral">"BGR"</span>) == 0))
01783     {
01784       zeros = <a class="code" href="group__util.html#ga28">stp_malloc</a>(ink_channels * print_px_width + 1);
01785       (<span class="keywordtype">void</span>) memset(zeros, '\xff', ink_channels * print_px_width + 1);
01786     }
01787   <span class="keywordflow">else</span>
01788     zeros = <a class="code" href="group__util.html#ga29">stp_zalloc</a>(ink_channels * print_px_width + 1);
01789   
01790   out_bytes = (caps-&gt;<a class="code" href="structolympus__cap__t.html#o5">interlacing</a> == <a class="code" href="print-olympus_8c.html#a2">OLYMPUS_INTERLACE_PLANE</a> ? 1 : ink_channels);
01791 
01792   <span class="comment">/* printer init */</span>
01793   <span class="keywordflow">if</span> (caps-&gt;<a class="code" href="structolympus__cap__t.html#o8">printer_init_func</a>)
01794     {
01795       <a class="code" href="print-util_8c.html#a24">stp_deprintf</a>(<a class="code" href="group__util.html#ga49">STP_DBG_OLYMPUS</a>, <span class="stringliteral">"olympus: caps-&gt;printer_init\n"</span>);
01796       (*(caps-&gt;<a class="code" href="structolympus__cap__t.html#o8">printer_init_func</a>))(v);
01797     }
01798 
01799   <span class="keywordflow">if</span> (<a class="code" href="print-olympus_8c.html#a122">olympus_feature</a>(caps, <a class="code" href="print-olympus_8c.html#a5">OLYMPUS_FEATURE_FULL_HEIGHT</a>))
01800     {
01801       min_y = 0;
01802       max_y = print_px_height - 1;
01803     }
01804   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="print-olympus_8c.html#a122">olympus_feature</a>(caps, <a class="code" href="print-olympus_8c.html#a6">OLYMPUS_FEATURE_BLOCK_ALIGN</a>))
01805     {
01806       min_y = out_px_top - (out_px_top % caps-&gt;<a class="code" href="structolympus__cap__t.html#o6">block_size</a>);
01807                                 <span class="comment">/* floor to multiple of block_size */</span>
01808       max_y = (out_px_bottom - 1) + (caps-&gt;<a class="code" href="structolympus__cap__t.html#o6">block_size</a> - 1)
01809                 - ((out_px_bottom - 1) % caps-&gt;<a class="code" href="structolympus__cap__t.html#o6">block_size</a>);
01810                                 <span class="comment">/* ceil to multiple of block_size */</span>
01811     }
01812   <span class="keywordflow">else</span>
01813     {
01814       min_y = out_px_top;
01815       max_y = out_px_bottom - 1;
01816     }
01817   
01818   <span class="keywordflow">if</span> (<a class="code" href="print-olympus_8c.html#a122">olympus_feature</a>(caps, <a class="code" href="print-olympus_8c.html#a4">OLYMPUS_FEATURE_FULL_WIDTH</a>))
01819     {
01820       min_x = 0;
01821       max_x = print_px_width - 1;
01822     }
01823   <span class="keywordflow">else</span>
01824     {
01825       min_x = out_px_left;
01826       max_x = out_px_right;
01827     }
01828       
01829   r_errdiv  = image_px_height / out_px_height;
01830   r_errmod  = image_px_height % out_px_height; 
01831   c_errdiv = image_px_width / out_px_width;
01832   c_errmod = image_px_width % out_px_width;
01833 
01834   <span class="keywordflow">for</span> (pl = 0; pl &lt; (caps-&gt;<a class="code" href="structolympus__cap__t.html#o5">interlacing</a> == <a class="code" href="print-olympus_8c.html#a2">OLYMPUS_INTERLACE_PLANE</a>
01835                         ? ink_channels : 1); pl++)
01836     {
01837       r_errval  = 0;
01838       r_errlast = -1;
01839       r_errline = 0;
01840 
01841       <a class="code" href="print-olympus_8c.html#a14">privdata</a>.<a class="code" href="structolympus__privdata__t.html#o4">plane</a> = ink_order[pl];
01842       <a class="code" href="print-util_8c.html#a24">stp_deprintf</a>(<a class="code" href="group__util.html#ga49">STP_DBG_OLYMPUS</a>, <span class="stringliteral">"olympus: plane %d\n"</span>, <a class="code" href="print-olympus_8c.html#a14">privdata</a>.<a class="code" href="structolympus__privdata__t.html#o4">plane</a>);
01843 
01844       <span class="comment">/* plane init */</span>
01845       <span class="keywordflow">if</span> (caps-&gt;<a class="code" href="structolympus__cap__t.html#o10">plane_init_func</a>)
01846         {
01847           <a class="code" href="print-util_8c.html#a24">stp_deprintf</a>(<a class="code" href="group__util.html#ga49">STP_DBG_OLYMPUS</a>, <span class="stringliteral">"olympus: caps-&gt;plane_init\n"</span>);
01848           (*(caps-&gt;<a class="code" href="structolympus__cap__t.html#o10">plane_init_func</a>))(v);
01849         }
01850   
01851       <span class="keywordflow">for</span> (y = min_y; y &lt;= max_y; y++)
01852         {
01853           <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> *out;
01854           <span class="keywordtype">int</span> duplicate_line = 1;
01855 <span class="comment">/*          unsigned zero_mask; */</span>
01856     
01857           <span class="keywordflow">if</span> (((y - min_y) % caps-&gt;<a class="code" href="structolympus__cap__t.html#o6">block_size</a>) == 0)
01858             {
01859               <span class="comment">/* block init */</span>
01860               <a class="code" href="print-olympus_8c.html#a14">privdata</a>.<a class="code" href="structolympus__privdata__t.html#o6">block_min_y</a> = y;
01861               <a class="code" href="print-olympus_8c.html#a14">privdata</a>.<a class="code" href="structolympus__privdata__t.html#o5">block_min_x</a> = min_x;
01862               <a class="code" href="print-olympus_8c.html#a14">privdata</a>.<a class="code" href="structolympus__privdata__t.html#o8">block_max_y</a> = <a class="code" href="print-canon_8c.html#a6">MIN</a>(y + caps-&gt;<a class="code" href="structolympus__cap__t.html#o6">block_size</a> - 1, max_y);
01863               <a class="code" href="print-olympus_8c.html#a14">privdata</a>.<a class="code" href="structolympus__privdata__t.html#o7">block_max_x</a> = max_x;
01864     
01865               <span class="keywordflow">if</span> (caps-&gt;<a class="code" href="structolympus__cap__t.html#o12">block_init_func</a>)
01866                 {
01867                   <a class="code" href="print-util_8c.html#a24">stp_deprintf</a>(<a class="code" href="group__util.html#ga49">STP_DBG_OLYMPUS</a>,
01868                                <span class="stringliteral">"olympus: caps-&gt;block_init\n"</span>);
01869                   (*(caps-&gt;<a class="code" href="structolympus__cap__t.html#o12">block_init_func</a>))(v);
01870                 }
01871             }
01872         
01873           <span class="keywordflow">if</span> (y &lt; out_px_top || y &gt;= out_px_bottom)
01874             <a class="code" href="group__util.html#ga10">stp_zfwrite</a>((<span class="keywordtype">char</span> *) zeros, out_bytes, print_px_width, v);
01875           <span class="keywordflow">else</span>
01876             {
01877               <span class="keywordflow">if</span> (<a class="code" href="print-olympus_8c.html#a122">olympus_feature</a>(caps, <a class="code" href="print-olympus_8c.html#a4">OLYMPUS_FEATURE_FULL_WIDTH</a>)
01878                 &amp;&amp; out_px_left &gt; 0)
01879                 {
01880                   <a class="code" href="group__util.html#ga10">stp_zfwrite</a>((<span class="keywordtype">char</span> *) zeros, out_bytes, out_px_left, v);
01881                   <span class="comment">/* stp_erprintf("left %d ", out_px_left); */</span>
01882                 }
01883   
01884 <span class="preprocessor">#if 0</span>
01885 <span class="preprocessor"></span>              <span class="keywordflow">if</span> (r_errline != r_errlast)
01886                 {
01887                   r_errlast = r_errline;
01888                   duplicate_line = 0;
01889 
01890                   <span class="comment">/* stp_erprintf("r_errline %d, ", r_errline); */</span>
01891                   <span class="keywordflow">if</span> (<a class="code" href="group__color.html#ga14">stp_color_get_row</a>(v, image, r_errline, &amp;zero_mask))
01892                     {
01893                       status = 2;
01894                       <span class="keywordflow">break</span>;
01895                     }
01896                 }
01897 
01898               out = <a class="code" href="channel_8c.html#a21">stp_channel_get_output</a>(v);
01899 <span class="preprocessor">#endif</span>
01900 <span class="preprocessor"></span>              <span class="keywordflow">if</span> (r_errline != r_errlast)
01901                 {
01902                   r_errlast = r_errline;
01903                   duplicate_line = 0;
01904                 }
01905 
01906               out = <a class="code" href="print-olympus_8c.html#a129">olympus_get_cached_output</a>(v, image, rows, r_errline,
01907                                           image_px_width * ink_channels * 2);
01908               <span class="keywordflow">if</span> (out == NULL)
01909                 {
01910                   status = 2;
01911                   <span class="keywordflow">break</span>;
01912                 }
01913 
01914               c_errval  = 0;
01915               c_errlast = -1;
01916               c_errcol  = 0;
01917               <span class="keywordflow">for</span> (i = 0; i &lt; out_px_width; i++)
01918                 {
01919                   <span class="keywordflow">if</span> (c_errcol != c_errlast)
01920                     c_errlast = c_errcol;
01921                   <span class="keywordflow">for</span> (j = 0; j &lt; ink_channels; j++)
01922                     err_out[i * ink_channels + j] =
01923                                 out[c_errcol * ink_channels + ink_order[j]-1];
01924 
01925                   c_errval += c_errmod;
01926                   c_errcol += c_errdiv;
01927                   <span class="keywordflow">if</span> (c_errval &gt;= out_px_width)
01928                     {
01929                       c_errval -= out_px_width;
01930                       c_errcol ++;
01931                     }
01932                 }
01933 
01934               real_out = err_out;
01935               <span class="keywordflow">if</span> (out_channels != ink_channels)
01936                 {
01937                   real_out = final_out;
01938                   <span class="keywordflow">if</span> (out_channels &lt; ink_channels)
01939                     {
01940                       <span class="keywordflow">for</span> (i = 0; i &lt; out_px_width; i++)
01941                         {
01942                           <span class="keywordflow">for</span> (j = 0; j &lt; ink_channels; j++)
01943                             final_out[i * ink_channels + j] = err_out[i];
01944                         }
01945                     }
01946                   <span class="keywordflow">else</span>
01947                     {
01948                       <span class="keywordflow">for</span> (i = 0; i &lt; out_px_width; i++)
01949                         {
01950                           <span class="keywordtype">int</span> avg = 0;
01951                           <span class="keywordflow">for</span> (j = 0; j &lt; out_channels; j++)
01952                             avg += err_out[i * out_channels + j];
01953                           final_out[i] = avg / out_channels;
01954                         }
01955                     }
01956                 }
01957               char_out = (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *) real_out;
01958               char_out_width = (caps-&gt;<a class="code" href="structolympus__cap__t.html#o5">interlacing</a> == <a class="code" href="print-olympus_8c.html#a2">OLYMPUS_INTERLACE_PLANE</a> ?
01959                                 out_px_width : out_px_width * out_channels);
01960               <span class="keywordflow">for</span> (i = 0; i &lt; char_out_width; i++)
01961                 {
01962                   <span class="keywordflow">if</span> (caps-&gt;<a class="code" href="structolympus__cap__t.html#o5">interlacing</a> == <a class="code" href="print-olympus_8c.html#a2">OLYMPUS_INTERLACE_PLANE</a>)
01963                     j = i * ink_channels + pl;
01964                   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (caps-&gt;<a class="code" href="structolympus__cap__t.html#o5">interlacing</a> == <a class="code" href="print-olympus_8c.html#a1">OLYMPUS_INTERLACE_LINE</a>)
01965                     j = (i % out_px_width) + (i / out_px_width);
01966                   <span class="keywordflow">else</span>  <span class="comment">/* OLYMPUS_INTERLACE_NONE */</span>
01967                     j = i;
01968           
01969                   char_out[i] = real_out[j] / 257;
01970                 }
01971               
01972               <a class="code" href="group__util.html#ga10">stp_zfwrite</a>((<span class="keywordtype">char</span> *) real_out, 1, char_out_width, v);
01973               <span class="comment">/* stp_erprintf("data %d ", out_px_width); */</span>
01974               <span class="keywordflow">if</span> (<a class="code" href="print-olympus_8c.html#a122">olympus_feature</a>(caps, <a class="code" href="print-olympus_8c.html#a4">OLYMPUS_FEATURE_FULL_WIDTH</a>)
01975                 &amp;&amp; out_px_right &lt; print_px_width)
01976                 {
01977                   <a class="code" href="group__util.html#ga10">stp_zfwrite</a>((<span class="keywordtype">char</span> *) zeros, out_bytes,
01978                                   print_px_width - out_px_right, v);
01979                   <span class="comment">/* stp_erprintf("right %d ", print_px_width-out_px_right); */</span>
01980                 }
01981               <span class="comment">/* stp_erprintf("\n"); */</span>
01982   
01983               r_errval += r_errmod;
01984               r_errline += r_errdiv;
01985               <span class="keywordflow">if</span> (r_errval &gt;= out_px_height)
01986                 {
01987                   r_errval -= out_px_height;
01988                   r_errline ++;
01989                 }
01990             }
01991         
01992           <span class="keywordflow">if</span> (y == <a class="code" href="print-olympus_8c.html#a14">privdata</a>.<a class="code" href="structolympus__privdata__t.html#o8">block_max_y</a>)
01993             {
01994               <span class="comment">/* block end */</span>
01995               <span class="keywordflow">if</span> (caps-&gt;<a class="code" href="structolympus__cap__t.html#o13">block_end_func</a>)
01996                 {
01997                   <a class="code" href="print-util_8c.html#a24">stp_deprintf</a>(<a class="code" href="group__util.html#ga49">STP_DBG_OLYMPUS</a>, <span class="stringliteral">"olympus: caps-&gt;block_end\n"</span>);
01998                   (*(caps-&gt;<a class="code" href="structolympus__cap__t.html#o13">block_end_func</a>))(v);
01999                 }
02000             }
02001         }
02002 
02003       <span class="comment">/* plane end */</span>
02004       <span class="keywordflow">if</span> (caps-&gt;<a class="code" href="structolympus__cap__t.html#o11">plane_end_func</a>) {
02005         <a class="code" href="print-util_8c.html#a24">stp_deprintf</a>(<a class="code" href="group__util.html#ga49">STP_DBG_OLYMPUS</a>, <span class="stringliteral">"olympus: caps-&gt;plane_end\n"</span>);
02006         (*(caps-&gt;<a class="code" href="structolympus__cap__t.html#o11">plane_end_func</a>))(v);
02007       }
02008     }
02009 
02010   <span class="comment">/* printer end */</span>
02011   <span class="keywordflow">if</span> (caps-&gt;<a class="code" href="structolympus__cap__t.html#o9">printer_end_func</a>)
02012     {
02013       <a class="code" href="print-util_8c.html#a24">stp_deprintf</a>(<a class="code" href="group__util.html#ga49">STP_DBG_OLYMPUS</a>, <span class="stringliteral">"olympus: caps-&gt;printer_end\n"</span>);
02014       (*(caps-&gt;<a class="code" href="structolympus__cap__t.html#o9">printer_end_func</a>))(v);
02015     }
02016   <a class="code" href="group__image.html#ga6">stp_image_conclude</a>(image);
02017   <span class="keywordflow">if</span> (final_out)
02018     <a class="code" href="group__util.html#ga31">stp_free</a>(final_out);
02019   <span class="keywordflow">if</span> (err_out)
02020     <a class="code" href="group__util.html#ga31">stp_free</a>(err_out);
02021   <span class="keywordflow">if</span> (zeros)
02022     <a class="code" href="group__util.html#ga31">stp_free</a>(zeros);
02023   <span class="keywordflow">if</span> (rows)
02024     {
02025       <span class="keywordflow">for</span> (i = 0; i &lt;image_px_height; i++)
02026         <a class="code" href="group__util.html#ga31">stp_free</a>(rows[i]);
02027       <a class="code" href="group__util.html#ga31">stp_free</a>(rows);
02028     }
02029   <span class="keywordflow">return</span> status;
02030 }
02031 
02032 <span class="keyword">static</span> <span class="keywordtype">int</span>
<a name="l02033"></a><a class="code" href="print-olympus_8c.html#a131">02033</a> <a class="code" href="print-olympus_8c.html#a131">olympus_print</a>(<span class="keyword">const</span> <a class="code" href="structstp__vars.html">stp_vars_t</a> *v, <a class="code" href="structstp__image.html">stp_image_t</a> *image)
02034 {
02035   <span class="keywordtype">int</span> status;
02036   <a class="code" href="structstp__vars.html">stp_vars_t</a> *nv = <a class="code" href="group__vars.html#ga78">stp_vars_create_copy</a>(v);
02037   <a class="code" href="group__util.html#ga77">stp_prune_inactive_options</a>(nv);
02038   status = <a class="code" href="print-olympus_8c.html#a130">olympus_do_print</a>(nv, image);
02039   <a class="code" href="group__vars.html#ga26">stp_vars_destroy</a>(nv);
02040   <span class="keywordflow">return</span> status;
02041 }
02042 
<a name="l02043"></a><a class="code" href="print-olympus_8c.html#a93">02043</a> <span class="keyword">static</span> <span class="keyword">const</span> <a class="code" href="structstp__printfuncs__t.html">stp_printfuncs_t</a> <a class="code" href="print-olympus_8c.html#a93">print_olympus_printfuncs</a> =
02044 {
02045   <a class="code" href="print-olympus_8c.html#a123">olympus_list_parameters</a>,
02046   <a class="code" href="print-olympus_8c.html#a124">olympus_parameters</a>,
02047   <a class="code" href="group__papersize.html#ga4">stp_default_media_size</a>,
02048   <a class="code" href="print-olympus_8c.html#a125">olympus_imageable_area</a>,
02049   <a class="code" href="print-olympus_8c.html#a126">olympus_limit</a>,
02050   <a class="code" href="print-olympus_8c.html#a131">olympus_print</a>,
02051   <a class="code" href="print-olympus_8c.html#a127">olympus_describe_resolution</a>,
02052   <a class="code" href="print-olympus_8c.html#a128">olympus_describe_output</a>,
02053   <a class="code" href="group__printer.html#ga19">stp_verify_printer_params</a>,
02054   NULL,
02055   NULL
02056 };
02057 
02058 
02059 
02060 
<a name="l02061"></a><a class="code" href="print-olympus_8c.html#a94">02061</a> <span class="keyword">static</span> <a class="code" href="structstp__family.html">stp_family_t</a> <a class="code" href="print-olympus_8c.html#a94">print_olympus_module_data</a> =
02062   {
02063     &amp;<a class="code" href="print-olympus_8c.html#a93">print_olympus_printfuncs</a>,
02064     NULL
02065   };
02066 
02067 
02068 <span class="keyword">static</span> <span class="keywordtype">int</span>
<a name="l02069"></a><a class="code" href="print-olympus_8c.html#a132">02069</a> <a class="code" href="print-olympus_8c.html#a132">print_olympus_module_init</a>(<span class="keywordtype">void</span>)
02070 {
02071   <span class="keywordflow">return</span> <a class="code" href="group__printer.html#ga46">stp_family_register</a>(<a class="code" href="print-olympus_8c.html#a94">print_olympus_module_data</a>.<a class="code" href="structstp__family.html#o1">printer_list</a>);
02072 }
02073 
02074 
02075 <span class="keyword">static</span> <span class="keywordtype">int</span>
<a name="l02076"></a><a class="code" href="print-olympus_8c.html#a133">02076</a> <a class="code" href="print-olympus_8c.html#a133">print_olympus_module_exit</a>(<span class="keywordtype">void</span>)
02077 {
02078   <span class="keywordflow">return</span> <a class="code" href="group__printer.html#ga47">stp_family_unregister</a>(<a class="code" href="print-olympus_8c.html#a94">print_olympus_module_data</a>.<a class="code" href="structstp__family.html#o1">printer_list</a>);
02079 }
02080 
02081 
02082 <span class="comment">/* Module header */</span>
<a name="l02083"></a><a class="code" href="print-olympus_8c.html#a11">02083</a> <span class="preprocessor">#define stp_module_version print_olympus_LTX_stp_module_version</span>
<a name="l02084"></a><a class="code" href="print-olympus_8c.html#a12">02084</a> <span class="preprocessor"></span><span class="preprocessor">#define stp_module_data print_olympus_LTX_stp_module_data</span>
02085 <span class="preprocessor"></span>
<a name="l02086"></a><a class="code" href="print-olympus_8c.html#a95">02086</a> <a class="code" href="structstp__module__version.html">stp_module_version_t</a> <a class="code" href="structstp__module__version.html">stp_module_version</a> = {0, 0};
02087 
<a name="l02088"></a><a class="code" href="print-olympus_8c.html#a96">02088</a> <a class="code" href="structstp__module.html">stp_module_t</a> <a class="code" href="print-canon_8c.html#a45">stp_module_data</a> =
02089   {
02090     <span class="stringliteral">"olympus"</span>,
02091     VERSION,
02092     <span class="stringliteral">"Olympus family driver"</span>,
02093     <a class="code" href="module_8h.html#a13a4">STP_MODULE_CLASS_FAMILY</a>,
02094     NULL,
02095     <a class="code" href="print-olympus_8c.html#a132">print_olympus_module_init</a>,
02096     <a class="code" href="print-olympus_8c.html#a133">print_olympus_module_exit</a>,
02097     (<span class="keywordtype">void</span> *) &amp;<a class="code" href="print-olympus_8c.html#a94">print_olympus_module_data</a>
02098   };
02099 
</pre></div><hr size="1"><address style="align: right;"><small>Generated on Wed Aug 25 07:56:14 2004 for libgimpprint API Reference by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border=0 > </a>1.3.6 </small></address>
</body>
</html>
